(function(e,a){e.space={unviewabledescriptionFlag:false,descriptionauthFlag:false};e.eventsListen=function(){var a=$("body");a.on("click",".appFlag",function(e){var a=$(e.target||e.srcElement);if(a.attr("id")==="ampAppdescFlag"){return}var r=$(this);var n=AmpUtils.moduleName(a);if(n)r.attr("amp-modulename",n);var s=r.attr("amp-type");if(s==="1"){i(r)}else{t(r)}});a.on("click",".ampAppdescFlag",function(a){var r=$(this);var i=false;var n=r.attr("amp-unviewabledescription");if(n=="true"){e.space.unviewabledescriptionFlag=true;e.space.descriptionauthFlag=true}t(r);if(i){$("#ampDetailUnViewInput").prop("checked",true)}e.space.unviewabledescriptionFlag=false;e.space.descriptionauthFlag=false;return false});a.on("mouseenter",".amp-hover-app-card-group",function(e){var a=$(this);if(a.find(".amp-app-card-big").attr("amp-type")=="1"){return}var t=0;if(a.parent().attr("id")=="ampFolderAppList"){t=t-$("#ampFolderAppList").offset().top+$("#ampFolderAppList").scrollTop()}else{t=a.offset().top}if(t<200){a.find(".amp-app-card-big").removeClass("amp-app-card-big-bottom").addClass("amp-app-card-big-top")}else{a.find(".amp-app-card-big").addClass("amp-app-card-big-bottom").removeClass("amp-app-card-big-top")}a.addClass("amp-active")});a.on("mouseleave",".amp-hover-app-card-group",function(e){var a=$(this);a.removeClass("amp-active")})};e.open=function(e){var a=e.attr("amp-url");var t=e.attr("amp-appid");var r=e.attr("amp-hashead");var i=e.attr("amp-title");var n=e.attr("amp-isthirdparty");var s=e.attr("amp-appkey");var o="false";localStorage.appFeebBackFlag=o;if(r=="1"){if(n=="1"){var p="thirdAppIndexShell.html";localStorage.isthirdpartyUrl=a;localStorage.isthirdpartyAppId=t;window.open(p)}else{if(a.indexOf("http")===-1&&a.indexOf("//")===-1){a=AMPConstant.requestPath+a}window.open(a)}}else if(r=="0"){var l=AMPConstant.requestPath+"new/indexShell.html";localStorage.openHasNoHeadAppUrl=a;localStorage.openHasNoHeadAppId=t;localStorage.openHasNoHead="0";localStorage.openHasNoHeadTitle=i;localStorage.isthirdparty=n;window.open(l)}else{if(a.indexOf("http")===-1&&a.indexOf("//")===-1){if(a.indexOf("portal/html/myFeedback/feedback.html")===-1){a=AMPConstant.requestPath+a}else{o="true";localStorage.myFeedbackUrl="portal/html/myFeedback/feedback.html";localStorage.appFeebBackFlag=o;a=AMPConstant.requestPath+"new/indexShell.html"}}window.open(a)}$("#ampDetail .icon-chacha").click();var m=AMPConfigure.schoolId;var c=AmpUtils.getSessionStorageData("ampUserID");var d=AmpUtils.getSessionStorageData("ampUserIp");var v=AmpUtils.getSessionStorageData("userType");var f=e.attr("amp-appkey");var u=e.attr("amp-title");var g=e.attr("amp-appid");Wisedu.ampAppDataSend(f,g,u);if(parent.window.AMPConstant.operationAnalysisRequestPath){Wisedu.ampAppDataSendNew(m,c,d,f,v,u,"appShow")}AmpDataUtils.sendRecUseApp(t,function(e){if(e.success=="true"){}else{}});parent.window.Wisedu.userActionDataSend();if(parent.window.AMPConstant.operationAnalysisRequestPath){parent.window.Wisedu.userActionDataSendNew(d,v)}};function t(a){var t="app";var i="";var s=a.attr("amp-hasdescription");var o=a.attr("amp-descriptionauth");var p=a.attr("amp-unviewabledescription");var l=a.attr("amp-haspermission");if(e.space.unviewabledescriptionFlag){p="false"}if(e.space.descriptionauthFlag){o==="1"}if(s==="1"){if(p==="true"){i=n(a)}else{if(o==="1"){if(AmpGlobal.loginFlag){t="detail"}else{i=n(a)}}else{i=n(a);if(AmpHeader.space.showDetailFlag||AmpHeader.space.showDetailFlag=="null"){t="detail"}}}}else{i=n(a)}if(t==="app"){if(!i){e.open(a)}else{AmpPrompt.show({content:i,state:"warning"})}}else{r(a)}}function r(e){AmpDetail.open(e);var a=$(".amp-detail-wrap").filter('[id="ampFolder"]');var t=a.length;if(t>0){a.remove()}}function i(e){AmpFolder.open(e)}function n(e){var a="";var t=e.attr("amp-title");var r=e.attr("amp-haspermission");var i=e.attr("amp-opening");var n=e.attr("amp-maintaining");if(i==="false"){var s="已过期或尚未开放";a=t+"  已过期或尚未开放";if(AmpGlobal.currentLang=="en_US"){s=$.i18n("expiredOrNotOpen");a=s}}else if(n==="true"){var o="正在维护期";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("duringTheMaintenancePeriod")}a=t+o}else if(r==="false"){var o="您没有权限使用";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("notAuthorizedToUseService")}a=o+t}return a}})(window.AmpApp=window.AmpApp||{});(function(e,a){var t=$("body");t.on("click",".amp-aside-box-mini-item",function(){r($(this).parent().parent().parent())});t.on("click",'[amp-role="ampAsideBoxClose"]',function(){r($(this).parent())});function r(e){var a=e.attr("amp-position");var t="";var r="";switch(a){case"left":t="amp-animate-move-left-out";r="amp-animate-move-left-in";break;case"right":t="amp-animate-move-right-out";r="amp-animate-move-right-in";break;default:break}e.removeClass(r).addClass(t);setTimeout(function(){if(e.hasClass("amp-mini")){e.removeClass("amp-mini")}else{e.addClass("amp-mini")}e.removeClass(t).addClass(r)},AmpGlobal.animateTimes)}})(window.AmpAsideBox=window.AmpAsideBox||{});(function(e,a){e.space={playflag:""};e.init=function(a){e.space.playflag=a;$("#ampBootPage").removeClass("amp-hide");$("#bootWelcomeBox").removeClass("amp-hide");$("#ampBootProcessItems").addClass("amp-hide");$(".amp-boot-pop-btn").mousedown(function(){$(this).find("em").addClass("boot-pop-enter-btn")});$(".amp-boot-pop-btn").mouseover(function(){$(this).find("em").removeClass("boot-pop-enter-btn")})};$("#ampBootBox").on("click",".boot-skip",function(){var e={};e.title1="点击这里可查看更多帮助";e.title2="您也可以在这里重新查看教学引导";e.btn_title="我知道了";e.showPopPosition="7";e.imgurl="pop4.png";e.mapurl="map7.png";e.mapWidth="22";var a=false;t(a,e)});$("body").on("click",".amp-boot-pop-btn",function(e){var a=$(e.target||e.srcElement);$target=a.closest(".amp-boot-pop-btn");$target.find("em").addClass("boot-pop-enter-btn");var r=$target.attr("amp-position");var n="";var s={};if(r=="0"){n="1";s.title1="点击这里进入搜索";s.title2="输入关键字即可快速找到相关应用";s.btn_title="下一个 1/6";s.showPopPosition=n;s.imgurl="pop1.png";s.arrowPos="prompt-top-center";var o=false}else if(r=="1"){n="2";s.promptPos="prompt-left";s.title1="点击收藏应用";s.title2="收藏后的应用再次点击即可取消收藏";s.btn_title="下一个 2/6";s.showPopPosition=n;s.imgurl="pop1.png";s.mapurl="map2.png";s.mapWidth="295";var o=true}else if(r=="2"){n="3";s.promptPos="prompt-left";s.title1="已收藏的应用在这里";s.title2="您也可以新建文件夹来对收藏进行分类";s.btn_title="下一个 3/6";s.showPopPosition=n;s.imgurl="pop2.png";s.mapurl="map3.png";s.mapWidth="138";var o=true}else if(r=="3"){n="4";s.promptPos="prompt-left";s.title1="点击、拖拽这里";s.title2="您可以方便的增删桌面上的卡片";s.btn_title="下一个 4/6";s.showPopPosition=n;s.imgurl="pop1.png";s.mapurl="map4.png";s.mapWidth="295";var o=true}else if(r=="4"){n="5";s.title1="按住这里并拖拽";s.title2="您可以对桌面上的卡片进行个性排序";s.btn_title="下一个 5/6";s.showPopPosition=n;s.imgurl="pop3.png";s.mapurl="map5.png";s.arrowPos="prompt-top-center";s.mapWidth="541";var o=false}else if(r=="5"){n="6";s.title1="点击这里";s.title2="可以对卡片进行设置，包括移除卡片的操作";s.btn_title="下一个 6/6";s.showPopPosition=n;s.imgurl="pop1.png";s.mapurl="map5.png";s.arrowPos="prompt-top-center";s.mapWidth="541";var o=false}else if(r=="6"){n="7";s.title1="点击这里可查看更多帮助";s.title2="您也可以在这里重新查看教学引导";s.btn_title="我知道了";s.showPopPosition=n;s.imgurl="pop4.png";s.mapurl="map7.png";s.mapWidth="22";var o=false}$(".amp-boot-pop-btn").find("em").removeClass("boot-pop-enter-btn");if(r=="7"){i()}else{t(o,s)}});function t(e,a){var t=a.showPopPosition;if(e){var i=$("#ampPersonalAsideLeft").hasClass("amp-mini");if(i){$("#ampPersonalAsideLeftMini").find('[amp-id="allCanUseApps"]').click()}else{var n=$("#ampPersonalAsideLeftTabHead").find('[amp-id="allCanUseApps"]');if(!n.hasClass("amp-active")){n.click()}}}var s=200;if(t=="2"){s=860}setTimeout(function(){if(t=="1"){var e=$(".amp-header-search-input");var i=$("#ampPersonalArticle");i.removeClass("amp-hide").addClass("amp-active");a.pop_top=e.offset().top;a.pop_left=e.offset().left}else if(t=="2"){var n=$("#ampPersonalAsideLeftAllCanUseAppsTabContent").offset();a.pop_top=n.top;a.pop_left=n.left}else if(t=="3"){var s=$("#ampPersonalAsideLeftTabHead").find('[amp-id="myFavorite"]');if(!s.hasClass("amp-active")){s.click()}var n=s.offset();a.pop_top=n.top;a.pop_left=n.left}else if(t=="4"){var o=$("#ampPersonalAsideLeftTabHead").find('[amp-id="canUseCards"]');if(!o.hasClass("amp-active")){o.click()}var n=o.offset();a.pop_top=n.top;a.pop_left=n.left}else if(t=="5"){var p=$("#ampDesktopContent");var n=p.offset();a.pop_top=n.top;a.pop_left=n.left}else if(t=="6"){var p=$("#ampDesktopContent");var n=p.offset();a.pop_top=n.top;a.pop_left=n.left}else if(t=="7"){var l=$("#ampHeaderToolFeedback");var n=l.offset();a.pop_top=n.top;a.pop_left=n.left;var i=$("#ampPersonalArticle");i.removeClass("amp-hide").addClass("amp-active")}r(a);$(".amp-boot-pop-btn").find("em").removeClass("boot-pop-enter-btn")},s)}function r(e){var a=$("#ampBootProcessItems");var t=$("#processItem");var r=$("#processMap");var i=e.showPopPosition;var n=e.promptPos||"prompt-top";var s=e.arrowPos||"";var o=$("#tpl-boot-page-pop-item").html().replace("@title",e.title1).replace("@tip_title",e.title2).replace("@btn_text",e.btn_title).replace("@promptPosition",n).replace("@index",e.showPopPosition).replace("@imgurl",e.imgurl).replace("@arrowPos",e.arrowPos);var p=e.mapurl||"";var l=e.mapWidth||"";var m=p==""?"":$("#tpl-boot-page-map").html().replace("@mapurl",p).replace("@mapWidth",l);$("#bootWelcomeBox").addClass("amp-hide");a.removeClass("amp-hide");t.html(o);r.html(m);if(i=="1"){t.css({position:"absolute",top:e.pop_top+45,left:"50%","margin-left":"-210px"})}else if(i=="2"){t.css({position:"absolute",top:e.pop_top-32,left:e.pop_left+306,"margin-left":"0"});r.css({position:"absolute",top:e.pop_top,left:e.pop_left,"margin-left":"0"})}else if(i=="3"){t.css({position:"absolute",top:e.pop_top-32,left:e.pop_left+144,"margin-left":"0"});r.css({position:"absolute",top:e.pop_top,left:e.pop_left,"margin-left":"0"})}else if(i=="4"){t.css({position:"absolute",top:e.pop_top+52,left:e.pop_left+150,"margin-left":"0"});r.css({position:"absolute",top:e.pop_top+80,left:e.pop_left-157})}else if(i=="5"){var c=$("#ampDesktopContent").innerWidth()-$("#ampDesktopContent").width();t.css({position:"absolute",top:e.pop_top+41,left:e.pop_left+65+c,"margin-left":"0"});r.css({position:"absolute",top:e.pop_top,left:e.pop_left+c})}else if(i=="6"){var c=$("#ampDesktopContent").innerWidth()-$("#ampDesktopContent").width();t.css({position:"absolute",top:e.pop_top+41,left:e.pop_left+307+c,"margin-left":"0"});r.css({position:"absolute",top:e.pop_top,left:e.pop_left+c})}else if(i=="7"){t.css({position:"absolute",top:e.pop_top+45,left:e.pop_left-282,"margin-left":"0"});r.css({position:"absolute",top:e.pop_top,left:e.pop_left});$("#processItem").find(".boot-skip").remove()}}function i(){var a=$("#ampServiceArticle");if(a.hasClass("ampCurrentBootPageFlag")){$("#ampPageHeaderSearch").click()}e.getActiveTabBootPage();if(e.space.playflag!="reload"){var t="1";AmpDataUtils.updateUserReadGuidePage(t,function(e){if(e.result==="success"){console.log("引导页已读成功！")}})}}e.getActiveTabBootPage=function(){var a=$("#ampPersonalArticle");var t=$("#ampBootPage");var r=$("#ampEhallBody");var i=$("#ampHeaderNav");var n=$("#ampServiceArticle");var s=i.find("i.amp-active").attr("id");if(s=="ampPageHeaderHomeIcon"){r.removeClass("amp-opcity-bottom")}else if(s=="ampPageHeaderPersonalIcon"){a.removeClass("amp-hide").addClass("amp-active")}t.removeClass("amp-active").addClass("amp-hide");if(e.space.playflag=="reload"){if(!$("#ampPersonalAsideLeft").hasClass("amp-mini")){$("#ampPersonalAsideLeftClose").click()}if(!$("#ampPersonalAsideRight").hasClass("amp-mini")){setTimeout(function(){$("#ampPersonalAsideRightClose").click()},150)}}}})(window.AmpBootPage=window.AmpBootPage||{});(function(e,a){i();n();e.getClassifyAppsData=function(e,a){AmpDataUtils.getClassifyApps(e,function(r){t(r,e,a)})};e.setClassifyContainerMarginAndNiceScroll=function(){var e=window.innerHeight;var a=$("#ampClassifyArticle");var t=a.children();var r=0;t.each(function(){var e=$(this);var a=e.outerHeight();r+=a});var i=$("#ampPageHeader").outerHeight();if(r+i<e){var n=e-r-i;var s=parseInt(n/2,10);var o=s+i+"px";var p=s+"px";a.css({"padding-top":o,"padding-bottom":p})}else{AmpUtils.niceScrollInit(a)}};e.roleNavChangeHandle=function(e,a){var t=e.classifyContainer;var r=t.children(".amp-apps-page").children(".amp-active").index();var i=$(t.children(".ampPageContentFlag").children()[r]);var n=a.classifyContainer;var s=n.children(".amp-apps-page").children(".amp-active").index();var o=$(n.children(".ampPageContentFlag").children()[s]);var p=o.children();var l=p.length;p.each(function(e,a){AmpUtils.setRotateYState($(this),"hide",e*AmpGlobal.rotateYTimeStep)});setTimeout(function(){t.removeClass("amp-hide").addClass("amp-active");n.addClass("amp-hide").removeClass("amp-active");setTimeout(function(){i.children().each(function(e){AmpUtils.setRotateYState($(this),"show",e*AmpGlobal.rotateYTimeStep)})},50)},450+(l-3)*AmpGlobal.rotateYTimeStep)};function t(a,t,i){var n;if(!a){a=null;n=0}else{n=a.length}var s=200;var o=8;var p=window.innerWidth;var l=32;var m=p-l*2;var c=parseInt(m/s,10);if((c-1)*o+c*s>m){c--}var d=8;var v=n%c!==0?parseInt(n/c,10)+1:parseInt(n/c,10);var f=1;var u="共";var g="项 >";if(AmpGlobal.currentLang=="en_US"){u=$.i18n("aTotalOf");g=$.i18n("item")}var h=$("#tpl-classify-card").html().replace("@aTotalOf",u).replace("@item",g);var A="";var C="";for(var k=0;k<n;k++){var b=a[k];var S=b.categoryName;var y=!b.categoryEnName?"":b.categoryEnName;var w=b.categoryId;var P=b.appList;if(P){var I=P.length;var U="";if(I>0){var D="amp-rotateY-hide";if(i==="init"){D=f>1?"amp-rotateY-hide":""}for(var T=0;T<I&&T<d;T++){var L=P[T];var F="single";U+=AmpTemplate.getSingleAppHtml(L,F)}A+=h.replace("@ChTitle",S).replace("@EnTitle",y).replace("@apps",U).replace("@hideRotateYClass",D).replace("@classifyId",w).replace("@appSumCount",P.length).replace("@TipChTitle",S)}}if((k+1)%c===0){if(k!==0){var x=f>1?"amp-hide":"";C+='<div class="amp-classify-container '+x+'">'+A+"</div>";A="";f++}}if(k===n-1){if(A){var x=f>1?"amp-hide":"";C+='<div class="amp-classify-container '+x+'">'+A+"</div>"}}}var H=i!=="init"?"amp-hide":"amp-active";var M="ampClassifyPage"+t;var N={id:M};if(v===1){N.customClass="amp-hide"}var R=AmpTemplate.getAppPageHtml(v,N);var E=$("#ampClassifySection");E.append('<div class="ampPageBodyFlag '+H+'" amp-role-id="'+t+'">'+'<div class="amp-classify ampPageContentFlag">'+C+"</div>"+R+"</div>");if(i!=="init"){e.roleNavChangeHandle({classifyContainer:E.children("[amp-role-id="+t+"]")},{classifyContainer:E.children(".amp-active")})}$("#"+M).on("click","div",function(){r($(this))})}function r(e){if(e.hasClass("amp-active")){return}var a=e.closest(".ampPageBodyFlag");var t=a.children(".ampPageContentFlag");var r=a.children(".amp-apps-page");var i=t.children();var n=e.index();var s=$(i[n]);var o={container:s,pageContainer:e};var p=r.find(".amp-active");var l=p.index();var m=$(i[l]);var c={container:m,pageContainer:p};AmpUtils.clickPage4RotateYState(o,c)}function i(){$("#ampClassifySection").on("click",function(e){var a=$(e.target||e.srcElement);if(a.closest(".appFlag").length>0||a.hasClass("appFlag")){return}var t=null;if(a.hasClass("amp-classify-apps")){t=a}else{if(a.closest(".amp-classify-apps").length>0){t=a.closest(".amp-classify-apps")}}var r=$("#ampServiceArticle");if(t){var i=t.attr("amp-classify-id");var n=$("#ampClassifyRoleNav").children(".amp-active").attr("amp-role-id");AmpHeader.searchBoxFocus();$("#ampExtend").addClass("amp-hide");AmpHeader.openServiceSearch();AmpServiceCenter.init({labels:[i,n]});r.addClass("ampLoadActiveFlag");if(r.hasClass("amp-active")){$("#ampPageHeader").addClass("amp-service-header")}$("#ampServiceSearchInput").focus();AmpUtils.zhuge("访问搜索中心",{"来源":"办事大厅-应用分类查看"})}})}function n(){if(localStorage.localeLang=="en_US"){$("#ampPageFooter").html(AMPConfigure.footer.enFooter)}else{$("#ampPageFooter").html(AMPConfigure.footer.normal)}}})(window.AmpClassify=window.AmpClassify||{});(function(e){e.getPublicAppPath=function(){return AMPConstant.publicRequestPath};e.getWidgetColNumberOrAtSide=function(){return""}})(window.AmpUtils=window.AmpUtils||{});(function(e){e.getWidgetUrlPrefix=function(e){return AMPConstant.requestPath+"resources/widget/"+e+"/"};e.getWidgetColNumberOrAtSide=function(e){return""};e.doJsonpAjax=function(e,a){var t=$.Deferred();$.ajax({type:"GET",url:e,traditional:true,data:a,dataType:"json",success:function(e){if(!e.hasLogin){}t.resolve(e)},error:function(e){t.reject(e)}});return t.promise()}})(window.AmpWidget=window.AmpWidget||{});(function(e){e.getCurrentSiteId=function(){return""}})(window.AmpSiteManage=window.AmpSiteManage||{});(function(e){e.curation={}})(window.AMP=window.AMP||{});(function(e,a){e.space={ampData:{},folderData:{},ehallData:{},allServiceData:null,userDesktopPropertyData:{},desktopData:{},userDescSetData:{},userCategoryAppData:null,expandListData:null,firstLoginFlag:null,getTaskCountData:null,userSkinData:null};e.getUserInfo=function(a){AmpServices.userInfo().done(function(t){AmpGlobal.loginFlag=t.hasLogin?true:false;e.space.ampData=t;return a(t)}).fail(function(e){return a({})})};e.getClassifyApps=function(e,a){t(e,"classify",function(e){return a(e)})};e.getHotApps=function(e,a){t(e,"hot",function(e){return a(e)})};e.getNewApps=function(e,a){t(e,"new",function(e){return a(e)})};e.getEhallData=function(e,a){t(e,"all",function(e){return a(e)})};e.getSearchApps=function(a,t){var r={containLabels:true,searchKey:a.key};var i="";var n=a.labels;if(n){var s=n.length;if(s>0){for(var o=0;o<s;o++){if(o!==0){i+="&labels="+n[o]}else{i+="labels="+n[o]}}r.labels=i}}var p=false;if(i===""&&a.key===""){p=true;if(e.space.allServiceData){return t(e.space.allServiceData)}}AmpServices.searchAppData(r).done(function(a){if(p){e.space.allServiceData=a}return t(a)}).fail(function(){return t({})})};e.getNewArrivalApps=function(a){return a(e.space.allServiceData.lastOnlineAppResult)};e.getMyFavoriteApps=function(e){AmpServices.myFavoriteApps().done(function(a){return e(a)})};e.getAllWidgetsData=function(a){return a(e.space.ampData.allWidget)};e.getMainWidgetsData=function(a){AmpServices.userInfo().done(function(t){e.space.ampData=t;return a(t)}).fail(function(e){return a({})})};e.getAsideWidgetsData=function(e){AmpServices.getTaskSideCard().done(function(a){return e(a)})};e.getAsideWidgetsDataOfUnreadMessage=function(e){AmpServices.getTaskSideCardOfUnreadMessage().done(function(a){return e(a)})};e.favoriteApp=function(e,a){AmpServices.favoriteApp(e).done(function(e){return a(e)})};e.unFavoriteApp=function(e,a){AmpServices.unFavoriteApp(e).done(function(e){return a(e)})};e.getAppIntroduction=function(e,a){AmpServices.appIntroduction(e).done(function(e){return a(e)})};e.updateDesHasUpdateStatus=function(e){AmpServices.updateDesHasUpdateStatus(e)};e.setAppUnViewableDescription=function(e,a){AmpServices.appUnViewableDescription(e).done(function(e){return a(e)})};e.setAppRestoreViewableDescription=function(e,a){e.unviewable=0;AmpServices.appRestoreViewableDescription(e).done(function(e){return a(e)})};e.getUserCategoryAppData=function(a){if(e.space.userCategoryAppData!=null){return a(e.space.userCategoryAppData)}else{AmpServices.getUserCategoryAppList().done(function(t){e.space.userCategoryAppData=t;return a(t)})}};e.getNoReadMessageData=function(e,a){var t={typeId:"-1",typeName:"未读消息"};t=$.extend(t,e);AmpServices.noReadMessageData(t).done(function(e){return a(e)})};e.getFolderData=function(a,t){return t(e.space.folderData[a])};e.getRecentUseApps=function(e){AmpServices.recentUseApps().done(function(a){return e(a)})};e.deleteDesktop=function(e,a){AmpServices.deleteDesktop().done(function(e){return a(e)})};e.restoreDesktop=function(e,a){AmpServices.restoreDesktop().done(function(e){return a(e)})};e.editDesktop=function(e,a){AmpServices.editDesktop(e).done(function(e){return a(e)})};e.editUserDesktopOrder=function(e,a){AmpServices.editUserDesktopOrder().done(function(e){return a(e)})};function t(a,t,i){if(e.space.ehallData[a]){return i(r(a,t))}else{AmpServices.ehallAppData(a).done(function(n){e.space.ehallData[a]=n;return i(r(a,t))})}}function r(a,t){if(t==="recommend"){return i(a,t)}else if(t==="classify"){return e.space.ehallData[a].categoryList}else if(t==="hot"){return e.space.ehallData[a].hotServiceList}else if(t==="new"){return i(a,t)}else{return e.space.ehallData[a]}}function i(a,t){var r=[];var i=e.space.ehallData[a].recommendAndNewAppList;var n=i?i.length:0;for(var s=0;s<n;s++){var o=i[s];var p=o.newApp;if(t==="new"){if(p){r.push(o)}}else{if(!p){r.push(o)}}}return r}e.getDesktopCreatData=function(a){return a(e.space.ampData)};e.desktopCreat=function(e,a){AmpServices.desktopCreat(e).done(function(e){return a(e)})};e.getUserDesktopProperty=function(a){AmpServices.getUserDesktopProperty().done(function(t){e.space.userDesktopPropertyData=t;return a(t)})};e.updateUserDesktopSeq=function(e,a){AmpServices.updateUserDesktopSeq(e).done(function(e){return a(e)})};e.deleteUserDesktopCard=function(e,a){AmpServices.deleteUserDesktopCard(e).done(function(e){return a(e)})};e.getRecommendCard=function(a){return a(e.space.desktopData.appPcCardBizList)};e.updateRecommendCardStatus=function(e,a){AmpServices.updateRecommendCardStatus(e).done(function(e){return a(e)})};e.userDesktopInfo=function(a,t){AmpServices.userDesktopInfo(a).done(function(a){e.space.desktopData=a;AmpGlobal.loginFlag=a.hasLogin?true:false;e.space.ampData=a;return t(a)})};e.desktopInfo=function(a){return a(e.space.ampData)};e.updatePcCardMarkStatus=function(e,a){AmpServices.updatePcCardMarkStatus(e).done(function(e){return a(e)})};e.getTagsMessages=function(e,a){AmpServices.getTagsMessages(e).done(function(e){return a(e)})};e.getUserDescSet=function(a){if(e.space.userDescSetData.length!=null){return a(e.space.userDescSetData)}else{AmpServices.getUserDescSet().done(function(t){e.space.userDescSetData=t;return a(t)})}};e.getrecUseServiceList=function(e){AmpServices.getrecUseServiceList().done(function(a){return e(a)})};e.sendRecUseApp=function(e,a){AmpServices.sendRecUseApp(e).done(function(e){return a(e)})};e.updateUserDesktopStatus=function(e,a){AmpServices.updateUserDesktopStatus(e).done(function(e){return a(e)})};e.getUserSkin=function(a){if(e.space.userSkinData!=null){return a(e.space.userSkinData)}else{AmpServices.getUserSkin().done(function(t){e.space.userSkinData=t;return a(t)})}};e.switchSkin=function(e,a){AmpServices.switchSkin(e).done(function(e){return a(e)})};e.userSearchHistory=function(e){AmpServices.userSearchHistory().done(function(a){return e(a)})};e.getTopExtendList=function(a){if(e.space.expandListData&&e.space.expandListData!=null){return a(e.space.expandListData)}else{AmpServices.getTopExtendList().done(function(t){e.space.expandListData=t;return a(t)})}};e.getUserFirstLogin=function(a){if(e.space.firstLoginFlag!=null){return a(e.space.firstLoginFlag)}else{AmpServices.getUserFirstLogin().done(function(t){e.space.firstLoginFlag=t;return a(t)})}};e.setMsgsRead=function(e,a){AmpServices.setMsgsRead(e).done(function(e){return a(e)})};e.setAllTagMsgsRead=function(e){AmpServices.setAllTagMsgsRead().done(function(a){return e(a)})};e.getTaskCount=function(a){if(e.space.getTaskCountData&&e.space.getTaskCountData!=null){return a(e.space.getTaskCountData)}else{AmpServices.getTaskCount().done(function(t){e.space.getTaskCountData=t;return a(t)})}};e.getTaskDbLcData=function(e,a){AmpServices.getTaskDbLcData(e).done(function(e){return a(e)})};e.getTaskZqfwData=function(e,a){AmpServices.getTaskZqfwData(e).done(function(e){return a(e)})};e.updateUserReadGuidePage=function(e,a){AmpServices.updateUserReadGuidePage(e).done(function(e){return a(e)})};e.getCurrentLocale=function(e){AmpServices.getCurrentLocale().done(function(a){AmpGlobal.loginFlag=a.hasLogin?true:false;return e(a)})};e.checkLogin=function(e){AmpServices.checkLogin().done(function(a){AmpGlobal.loginFlag=a.hasLogin?true:false;return e(a)})};e.setCurrentLocale=function(e,a){AmpServices.setCurrentLocale(e).done(function(e){return a(e)})};e.getUserFavFolders=function(e){AmpServices.getUserFavFolders().done(function(a){return e(a)})};e.saveUserFavFolder=function(e,a){AmpServices.saveUserFavFolder(e).done(function(e){return a(e)})};e.saveFavFolderOperates=function(e,a){AmpServices.saveFavFolderOperates(e).done(function(e){return a(e)})};e.setCurrentEnv=function(e,a){AmpServices.setCurrentEnv(e).done(function(e){return a(e)})};e.dataAnalysisException=function(e,a){AmpServices.dataAnalysisException(e).done(a)};e.updateReceiveDate=function(e,a){AmpServices.updateReceiveDate(e).done(function(){return a(data)})}})(window.AmpDataUtils=window.AmpDataUtils||{});(function(e,a){e.open=function(e){t(e)};function t(e){var a=e.attr("amp-appid");r(e);AmpDataUtils.getAppIntroduction({appId:a},function(t){i(t,a,e.attr("amp-title"))})}function r(e){$("body").find(".ampLoadActiveFlag").addClass("amp-loaded-hide").removeClass("amp-loaded-active");var a=e.attr("amp-title");var t=e.attr("amp-img");var r=e.attr("amp-version");var i=e.attr("amp-category");var s=e.attr("amp-unviewabledescription");var o=e.attr("amp-haspermission");var p=e.attr("amp-descriptionauth");var l=e.attr("amp-opening");var m=e.attr("amp-maintaining");var c="";var d="";var v="";var f="";var u="进入服务";var g="无权限使用";var h="已过期或尚未开放";if(AmpGlobal.currentLang=="en_US"){u=$.i18n("enterTheService");g=$.i18n("noAuthority");h=$.i18n("expiredOrNotOpen")}if(AmpGlobal.loginFlag){if(o=="true"){d="amp-hide";v=u;f="amp-active"}else{c="amp-hide";v=g;d="amp-hide";$("#ampDetailEnter").attr("amp-show-nopermission",true)}if(l=="false"){c="amp-hide";v=h}if(m=="true"){var A="维护期";if(AmpGlobal.currentLang=="en_US"){A=$.i18n("maintenancePeriod")}c="amp-hide";v=A}}else{if(o=="true"){d="amp-hide";v=u;f="amp-active"}else{c="amp-hide";v=g;$("#ampDetailEnter").attr("amp-show-permission",true)}}var C=AmpTemplate.getDetailHtml().replace("@img",t).replace("@title",a).replace("@version",r).replace("@category",i).replace("@loginClass",d).replace("@unviewClass",c).replace("@enterText",v).replace("@enterClass",f).replace("@unviewabledescription",s).replace("@title_category",i);$("body").append(C);if(AmpGlobal.loginFlag){if(l=="false"){c="amp-hide";v=h;d="amp-hide";$("#ampDetailEnter").removeClass("amp-active").attr("amp-show-nopermission",true)}if(m=="true"){var A="正在维护期";if(AmpGlobal.currentLang=="en_US"){A=$.i18n("duringTheMaintenancePeriod")}c="amp-hide";v=A;d="amp-hide";$("#ampDetailEnter").removeClass("amp-active").attr("amp-show-nopermission",true)}}if(o!="true"){$("#ampDetailEnter").attr("amp-show-nopermission",true)}n();AmpUtils.copyAppAttributesFromDomToDom(e,$("#ampDetailEnter"));if(s!=="false"){$("#ampDetailUnViewInput").prop("checked",true)}}function i(e,t,r){var i=e.introduction;if(e.desHasUpdate){var n="更新";var s="更新说明";if(AmpGlobal.currentLang=="en_US"){n=$.i18n("update");s=$.i18n("updateInstructions")}$("#ampDetail").find("h3[data-amp-app-title]").html(r+'<span class="update-instr" data-i18n="updateInstructions">'+s+"</span>");$("#ampDetail").find("div[data-amp-app-service]").html(e.desUpdateTime+"&nbsp;"+n);AmpDataUtils.updateDesHasUpdateStatus({appId:t,desHasUpdate:"0"})}if(!i){i='<img class="amp-detail-null-data" src="portal/images/prompt/null-data.png" />'}var o=$("#ampDetailIntroduction");var p=$("#ampDetailIntroductionContent");var l="";var m="";if(e.appMaintainList.length>0){var c=e.appMaintainList;for(var d=0;d<c.length;d++){var v="维护周期";var f="维护原因";if(AmpGlobal.currentLang=="en_US"){v=$.i18n("maintenanceCycle");f=$.i18n("maintenanceReason")}var u=c[d].beginTime;var g=c[d].endTime;var h=null==c[d].reason||a==c[d].reason?"":c[d].reason;l+='<span class="amp-open-maintain-content"><span data-i18n="maintenanceCycle">'+v+"：</span>"+u+" - "+g+" </span>";l+='<span class="amp-open-maintain-content"><span data-i18n="maintenanceReason">'+f+"：</span>"+h+" </span>"}}if(e.appOpenPeriodList.length>0){var A=e.appOpenPeriodList;for(var d=0;d<A.length;d++){var C=A[d].beginTime;var k=A[d].endTime;var b="开放周期";if(AmpGlobal.currentLang=="en_US"){b=$.i18n("openCycle")}m+='<span  class="amp-open-maintain-content"><span data-i18n="openCycle">'+b+"：</span>"+C+" - "+k+" </span>"}}p.before(l+m);p.html(i);AmpUtils.niceScrollInit(o);var S=e.appAttachFiles;if(null!=S&&a!=S){$("#ampDetailIntroduction").addClass("has-appAttachFile");var y="";for(var d=0;d<S.length;d++){y="<div class='app-attachfile' file-wid='"+S[d].wid+"'><div class='file-icon'>";if(/^.+\.(doc|docx)$/.test(S[d].fileName)){y+="<img src='portal/images/fileIcons/word.png'/>"}else if(/^.+\.(pdf)$/.test(S[d].fileName)){y+="<img src='portal/images/fileIcons/pdf.png'/>"}else if(/^.+\.(ppt|pptx)$/.test(S[d].fileName)){y+="<img src='portal/images/fileIcons/ppt.png'/>"}else if(/^.+\.(xls|xlsx)$/.test(S[d].fileName)){y+="<img src='portal/images/fileIcons/excl.png'/>"}else if(/^.+\.(rar|zip|7z)$/.test(S[d].fileName)){y+="<img src='portal/images/fileIcons/zip.png'/>"}y+="</div><div class='file-name' title='"+S[d].fileName+"'>"+S[d].fileName+"</div></div>";$(".app-attachfile-list").append(y)}$(".ampAppAttachFiles").show()}}function n(){var e=$("#ampDetail");e.on("click",".icon-chacha",function(){s()});e.on("click",".amp-detail-enter",function(){var e=$(this).attr("amp-show-nopermission");if(e){return}else{AmpApp.open($(this))}});e.on("click",".amp-detail-login-btn",function(){AmpHeader.setServiceCookies();AmpUtils.goLoginPage()});e.on("click",".app-attachfile",function(){var e=$(this).attr("file-wid");window.open(AMPConstant.jsonpRequestPath+"getAppAttachFile?fileWid="+e)});$("#ampDetailUnViewInput").on("click",function(){$("#ampDetailUnViewInput").attr("state-change","true");var e=$("#ampDetailUnViewInput").prop("checked");var a=$("#ampDetailEnter").attr("amp-appid");if(e){var t={};t.unviewable=1;t.appId=a;AmpDataUtils.setAppUnViewableDescription(t,function(e){if(e.result=="选择跳过详情页面成功！"){console.log("选择跳过详情页面成功！")}o(t)})}else{var t={};t.unviewable=0;t.appId=a;AmpDataUtils.setAppUnViewableDescription(t,function(e){console.log("选择跳过详情页面成功！");o(t)})}})}function s(){var e=$("#ampDetailUnViewInput");if(e.attr("state-change")==="true"){var a=e.val();var t=e.prop("checked").toString();if(a!==t){var r=$("#ampDetailEnter").attr("amp-appid");var i={appId:r};if(t==="false"){AmpDataUtils.setAppRestoreViewableDescription(i,function(e){})}else{}AmpUtils.synchronousAppAttributes(r,{"amp-unviewabledescription":t})}}$("#ampDetail").remove();$("body").find(".ampLoadActiveFlag").removeClass("amp-loaded-hide").addClass("amp-loaded-active")}function o(e){var a=e.unviewable;var t=e.appId;if(AmpDataUtils.space.allServiceData){var r=AmpDataUtils.space.allServiceData;var i=r.searchResult;for(var n=0;n<i.length;n++){if(i[n].type){var s=i[n].appList;for(var o=0;o<s.length;o++){if(s[o].appId==t){if(a){s[o].unviewableDescription=true}else{s[o].unviewableDescription=false}}}}else{if(i[n].appId==t){if(a){i[n].unviewableDescription=true}else{i[n].unviewableDescription=false}}}}}var p=JSON.parse(sessionStorage.getItem("allCanUseApps"));if(p){var l=p;var m=l.data;var c=l.classify;if(c){for(var n=0;n<c.length;n++){var d=c[n];var s=m[d].appList;if(s){for(var o=0;o<s.length;o++){if(s[o].appId==t){if(a){s[o].unviewableDescription=true}else{s[o].unviewableDescription=false}}}}}}sessionStorage.setItem("allCanUseApps",JSON.stringify(l))}}})(window.AmpDetail=window.AmpDetail||{});(function(e,a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else if(typeof exports==="object"){module.exports=a(require("jquery"))}else{e.AmpDialog=a(e.jQuery)}})(this,function(e){var a=function(a){var t="确定";var r="取消";if(AmpGlobal.currentLang=="en_US"){t=e.i18n("confirm");r=e.i18n("cancel")}var i={title:"",type:"dialog",mask:true,width:500,height:undefined,theme:"",remote:null,content:"",onConfirm:function(e){},onCancel:function(e){},template:['<div class="amp-dialog">','<div class="amp-dialog-content showSweetAlert">','<div class="amp-dialog-header">','<h2 class="amp-dialog-title"></h2>','<i class="amp-dialog-close"></i>',"</div>",'<div class="amp-dialog-body"></div>','<div class="amp-dialog-footer">','<button type="button" class="amp-dialog-ok" data-i18n="confirm">'+t+"</button>",'<button type="button" class="amp-dialog-cancel" data-i18n="cancel">'+r+"</button>","</div>","</div>",'<div class="amp-dialog-mask"></div>',"</div>"].join("")};this.$element=null;e.extend(this,i,a);this.init();return this};a.prototype.init=function(){this._renderDOM();this.bindEvents();this.show()};a.prototype.bindEvents=function(){this.$element.on("click",".amp-dialog-close",e.proxy(this.hide,this)).on("click",".amp-dialog-cancel",e.proxy(this.hide,this)).on("click",".amp-dialog-ok",e.proxy(this.clickOk,this))};a.prototype._renderDOM=function(){var a=e(this.template),t,r;var i=this;t=a.find(".amp-dialog-title");r=a.find(".amp-dialog-body");i.type=e.trim(i.type);a.addClass(function(e,a){var t=[];if(i.type==="alert"||i.type==="confirm"){t.push("amp-dialog__"+i.type)}if(i.theme){t.push(i.theme)}if(i.mask){t.push("amp-dialog--mask")}return t.join(" ")});t.text(this.title);if(this.remote){var n=this.remote;var s=document.createElement("iframe");s.src=n.url;r.append(s);r.css({overflow:"hidden"})}else{r.append(this.content)}a.find(".amp-dialog-content").css({width:i.width,height:i.height});if(i.height){r.height(i.height-106)}this.$element=a;this.$element.appendTo(e("body"));this.$element.niceScroll();return this};a.prototype.show=function(){this.$element.addClass("amp-dialog__active")};a.prototype.hide=function(){this.onCancel.call(this,this.$element);this.$element.remove()};a.prototype.clickOk=function(){this.onConfirm.call(this,this.$element);this.$element.remove()};function t(){}var r=function(e){return new a(e)};return r});(function(e,a){e.space={autoEhallIndex:0,autoClassifyIndex:0};e.init=function(){u();e.setEhallContainerMarginAndNiceScroll();AmpClassify.setClassifyContainerMarginAndNiceScroll();var a=parseInt(AmpDataUtils.space.ampData.userType,10);var i=AmpUtils.getUserRoleId(a);t(i);p(i,"init");var s=$("#ampEhallRoleNav").children(".amp-ehall-nav-item.amp-active");r(s);n(s);g();AmpUtils.setIe9PlaceHolder()};function t(a){var t=$("#ampEhallBody");var i="";if(AmpGlobal.showLoginPageFlag){i="amp-hide"}var s=AmpTemplate.getRoleNavHtml({id:"ampEhallRoleNav",roleId:a,customClass:i});var p="ampClassifyRoleNav";var l=AmpTemplate.getRoleNavHtml({roleId:a,id:p,customClass:"amp-hide"});var m="ampEhallRoleNavAnimateBlock";var c=AmpTemplate.getRoleNavHtml({roleId:a,id:m,customClass:"amp-hide"});var d=$("#ampEhallRoleNavPlaceHolder");if(d.length>0){d.html(s);$("#ampClassifyRoleNavPlaceHolder").html(l);t.append(c);setTimeout(function(){var e=d.offset();var a=e.left;if(!AmpUtils.IsPC()){a+60}$("#"+m).css({top:e.top,left:a});$("#"+p).css({left:a})},AmpGlobal.animateTimes+10)}else{$("#ampClassifyRoleNavPlaceHolder").html(l);t.append(c);setTimeout(function(){var e=($(window).width()-$("#ampClassifyRoleNav").width())/2;if(!AmpUtils.IsPC()){e=e+60}$("#"+m).css({left:e});$("#"+p).css({left:e})},AmpGlobal.animateTimes+10)}t.on("click",".amp-ehall-nav-item",function(a){if($(this).hasClass("amp-active")){return}else{o($(this))}e.space.autoEhallIndex=0;e.space.autoClassifyIndex=0;r($(this));n($(this))})}function r(e){var a=i();clearInterval(a);a=null;$("#ampRecommendSection").mouseover(function(){clearInterval(a);a=null});$("#ampRecommendSection").mouseout(function(){a=i()})}function i(a,t){var r=setInterval(function(){var a=$("#ampEhallRoleNav").children(".amp-ehall-nav-item.amp-active");var t=a;var r=t.attr("amp-role-id");var i=$("#ampRecommendPage"+r+"");var n=i.children();var s=n.length;if(e.space.autoEhallIndex==s){e.space.autoEhallIndex=0}if(i.children().length>0){i.children()[e.space.autoEhallIndex].click();if(i.children("div:eq("+e.space.autoEhallIndex+")").hasClass("amp-active")){e.space.autoEhallIndex++}}},6e3);return r}function n(e){var a=s();clearInterval(a);a=null;$("#ampClassifySection").mouseover(function(){clearInterval(a);a=null});$("#ampClassifySection").mouseleave(function(){a=s()})}function s(t,r){var i=setInterval(function(){var t=$("#ampEhallRoleNav").children(".amp-ehall-nav-item.amp-active");var r=t;var i=r.attr("amp-role-id");var n=$("#ampClassifyPage"+i+"");var s=n.children();var o=s.length;if(e.space.autoClassifyIndex==o){e.space.autoClassifyIndex=0}if(n.children()[e.space.autoClassifyIndex]!=a){n.children()[e.space.autoClassifyIndex].click();if(n.children("div:eq("+e.space.autoClassifyIndex+")").hasClass("amp-active")){e.space.autoClassifyIndex++}}else{return false}},6e3);return i}function o(e){var a=e.attr("amp-role-id");p(a)}function p(e,a){var t=l(e);if(t.loadedFlag){AmpUtils.animateMove(t.toShowData,t.toHideData);AmpClassify.roleNavChangeHandle(t.toShowData,t.toHideData)}else{AmpDataUtils.getEhallData(e,function(t){if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom){m(t,e,a)}else{c(t,e,a)}AmpClassify.getClassifyAppsData(e,a)})}}function l(e){var t=false;var r=$("#ampRecommendSection");var i=$("#ampClassifySection");var n={};var s={};var o=$("#ampEhallRoleNav").length==0?$("#ampClassifyRoleNav"):$("#ampEhallRoleNav");o.children().each(function(o){var p=$(this);var l=p.attr("amp-role-id");if(l===e){n.index=o;n.pageContainer=p;if(r.length>0){n.container=$(r.children("[amp-role-id="+e+"]"))}else{n.container=$(i.children("[amp-role-id="+e+"]"))}if(i.length>0){n.classifyContainer=$(i.children("[amp-role-id="+e+"]"))}if(n.container!=a&&n.container.length){t=true}}if(p.hasClass("amp-active")){s.index=o;s.pageContainer=p;if(r.length>0){s.container=$(r.children("[amp-role-id="+l+"]"))}else{s.container=$(i.children("[amp-role-id="+l+"]"))}if(i.length>0){s.classifyContainer=$(i.children("[amp-role-id="+l+"]"))}}});return{loadedFlag:t,toShowData:n,toHideData:s}}function m(e,a,t){var r=0;if(!e.hotRecNewAppList){e.hotRecNewAppList=null;r=0}else{var i=e.hotRecNewAppList;r=i.length}var n=[];var s=[];var o=[];var p="";var m=3;var c=true;for(var f=0;f<r;f++){var u=i[f];if(f<5){o.push(u)}}var g="推荐服务";if(AmpGlobal.currentLang=="en_US"){g=$.i18n("recommendedService")}if(o.length>0){p+=d(o,c,g);c=false}var h="ampRecommendPage"+a;var A={id:h};var C=t!=="init"?"amp-hide":"amp-active";var k="";if(p){var b="推荐服务";if(AmpGlobal.currentLang=="en_US"){b=$.i18n("recommendedService")}k=$("#tpl-ehall-app-head").html().replace("@recommendedService",b)}$("#ampRecommendSection").html('<div class="amp-animated ampPageBodyFlag '+C+'" amp-role-id="'+a+'">'+'<div class="amp-ehall-apps ampPageContentFlag">'+p+"</div>"+"</div>");$("#ampFudanEhallPage").find('div[amp-role-id="'+a+'"]').addClass("amp-active").siblings("div").removeClass("amp-active");if(t!=="init"){var S=l(a);AmpUtils.animateMove(S.toShowData,S.toHideData)}$("#ampFudanEhallPage").on("click","div",function(){v($(this))})}function c(e,a,t){var r=0;if(!e.hotRecNewAppList){e.hotRecNewAppList=null;r=0}else{var i=e.hotRecNewAppList;r=i.length}var n=[];var s=[];var o=[];var p="";var m=0;var c=true;for(var v=0;v<r;v++){var u=i[v];if(v<15){o.push(u)}else if(v>=15&&v<30){s.push(u)}else{n.push(u)}}var g="推荐服务";if(AmpGlobal.currentLang=="en_US"){g=$.i18n("recommendedService")}if(o.length>0){m++;p+=d(o,c,g);c=false}if(s.length>0){m++;p+=d(s,c,g);c=false}if(n.length>0){m++;p+=d(n,c,g);c=false}var h="ampRecommendPage"+a;var A={id:h};if(m===1){A.customClass="amp-hide"}var C=AmpTemplate.getAppPageHtml(m,A);var k=t!=="init"?"amp-hide":"amp-active";var b="";if(p){var S="推荐服务";if(AmpGlobal.currentLang=="en_US"){S=$.i18n("recommendedService")}b=$("#tpl-ehall-app-head").html().replace("@recommendedService",S)}$("#ampRecommendSection").append('<div class="amp-animated ampPageBodyFlag '+k+'" amp-role-id="'+a+'">'+'<div class="amp-ehall-apps ampPageContentFlag">'+p+"</div>"+C+"</div>");if(t!=="init"){var y=l(a);AmpUtils.animateMove(y.toShowData,y.toHideData)}$("#"+h).on("click","div",function(){f($(this))})}function d(e,a,t){var r="";var i="";var n=e.length;for(var s=0;s<n;s++){r+=AmpTemplate.getAppCardHtml({data:e[s],customClass:"amp-mr-2 amp-mb-2 amp-ehall-apps-card"});var o=(1048-200*5-10)/2;if((s+1)%5===0){if(s!==0){i+='<div class="amp-clearfix-child amp-ehall-apps-line" style="padding:0 '+o+'px;">'+r+"</div>";r=""}}if(s===n-1){if(n<6){var p=(1048-202*n)/2;if(r){i+='<div class="amp-clearfix-child amp-ehall-apps-line" style="padding:0 '+p+'px;">'+r+"</div>"}}else{if(r){i+='<div class="amp-clearfix-child amp-ehall-apps-line" style="padding:0 '+o+'px;">'+r+"</div>"}}}}var l=a?"":"amp-hide amp-animate-move-right-out";return'<div class="amp-ehall-apps-content amp-animated '+l+'">'+i+"</div>"}function v(e){if(e.hasClass("amp-active")){return}e.addClass("amp-active").siblings("div").removeClass("amp-active");var a=e.attr("amp-role-id");p(a)}function f(e){if(e.hasClass("amp-active")){return}var a=e.closest(".ampPageBodyFlag");var t=a.children(".ampPageContentFlag").children();var r=e.parent();var i=e.index();var n=$(t[i]);var s=r.find(".amp-active");var o=s.index();var p=$(t[o]);var l="";var m="";if(i>o){l="amp-animate-move-right-in";m="amp-animate-move-left-out"}else{l="amp-animate-move-left-in";m="amp-animate-move-right-out"}p.removeClass("amp-animate-move-right-in amp-animate-move-left-in").addClass(m).removeClass("amp-hide");setTimeout(function(){p.addClass("amp-hide");n.removeClass("amp-animate-move-right-out amp-animate-move-left-out").addClass(l).removeClass("amp-hide");s.removeClass("amp-active");e.addClass("amp-active")},250)}e.setEhallContainerMarginAndNiceScroll=function(){var e=window.innerHeight;var a=$("#ampEhallArticle");var t=a.children();var r=0;t.each(function(){var e=$(this);var a=e.outerHeight();r+=a});var i=$("#ampPageHeader").outerHeight();if(r+i<e){var n=e-r-i;if(n>144){n=n*.7}var s=parseInt(n/2,10)+"px";if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom){if(!AmpUtils.IsPC()){$("#ampEhallHeader").css({"margin-top":e/4-200+"px","margin-bottom":parseInt(n/2,10)-200+"px"})}else{$("#ampEhallHeader").css({"margin-top":e/4-60+"px","margin-bottom":e-(e/4-60)-240+"px"})}}else{if(!AmpUtils.IsPC()){$("#ampEhallHeader").css({"margin-top":e/4-200+"px","margin-bottom":parseInt(n/2,10)-200+"px"})}else{$("#ampEhallHeader").css({"margin-top":s,"margin-bottom":s})}}}else{AmpUtils.niceScrollInit(a.parent())}};function u(){var e=AMPConfigure.ehallTitle;var a=e.title;var t=e.smallTitle;var r=$("#ampEhallHeader");if(AmpGlobal.currentLang=="en_US"){r.find("h3").html(t);r.find("h3").css("font-size","22px")}else{r.find("h3").html(a);r.find("span").html(t)}}function g(){$("#bannerSearchInput").keydown(function(e){var a=$("#bannerSearchInput").val();if(e.keyCode==13){$("#ampServiceSearchInput").val(a);$("#ampPageHeaderSearch").click();setTimeout(function(){$("#bannerSearchInput").val("")},100)}});$("#ampLoginInBottomDesc").on("click",".amp-fudan-gunlun-icon",function(){var e=1;var a=$("#ampSlidePage").children(".amp-active");var t=a.index();var r=e>t?"down":"up";var i=$("body").find('article[role="slide"][slide-index="'+(t+1)+'"]')[0];slide.slideAnimate(r,i)})}})(window.AmpEhall=window.AmpEhall||{});(function(e,a){e.init=function(){$("#ampBootFaqBody").niceScroll();$(".faq-del-btn").click(function(){$("#ampPtFaq").addClass("amp-hide");var e=$("#ampServiceArticle");if(e.hasClass("ampCurrentBootPageFlag")){$("#ampPageHeaderSearch").click()}AmpBootPage.getActiveTabBootPage()})}})(window.AmpFaq=window.AmpFaq||{});(function(e,a){e.eventsListen=function(){var e=$("body");e.on("mouseover",".appFlag",function(e){var a=$(this);var t=a.find(".appTitleFlag");if(t.length>0){p(t)}else if(a.hasClass("appTitleFlag")){p(a)}});e.on("mouseout",".appFlag",function(e){l(e)});e.on("mouseover",".amp-hover-app-card-group",function(e){var a=$(this);var t=a.find(".appTitleFlag");if(t.length>0){p(t)}else if(a.hasClass("appTitleFlag")){p(a)}});e.on("mouseout",".amp-hover-app-card-group",function(e){l(e)});e.on("click","#ampAppFavIcon",function(e){if(AmpGlobal.loginFlag){t($(this).closest(".appFlag"))}else{AmpUtils.goLoginPage()}e.stopPropagation()})};e.favoriteHandle=function(e){t(e)};function t(e){var a=e.attr("amp-type");var t=e.attr("amp-appid");var n=e.attr("amp-title");var s=e.attr("amp-favorite");var o=AmpUtils.moduleName(e);var p={appId:t,appType:a,appTitle:n,moduleName:o};if(e.hasClass("amp-folder-favorite-btn")){if($.trim(e.find("span").text())=="已收藏"||$.trim(e.find("span").text())=="collected"){i(p);AmpUtils.zhuge("取消收藏应用",{"应用ID":t,"应用名称":e.attr("amp-title"),"来源":o})}else{r(p)}}else{if(e.attr("amp-favorite")==="true"){i(p);AmpUtils.zhuge("取消收藏应用",{"应用ID":t,"应用名称":n,"来源":o})}else{r(p)}}}function r(e){AmpOpenFavorite.open(e)}function i(a){AmpDataUtils.unFavoriteApp({appId:a.appId,type:a.appType},function(){var t="  取消收藏";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("collectionCancelled")}AmpPrompt.show({content:a.appTitle+t});e.favoriteSynchronous(a.appId,"cancel",a.appType);e.syFavoriteFolderApps(a.appId);AmpPersonalCenter.getMyFavoriteApps()});AmpOpenFavorite.unFavoriteCardApp(a)}e.syFavoriteFolderApps=function(e){var e=e;var a=AmpDataUtils.space.folderData;$.each(a,function(a,t){var t=t;var r=t.appList;for(var i=0;i<r.length;i++){var n=r[i];if(e==n.appId){n.favoriteApp=false}}})};e.favoriteSynchronous=function(e,a,t){if(t=="0"){$("body").find('.appFlag[amp-appid="'+e+'"]').each(function(){n($(this),a)})}else{$("body").find('.appFlag[amp-appid="'+e+'"]').each(function(){o($(this),a)})}};function n(e,a){if(a==="cancel"){e.attr("amp-favorite","false")}else{e.attr("amp-favorite","true")}s(e,a)}function s(e,a){var t=e.attr("amp-appid");if(AmpDataUtils.space.allServiceData){var r=AmpDataUtils.space.allServiceData;var i=r.searchResult;for(var n=0;n<i.length;n++){if(i[n].type){var s=i[n].appList;if(i[n].appId==t){if(a==="cancel"){i[n].favoriteApp=false}else{i[n].favoriteApp=true}}for(var o=0;o<s.length;o++){if(s[o].appId==t){if(a==="cancel"){s[o].favoriteApp=false}else{s[o].favoriteApp=true}}}}else{if(i[n].appId==t){if(a==="cancel"){i[n].favoriteApp=false}else{i[n].favoriteApp=true}}}}}}function o(e,a){if(a==="cancel"){e.attr("amp-favorite","false")}else{e.attr("amp-favorite","true")}var t=$("#ampFolderFavoriteBtn");if(t.attr("amp-appid")==e.attr("amp-appid")){if(a==="cancel"){var r="收藏";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("collect")}t.addClass("amp-active").find("span").html(r)}else{var r="已收藏";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("collected")}t.removeClass("amp-active").find("span").html(r)}}s(e,a)}function p(e){if(!e.hasClass("appTitleFlag")){return}if(e.find("#ampAppFavIcon").length===0){var a=e.closest(".appFlag");var t=a.attr("amp-appid");var r=a.attr("amp-favorite");var i="amp-active";if(r!=="true"){i=""}var n=parseInt(e.attr("amp-fav-icon-r"),10);var s=parseInt(e.attr("amp-fav-icon-t"),10);var o={};if(n||n===0){o.right=n+""}if(s||n===0){o.top=s+""}e.append(m(t,i,o))}}function l(e){if($(e.relatedTarget).closest("#ampAppFavIcon").length>0){return}$("body").find("#ampAppFavIcon").remove()}function m(e,a,t){var r="";if(t.right){r+="right: "+t.right+"px;"}if(t.top){r+="top: "+t.top+"px;"}return'<div id="ampAppFavIcon" class="amp-app-card-favorite '+a+'" style="'+r+'">'+'<i class="iconfont icon-aixin" amp-appid="'+e+'"></i>'+"</div>"}})(window.AmpFavorite=window.AmpFavorite||{});(function(e,a){e.open=function(e){t(e);AmpUtils.niceScrollInit($("#ampFolderAppList"))};function t(e){var a=e.attr("amp-appid");AmpDataUtils.getFolderData(a,function(a){r(e,a)})}function r(e,a){var t=e.attr("amp-appid");var r=a.appName;var n=a.appList;var s=n.length;var o="收藏";var p="amp-active";var l=e.attr("amp-favorite");if(AmpGlobal.currentLang=="en_US"){o=$.i18n("collect")}if(l=="true"){o="已收藏";p="amp-favorite";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("collected")}}var m="";for(var c=0;c<s;c++){var d=n[c];var v=AmpTemplate.getAppCardSingleHtml(d);var f=AmpTemplate.getServiceAppCardHtml({data:d,favoriteClass:""});m+=AmpTemplate.getAppCardGroupHtml(v+f)}var u=AmpTemplate.getFolderHtml().replace("@title",r).replace("@tipTitle",r).replace("@appCount",s).replace("@appList",m).replace("@favoriteText",o).replace("@favoriteBtnClass",p);$("body").append(u);i();AmpUtils.copyAppAttributesFromDomToDom(e,$("#ampFolderFavoriteBtn"));$("body").find(".ampLoadActiveFlag").addClass("amp-loaded-hide").removeClass("amp-loaded-active")}function i(){var e=$("#ampFolder");e.on("click",".icon-chacha",function(){n()});e.on("click",".amp-folder-favorite-btn",function(e){if(AmpGlobal.loginFlag){var a=$(this);AmpFavorite.favoriteHandle(a)}else{AmpUtils.goLoginPage()}e.stopPropagation()})}function n(){$("#ampFolder").remove();$("body").find(".ampLoadActiveFlag").removeClass("amp-loaded-hide").addClass("amp-loaded-active")}})(window.AmpFolder=window.AmpFolder||{});(function(e,a){e.rotateYTimeStep=50;e.loginFlag=false;e.showLoginPageFlag=true;e.platformType="1";e.animateTimes=450;e.animateTimesFast=200;e.blurDegree=40;e.currentBgUrl="";e.currentLoginBgUrl="";e.lang={zh:"zh_CN",en:"en_US"};e.currentLang=e.lang.zh;e.personalCenter={leftAsideWidth:416+8,leftAsideWidthPure:416,widgetWidth:540+16,rightAsideNormal:320,rightAsideMini:72,paddingLeft:16}})(window.AmpGlobal=window.AmpGlobal||{});(function(e,a){e.space={showDetailFlag:"null",showIframeList:false};e.eventsListen=function(){$("#ampPageHeaderSearch").on("click",function(a){var r=$(a.currentTarget);var n=$(a.target||a.srcElement);if(n.attr("id")!="ampPageHeaderSearchClose"&&r.find("#ampServiceSearch").hasClass("amp-hide")){AmpUtils.zhuge("访问搜索中心",{"来源":"页面顶部搜索栏"})}$("#ampPersonalArticle").removeClass("ampLoadActiveFlag");$("#ampServiceArticle").addClass("ampLoadActiveFlag");$("#ampEhallBody").removeClass("ampLoadActiveFlag");if(n.attr("id")=="ampPageHeaderSearchClose"){$("#ampServiceArticle").removeClass("ampLoadActiveFlag")}$("#ampExtend").addClass("amp-hide");$("#ampInternationTool").addClass("amp-hide");AMPConfigure.boyaEntranceUrl&&$("#ampHeaderCampusAI").addClass("amp-hide");var s=$("#iframeList");var o=s.css("display");if(o=="block"){e.space.showIframeList=true;s.css("display","none")}var p=$("body").find('[amp-role="dialog"]');if(p.length){p.removeClass("amp-active");setTimeout(function(){p.remove();i("active");t(a)},AmpGlobal.animateTimes)}else{i("active");t(a);P();if(!$("#ampServiceArticle").hasClass("amp-active")){m()}if($("#ampServiceArticle").hasClass("amp-active")){$("#ampPageHeader").addClass("amp-service-header")}if(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE()){$("#ampPersonalAsideLeftMyFavorite").getNiceScroll().remove();$("#ampDesktopContent").getNiceScroll().remove();$("#ampTagMessages").getNiceScroll().remove();$("#ampCategoryTabContent").getNiceScroll().remove()}}b();obj=$(a.srcElement||a.target);if(obj.parent().parent().attr("id")!="ampServiceHistoryBox"&&obj.parent().attr("id")!="ampServiceHistoryBox"&&obj.attr("id")!="ampServiceHistoryBox"){$("#ampServiceSearchInput").focus()}});$("#ampServiceSearch").on("keyup",".ampserviceSearchInputFlag",function(e){r(e)});$("#ampPageHeaderSearchIcon").on("click",function(e){if($("#ampPageHeaderSearch").hasClass("amp-active")){AmpServiceCenter.init()}});$("#ampPageHeaderSearchClose").on("click",function(a){var t=$("#ampServiceArticle");t.removeClass("ampCurrentBootPageFlag");e.closeServiceSearch();P();t.removeClass("ampLoadActiveFlag");$("#ampPageHeader").removeClass("amp-service-header");i("restore");AmpServiceCenter.showPage("hide");e.searchRestore();setTimeout(function(){var a=$("#ampPageHeader");var t=a.find("nav .amp-tab-item.amp-active").attr("id");if(t=="ampPageHeaderPersonalIcon"){$("article.amp-personal.amp-hide").addClass("amp-active").removeClass("amp-hide");$("#ampPersonalArticle").addClass("ampLoadActiveFlag");if(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE()){AmpUtils.niceScrollInit($("#ampPersonalAsideLeftMyFavorite"));AmpUtils.niceScrollInit($("#ampDesktopContent"));AmpUtils.niceScrollInit($("#ampTagMessages"));AmpUtils.niceScrollInit($("#ampCategoryTabContent"))}$("#ampInternationTool").removeClass("amp-hide");AMPConfigure.boyaEntranceUrl&&$("#ampHeaderCampusAI").removeClass("amp-hide");AmpUtils.zhuge("进入个人中心",{"来源":"搜索中心点关闭搜索按钮"})}else{$("#ampEhallBody").find("article.amp-hide").removeClass("amp-hide").addClass("amp-active");$("#ampEhallBody").addClass("ampLoadActiveFlag")}if($("#ampPageHeaderExpandIcon").hasClass("amp-active")){$("#iframeList").css("display","block")}$("#ampPageBgCover").addClass("amp-hide").removeClass("amp-active");$("#ampSlidePage").removeClass("amp-hide");$("#ampExtend").removeClass("amp-hide");if(e.space.showIframeList){var r=$("#iframeList");r.css("display","block")}},450)});$("#ampPageHeaderHomeIcon").on("click",function(a){AmpUtils.zhuge("访问办事大厅",{});$("#bannerSearchInput").val("");if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom){if($("#ampEhallSlideIndex").hasClass("amp-active")){AmpUtils.animateLoginIn()}}if($("#ampLoginInArticle").hasClass("amp-active")){AmpUtils.animateLoginIn()}$("#ampExtend").removeClass("amp-hide");$("#ampInternationTool").addClass("amp-hide");AMPConfigure.boyaEntranceUrl&&$("#ampHeaderCampusAI").addClass("amp-hide");var t=$("#iframeList");t.css("display","none");e.space.showIframeList=false;$("#ampPersonalArticle").removeClass("ampLoadActiveFlag").removeClass("amp-loaded-active");$("#ampServiceArticle").removeClass("ampLoadActiveFlag").removeClass("amp-loaded-active");$("#ampEhallBody").addClass("ampLoadActiveFlag");$("#iframeList").css("display","none");$("#ampEhallBody").removeClass("amp-hide");setTimeout(function(){$("#ampPersonalArticle").removeClass("amp-active")},150);v();m();P();e.closeServiceSearch();$("#ampPageHeader").removeClass("amp-service-header");var r=$("#ampPageBgCover");$("#ampEhallBody").find("article.amp-hide").removeClass("amp-hide").addClass("amp-active");if(!r.hasClass("amp-hide")){r.removeClass("amp-active").addClass("amp-hide");$("#ampSlidePage").removeClass("amp-hide")}$("#ampServiceArticle").addClass("amp-hide").removeClass("amp-active");var i=$("#ampPersonalArticle");i.removeClass("amp-active");AmpPersonalCenter.hideMainWidgets();var n=$("#ampEhallBody");n.removeClass("amp-hide");$("#ampPageHeaderHomeIcon").addClass("amp-active");$("#ampPageHeaderPersonalIcon").removeClass("amp-active");$("#ampPageHeaderExpandIcon").removeClass("amp-active");if(!n.hasClass("ampLoadedFlag")){AmpLoginIn.init();AmpEhall.init();n.addClass("ampLoadedFlag")}b()});$("#ampExtend").on("click",".amp-extend-more",function(){o($("#ampExtendMore"))});$("body").on("click",".extendItemFlag",function(){var e=$("#iframeList");var a=$(this).attr("data-url");var t=$(this).attr("data-menu-id");var r=$(this).attr("data-isOpenNew");if(r==1||r=="1"){window.open(a)}else{e.css("display","block");$("#ampPersonalArticle").removeClass("amp-active");$("#ampEhallBody").addClass("amp-hide");$("#ampLoadingPage").addClass("amp-hide");var i=e.find('iframe[data-menu-id="'+t+'"]');var n=i.length;if(n){i.css("opacity","1");i.siblings("iframe").css("opacity","0")}else{e.children().css("opacity","0");var s="opacity:1;position: absolute;width:100%;";var o=d();e.css({top:"44px",height:o.height+"px"});s+="height:"+o.height+"px;";var p='<iframe data-menu-id="'+t+'"  data-type="loading" src="'+a+'" allowtransparency="true" frameborder="0" scrolling="yes" style="'+s+'"></iframe>';e.append(p)}}$("#ampHeaderExpand").removeClass("amp-active");var l=$(this).attr("data-name");AmpUtils.zhuge("打开拓展URL",{"拓展URL名称":l,"拓展URL地址":a})});$("#ampPageHeader").on("click",".amp-service-searchHistory-item",function(){var e=$(this).text();$("#ampPageHeaderSearchInput").val(e);AmpServiceCenter.init()});$("#ampPageHeaderPersonalIcon").on("click",function(a){var t="";if($("#ampPageHeaderHomeIcon").hasClass("amp-active")&&$("#ampEhallBody").hasClass("amp-hide")){t="登陆后"}else if($("#ampPageHeaderHomeIcon").hasClass("amp-active")&&$("#ampEhallBody").hasClass("ampLoadActiveFlag")){t="办事大厅点个人中心按钮"}else if($("#ampServiceArticle").hasClass("amp-active")){t="搜索中心点个人中心按钮"}$("#ampExtend").removeClass("amp-hide");$("#ampInternationTool").removeClass("amp-hide");AMPConfigure.boyaEntranceUrl&&$("#ampHeaderCampusAI").removeClass("amp-hide");var r=$("#iframeList");r.css("display","none");e.space.showIframeList=false;$("#ampPersonalArticle").addClass("ampLoadActiveFlag");$("#ampServiceArticle").removeClass("ampLoadActiveFlag");$("#ampEhallBody").removeClass("ampLoadActiveFlag");$("#ampServiceArticle").removeClass("ampLoadActiveFlag").removeClass("amp-loaded-active");$("#iframeList").css("display","none");m();v();e.closeServiceSearch();P();$("#ampPageHeader").removeClass("amp-service-header");var i=$("#ampPageBgCover");if(!i.hasClass("amp-hide")){i.removeClass("amp-active").addClass("amp-hide")}AmpUtils.niceScrollInit($("#ampDesktopContent"));AmpUtils.niceScrollInit($("#ampTagMessages"));AmpUtils.niceScrollInit($("#ampCategoryTabContent"));if(AmpGlobal.loginFlag){$("#ampPageBgImg").addClass("amp-page-img").removeClass("amp-login-img");AmpUtils.getUserSkinImg();$("#ampEhallBody").addClass("amp-hide");$("#ampServiceArticle").addClass("amp-hide").removeClass("amp-active");var n=$("#ampPersonalArticle");n.addClass("amp-active").removeClass("amp-hide");if(!n.hasClass("ampLoadedFlag")){AmpPersonalCenter.init();n.addClass("ampLoadedFlag")}else{AmpPersonalCenter.showMainWidgets()}$("#ampPageHeaderHomeIcon").removeClass("amp-active");$("#ampPageHeaderPersonalIcon").addClass("amp-active");$("#ampPageHeaderExpandIcon").removeClass("amp-active");AmpUtils.containerBlurAnimate($("#ampPageBgImg"),"restore");if(AmpGlobal.platformType!="0"){AmpDataUtils.getUserFirstLogin(function(e){var a=e.isFirstLogin;var t=e.isReadGuidePage;if(e.isFirstLogin&&!e.isReadGuidePage){if(!(AMPConfigure.switchPortalSiteModel&&e.siteType=="1")){var r=$("#ampBootPage");var i=$("#tpl-bootpage-img-gif").html();$("#ampBootMainSide").html(i);n.removeClass("amp-active").addClass("amp-hide");r.removeClass("amp-hide").addClass("amp-active");AmpBootPage.init();AmpUtils.zhuge("播放引导动画",{"来源":"首次进入"})}}})}AmpUtils.zhuge("进入个人中心",{"来源":t})}else{AmpUtils.goLoginPage()}b()});$("#ampNoLoginTool").on("click",function(){e.setServiceCookies();AmpUtils.goLoginPage()});$("#ampHeaderToolUser").on("click",function(){n($("#ampHeaderToolUser"))});$("#ampHeaderToolUserName").on("click",function(){n($("#ampHeaderToolUserName"))});$("#ampHeaderToolSkin").on("click",function(){s($("#ampHeaderToolSkin"))});$("#ampHeaderToolFeedback").on("click",function(){p($("#ampHeaderToolFeedback"))});$("#ampShellHeaderToolFeedback").on("click",function(){c();$(this).find("i").addClass("amp-keep");AmpFeedback.window({uploadUrl:AMPConstant.requestPath+AMPConstant.APIList.feedbackImgUpload,submitUrl:AMPConstant.jsonpRequestPath+AMPConstant.APIList.feedbackSubmit,readAllDomain:AMPConstant.jsonpRequestPath+"readAllDomain"})});$("#ampInternationTool").on("click",".ampItemLang,.icon-language",function(e){var a=$("#ampInternationTool").find("span.ampItemLang.amp-hide").siblings("span.ampItemLang");if(!a.hasClass("amp-hide")){var t=a.attr("data-lang");w(t);var r=a.children("span").text();AmpUtils.zhuge("切换中英文",{"选择语言":r})}});$("body").on("click","#ampHeaderUserInfoLogoutBtn",function(e){var a=$(e.target||e.srcElement);if(a.attr("id")==="ampHeaderUserInfoLogoutBtn"){AmpUtils.logout()}});$("body").on("click","#ampHeaderUserInfoAdminBtn",function(e){var a=$(e.target||e.srcElement);if(a.attr("id")==="ampHeaderUserInfoAdminBtn"){window.open(AMPConstant.requestPath+"manage/index.html")}});$("body").on("click","#ampHeaderPersonalCenter",function(e){var a=$(e.target||e.srcElement);if(a.attr("id")==="ampHeaderPersonalCenter"){var t=publicAppPath+basePath;t=t.slice(-1)==="/"?t.slice(0,t.length-1):t;var r=AMPConfigure.personalCenterAuthserverUrl+"?service="+t;window.open(r,"_self")}});$("body").on("click","#ampPortalSiteModel",function(e){var a=$(e.target||e.srcElement);if(a.attr("id")==="ampPortalSiteModel"){var t="1";var r={};r.siteType=t;AmpDataUtils.switchSkin(r,function(e){if(e.result=="success"){try{AmpUtils.dataAnalysis("切换站点",{siteType:t,content:"标准版到简约版"});I()}catch(e){console.log(e.message)}}else{}})}});$("#ampHeaderNoReadMessage").on("click",function(){window.open("portal/html/message/scenes_message_center.html")});$("body").on("click",".amp-skin-close",function(e){$(e.target).closest(".amp-header-user-skin").removeClass("amp-active");$("#ampHeaderToolSkin").find("i").removeClass("amp-keep")});$("body").on("click",".amp-header-help-info",function(e){var a=$(e.target||e.srcElement);if(a.attr("id")==="ampHelpFeedbak"){AmpFeedback.window({uploadUrl:AMPConstant.requestPath+AMPConstant.APIList.feedbackImgUpload,submitUrl:AMPConstant.jsonpRequestPath+AMPConstant.APIList.feedbackSubmit,readAllDomain:AMPConstant.jsonpRequestPath+"readAllDomain"})}else if(a.attr("id")==="ampHelpBootpage"){U();S();AmpUtils.zhuge("播放引导动画",{"来源":"重放引导动画"})}else if(a.attr("id")==="ampHelpBootFaq"){U();var t=$("#ampPersonalArticle");var r=$("#ampServiceArticle");if(r.hasClass("amp-active")){$("#ampPageHeaderSearchClose").click();setTimeout(function(){t.removeClass("amp-active").addClass("amp-hide");r.addClass("ampCurrentBootPageFlag")},450)}else{t.removeClass("amp-active").addClass("amp-hide")}$("#ampPtFaq").removeClass("amp-hide")}$("#ampHeaderHelpInfo").removeClass("amp-active");$("#ampHeaderToolFeedback").find("i").removeClass("amp-keep")});$(document).click(function(e){e=window.event||e;obj=$(e.srcElement||e.target);var a=obj.parent().attr("id");if(a!="ampHeaderToolFeedback"&&obj.closest(".amp-header-help-info").attr("id")!="ampHeaderHelpInfo"){$("#ampHeaderHelpInfo").removeClass("amp-active");$("#ampHeaderToolFeedback").find("i").removeClass("amp-keep")}if(obj.attr("id")!="ampExtendMore"&&obj.attr("id")!="ampHeaderExpand"&&obj.closest(".amp-header-expand").attr("id")!="ampHeaderExpand"){v()}if(a!="ampHeaderToolSkin"&&obj.closest(".amp-header-user-skin").attr("id")!="ampHeaderUserSkin"){c()}if(obj.parent().parent().attr("id")!="ampServiceHistoryBox"&&obj.closest(".amp-service-history-dialog").attr("id")!="ampHistoryBox"){$("#ampHistoryBox").remove()}if(obj.closest(".amp-myfavorite-create-folder").attr("id")!="ampMyFavoriteCreateFolder"&&obj.closest(".myfavorite-create-folder").attr("amp-id")!="create"){AmpMyfavoriteApp.removeCreateFolderDialog(obj)}if(navigator.userAgent.indexOf("MSIE 9.0")>0){if(obj.attr("id")!="ampServiceSearchInput"&&(obj.closest(".amp-service").attr("id")=="ampServiceArticle"||obj.closest(".amp-header").attr("id")=="ampPageHeader")){AmpServiceCenter.searchBoxBlur()}}if(obj.closest(".amp-recommend-show-desktopnav").attr("id")!="ampRecommendShowDesktop"&&obj.closest(".desktop-title").attr("id")!="ampDesktopTitle"){$("#ampRecommendShowDesktop").hide()}if(obj.attr("id")!="ampDesktopAddBtn"&&obj.closest(".ampDesktopAddFlag").attr("id")!="ampDesktopAddBtn"&&obj.closest(".amp-create-desktop").attr("id")!="ampAdminNewDesktop"&&obj.attr("id")!="emptyDesktopCreate"){if($("#ampAdminNewDesktop").length>0){$("#ampDesktopAddBtn").removeClass("amp-btn-active");var t=$(".empty-desktop-create");if(t.length>0){t.removeClass("amp-btn-active")}}var r=$('div[amp-type="dialog"]');if(r.length>0){r.remove()}}if(obj.closest(".amp-service-search-input").attr("id")!="ampServiceSearch"&&obj.closest(".amp-searchName-box").attr("id")!="ampSearchNameBox"){P()}if(!(obj.closest(".amp-app-operate").length>0)&&!obj.hasClass("amp-app-operateBtn")){$("#myFavoriteTabListId").find(".amp-app-operate").addClass("amp-hide")}});$("body").on("click",".amp-header-user-skin",function(e){var a=$("#ampHeaderUserSkin");var t=$(e.target||e.srcElement);var r=$("#skinSwitchText");var i=$("#ampSkinContent");var n="";var s="";var o="";var p="";var l="";o=$("#skinSwitch").prop("checked");if(typeof o=="undefined"){o=localStorage.themeColor}if(t.attr("id")=="skinSwitch"){if(o){var m="开启";if(AmpGlobal.currentLang=="en_US"){m=$.i18n("openSkin")}r.text(m);s="dark";$("#ampPersonalArticle").removeClass("amp-personCenter-bg")}else{var m="关闭";if(AmpGlobal.currentLang=="en_US"){m=$.i18n("closeSkinCool")}r.text(m);s="white";$("#ampPersonalArticle").addClass("amp-personCenter-bg")}n=i.find(".ampSkinUseFlag").attr("amp-skin");p=i.find(".ampSkinUseFlag").find(".skin-item-name").children("span").text();l="护眼模式"+o?"开启":"关闭"}else if(t.attr("class")=="skin-item-check"||t.parent().attr("class")=="skin-item-check"){var c=t.closest(".amp-skin-item");c.siblings(".amp-skin-item").removeClass("ampSkinUseFlag").addClass("ampSkinCheckFlag");c.addClass("ampSkinUseFlag").removeClass("ampSkinCheckFlag");n=c.attr("amp-skin");s=localStorage.themeColor;p=c.find(".skin-item-name").children("span").text();l="护眼模式"+o?"开启":"关闭"}else{return}var d={};d.themeColor=s;d.skinName=n;g($(this),d);AmpDataUtils.switchSkin(d,function(e){if(e.result=="success"){localStorage.themeColor=s;localStorage.skinName=n;localStorage.userSkinHtml=$("#ampSkinContent").html();AmpGlobal.currentBgUrl=e.bgUrl;AmpGlobal.currentLoginBgUrl=e.loginBgUrl;AmpUtils.getUserSkinImg()}else{}});AmpUtils.zhuge("切换主题或皮肤",{"展示模式":l,"皮肤":p})});$("body").on("click",".amp-wf-body",function(){var e=$(this).closest(".amp-widget").children().attr("widget_title");AmpUtils.zhuge("操作卡片",{"卡片名称":e})})};e.searchBoxFocus=function(){var e=316;var a=$("#ampPageHeader");var t=a.children(".amp-header-logo").outerWidth(true);var r=a.children(".amp-header-nav").outerWidth(true);var i=t+r;var n=i<=e?e:i+8;$("#ampPageHeaderSearch").addClass("amp-active").css("left",n+"px")};e.searchBoxBlur=function(){var e=$("#ampPageHeaderSearchInput");e.blur(function(){var a=$.trim(e.val());if(!a){var t="搜索服务";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("searchService")}$(this).attr("placeholder",t)}})};e.searchRestore=function(){$("#ampPageHeaderSearchInput").blur().val("");$("#ampPageHeaderSearch").removeClass("amp-active").removeAttr("style")};e.changeLanguage=function(e){var t=$.i18n();var r="";if(e!=a){r=e}else{r=AmpUtils.getCookie("amp.locale");r=r=="undefined"?"zh_CN":r}t.locale=r;t.load("portal/i18n/"+t.locale+".json",t.locale).done(function(){$("[data-i18n]").i18n()})};function t(a){var t=$(a.target||a.srcElement);if(t.attr("id")==="ampPageHeaderSearchClose"){return}e.searchBoxFocus();e.searchBoxBlur();if(!$("#ampServiceArticle").hasClass("amp-active")){var r=AmpUtils.getCookie("openLoginServicePageFlag");var i=AmpUtils.getCookie("loginServiceserchVal");var n=AmpUtils.getCookie("loginServiceclassifyId");var s=AmpUtils.getCookie("loginServiceroleId");if(i==" loginServiceclassifyId=all"){i=""}if(r=="true"){if(i!=""){$("#ampServiceSearchInput").val(i)}if(n=="all"&&s=="all"){AmpServiceCenter.init()}else{AmpServiceCenter.init({labels:[n,s]})}AmpUtils.setCookie("loginServiceSearchVal","");AmpUtils.setCookie("openLoginServicePageFlag","false")}else{AmpServiceCenter.init()}e.openServiceSearch()}}e.openServiceSearch=function(){var e=$("#ampPageHeaderSearch");e.find(".ampHeaderSearchFlag").addClass("amp-hide");e.find(".ampServiceSearchFlag").removeClass("amp-hide");$("#ampPageHeaderSearch").css("width","416px")};e.closeServiceSearch=function(){var e=$("#ampPageHeaderSearch");e.find(".ampHeaderSearchFlag").removeClass("amp-hide");e.find(".ampServiceSearchFlag").addClass("amp-hide")};function r(e){var a=e.keyCode;if(a===13){AmpServiceCenter.init();P();$("#ampServiceSearchInput").blur()}}function i(e){var a=$("#ampPageHeader");if(e==="active"){a.addClass("ampServiceActiveFlag")}else{a.removeClass("ampServiceActiveFlag")}}function n(e){c();var a=AmpUtils.getContainerPosition(e);var t=$("#ampHeaderUserInfo");t.css({left:parseInt(a.right-t.outerWidth())+"px",top:parseInt(a.bottom+4,10)+"px"}).toggleClass("amp-active")}function s(e){var a=AmpUtils.getContainerPosition(e);var t=$("#ampHeaderUserSkin");var r=344;t.css({left:parseInt(a.right-344)+"px",top:parseInt(a.bottom+4,10)+"px"}).toggleClass("amp-active");if(t.hasClass("amp-active")){e.find("i").addClass("amp-keep")}else{e.find("i").removeClass("amp-keep")}}function o(e){var a=AmpUtils.getContainerPosition(e);var t=$("#ampHeaderExpand");var r=180;t.css({left:parseInt(a.right-r)+"px",top:parseInt(a.bottom+4,10)+"px"}).toggleClass("amp-active")}function p(e){var a=AmpUtils.getContainerPosition(e);var t=$("#ampHeaderHelpInfo");t.css({left:parseInt(a.right-180)+"px",top:parseInt(a.bottom+4,10)+"px"}).toggleClass("amp-active");if(t.hasClass("amp-active")){e.find("i").addClass("amp-keep")}else{e.find("i").removeClass("amp-keep")}}function l(e){var a=AmpUtils.getContainerPosition(e);var t=$("#ampInterNationUeBox");var r=$("#ampInternationTool");var i=r.find("span:not(.amp-hide)").width();var n=14;t.css({left:parseInt(a.right-(i+n))+"px",top:parseInt(a.bottom+20,10)+"px"}).toggleClass("amp-active")}function m(){$("#ampServiceLabelNav").find(".amp-active").removeClass("amp-active")}function c(){var e=$("#ampHeaderUserSkin");var a=$("#ampHeaderToolSkin");var t=e.hasClass("amp-active");if(t){e.removeClass("amp-active");a.find("i").removeClass("amp-keep")}}function d(){var e=AmpUtils.getScreenWidthHeight();var a=$("#iframeList");var t=e.screenH-44;var r=t;return{height:r,width:e.screenW}}function v(){var e=$("#ampHeaderExpand");e.removeClass("amp-active")}var f=0;var u=true;function g(a,t,r){var i=$("#ampHeaderUserSkin");i.find(".bh-skin-layer").addClass("bh-skin-layer-active");AmpLoading.show();u=false;var a=a;var n=t.skinName;var s=t.themeColor;e.loadingCurrentSkin(t)}e.loadingCurrentSkin=function(e){var a=e.themeColor;var t=e.skinName;var r=h(t);var i=self===parent?r+a+"/":"../css/"+a+"/";if(self!==parent){if(/\/model\./.test(window.location.href)){i="../../css/"+a+"/"}else{i="../css/"+a+"/"}}C(i+t+"/amp.min.css",a,t);C(i+t+"/skin.min.css",a,t)};function h(e){var a=AMPConfigure.portalSkin_custom;var t=AMPConfigure.resSkinCssPath;if(typeof a!="undefined"){skinList=a.length;if(skinList>0){for(var r=0;r<skinList;r++){var i=a[r];if(i.enable&&i.skinColor==e){t="portal_custom/css/";break}}}}return t}function A(e,a){var t=$("#ampHeaderUserSkin");$("head").find("link").each(function(){var r=$(this);var i=r.attr("href");var n=new RegExp(e+"/"+a+"","");if(/\/amp.min.css$/.test(i)||/\/skin.min.css$/.test(i)||/\/amp_custom.css$/.test(i)){if(!n.test(i)){r.remove();t.find(".bh-skin-layer").removeClass("bh-skin-layer-active")}}})}function C(e,a,t){var r=false;$("head").find("link").each(function(){var i=$(this);var n=i.attr("href");var s=new RegExp(a+"/"+t+"","");if(/\/amp.min.css$/.test(n)||/\/skin.min.css$/.test(n)){if(n==e){r=true}}});if(!r){var i=document.getElementsByTagName("head")[0];var n=document.createElement("link");n.type="text/css";n.rel="stylesheet";n.href=e;i.appendChild(n);n.onload=function(){k(a,t)};if(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE()){n.onreadystatechange=function(){if(n.readyState==="loaded"||n.readyState==="complete"){k(a,t)}}}}}function k(e,a){var t=document.getElementsByTagName("head")[0];f++;if(f===2){u=true;f=0;AmpLoading.close();setTimeout(function(){A(e,a);if(AMPConfigure.portalTheme_custom){var r=document.createElement("link");r.type="text/css";r.rel="stylesheet";r.href="portal_custom/css/"+e+"/amp_custom.css";t.appendChild(r)}},100)}}function b(){var e=$("#ampDesktopSet");var a=e.parent().parent();if(a.length&&a.hasClass("amp-active")){$("#ampDesktopSet").find(".amp-desktop-set-close-icon").click()}}function S(){var e=$("#ampServiceArticle");if(e.hasClass("amp-active")){$("#ampPageHeaderSearchClose").click();setTimeout(function(){y();e.addClass("ampCurrentBootPageFlag")},450)}else{y()}}function y(){var e=$("#ampBootPage");var a=$("#ampPersonalArticle");var t=$("#ampEhallBody");var r=$("#ampHeaderNav");var i=$("#ampServiceArticle");var n=r.find("i.amp-active").attr("id");if(n=="ampPageHeaderHomeIcon"){t.addClass("amp-opcity-bottom")}else if(n=="ampPageHeaderPersonalIcon"){a.removeClass("amp-active").addClass("amp-hide")}e.removeClass("amp-hide").addClass("amp-active");AmpBootPage.init("reload")}function w(e){var a=e;AmpDataUtils.setCurrentLocale(a,function(e){if(e.result=="success"){console.log("中英文切换成功！");AmpGlobal.currentLang=a;AmpUtils.setCookie("amp.locale",a);localStorage.localeLang=a;AmpHeader.changeLanguage();localStorage.changeLanguageFlag="true";window.location.reload()}})}function P(){$("#ampSearchNameBox").remove()}e.initServiceCenterSousuo=function(){var e="搜索服务";var t="历史";if(AmpGlobal.currentLang=="en_US"){e="Search";t="History"}if($("#tpl-serviceCenter-sousuo-input").html()!=a){var r=$("#tpl-serviceCenter-sousuo-input").html().replace("@placeholder",e).replace("@history",t);$("#ampServiceSearch").html(r)}};function I(){AmpUtils.setTeacherSide()}e.setServiceCookies=function(){var e=$("#ampServiceArticle");if(e.hasClass("amp-active")){var a=AmpUtils.getCookie("openLoginServicePageFlag");if(a!="true"){var t=$("#ampServiceSearchInput").val();var r=$("#ampServiceLabelNav").find('li[amp-label-type="1"].amp-active').attr("amp-label-id");var i=$("#ampServiceLabelNav").find('li[amp-label-type="2"].amp-active').attr("amp-label-id");var n={};n.inputVal=t;n.classifyId=r;n.roleId=i;AmpUtils.setCookie("openLoginServicePageFlag","true");AmpUtils.setCookie("loginServiceserchVal",t);AmpUtils.setCookie("loginServiceclassifyId",r);AmpUtils.setCookie("loginServiceroleId",i)}}};function U(){var e=$("#ampPageHeaderPersonalIcon");var a=$("#ampPersonalArticle");if(!e.hasClass("amp-active")||!a.hasClass("amp-active")){e.click()}}})(window.AmpHeader=window.AmpHeader||{});var AMP_SPACE={};$(function(){a();i();n();AmpHeader.eventsListen();AmpUtils.bodyEventsListen();AmpFavorite.eventsListen();AmpApp.eventsListen();AmpWidgetCustom.eventsListen();AmpUtils.tooltipInit();AmpFaq.init();t();o();p();e();$(window).resize(function(){e()});function e(){AmpLoginIn.setLoginConteinerMargin();var e=(window.innerWidth-1040)/2;$("#ampLoginArticle").css("margin-left",e);$("#ampLoginArticle").css("margin-right",e);$("#ampEhallArticle").css("margin-left",e);$("#ampEhallArticle").css("margin-right",e);AmpEhall.setEhallContainerMarginAndNiceScroll();AmpClassify.setClassifyContainerMarginAndNiceScroll();$("#ampClassifyRoleNav").css("left",e);$("#ampClassifyArticle").css("width",window.innerWidth);var a=$(".amp-classify-container").find(".amp-classify-apps").length;if(a>0){$(".amp-classify-container").css("text-align","left");var t=(window.innerWidth-208*a)/2;$(".amp-classify-container").find(".amp-classify-apps:eq(0)").css("margin-left",t)}AmpDesktopSet.setContainerMaxHeight()}function a(){AmpDataUtils.getUserSkin(function(e){sessionStorage.setItem("current_theme",e.themeEyeShieldSwitch)})}function t(){AmpUtils.setSessionStorageData("schoolId",AMPConfigure.schoolId);AmpUtils.setSessionStorageData("footer",AMPConfigure.footer.normal);var e=JSON.stringify(AMPConfigure);AmpUtils.setLocalStorageData("schoolConfig",e);AmpUtils.setSessionStorageData("schoolConfig",e);AmpUtils.setSessionStorageData("logo",AMPConfigure.logo.normal)}function r(e){var e=e;var a="";switch(e){case"blue":a="indigo";break;case"cyan-arctic":a="teal";break;case"green-olive":a="millennium";break;case"red-strawberry":a="cherry";break;case"purple":a="magenta";break;case"yellow-fawn":a="golden";break;default:a=e}return a}function i(){if(typeof AMPConfigure.homepage_custom!="undefined"){if(AMPConfigure.homepage_custom.enable){var e=AMPConfigure.homepage_custom.loading_name;var a="";var t=window.location.host;var r=window.location.pathname;var i=r.split("/");var n="";var s=false;for(var o=0;o<i.length;o++){if(o==i.length-1){if(e){n+="/"+e}else{n+="/index_custom.html"}if(i[o]==e){s=true}}else{if(i[o]!="")n+="/"+i[o]}}a=t+n;if(!s){window.location.href=window.location.protocol+"//"+a}}}}function n(){AmpGlobal.showLoginPageFlag=AMPConfigure.showLoginPageFlag;var e=$("#ampEhallSlideIndex");var a=$("#ampClassifyArticle");var t=$("#ampLoginInArticle");var r=$("#ampEhallHeaderContent");var i=$("#ampPageBgImg");if(AmpGlobal.showLoginPageFlag){e.attr("slide-index","2");a.attr("slide-index","3")}else{t.remove();r.removeClass("amp-hide");e.attr("slide-index","1");e.addClass("amp-active");a.attr("slide-index","2");i.removeClass("amp-login-img").addClass("amp-page-img");if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom){var n="";var s="";s=AmpTemplate.getEhallFudanPageHtml();var o="搜索您需要的服务";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("searchTheServicesYouNeed")}if($("#tpl-ehall-fudan").length>0){n=$("#tpl-ehall-fudan").html().replace("@pageHtml",s).replace("@placeholderStr",o)}$("#ampEhallSlideIndex").html(n);$("#ampEhallHeaderContent").removeClass("amp-hide");var p=$("#tpl-header-fudan-tab").html();$("#ampHeaderNav").html(p);$("#ampExtend").css("margin-left","300px");i.addClass("amp-login-img").removeClass("amp-page-img");if($("#ampPageBgImg").hasClass("amp-page-img")){$("#ampPageBgImg").css("background",params_imgs.bgUrl)}else{$("#ampPageBgImg").css("background",params_imgs.loginBgUrl)}}else{$("#ampFuDanEhallArticle").remove();$("#ampEhallHeaderContent").removeClass("amp-hide")}}}function s(e){var e=e.data;var a=e.length;var t="";var r="";var i="";var n="";var s=$("#ampExtend");var o=$(window).width();var p="";if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom){p=o/2-468;s.addClass("amp-extend-fudan")}else{p=o/2-368}var l=Math.floor(p/100);for(var m=0;m<e.length;m++){var c=e[m].name;var d=e[m].url;var v=e[m].wid;var f=e[m].isOpenNewWindow;var u=e[m].isAddUserid;if(u=="1"||u==1){var g=sessionStorage.ampUserId;if(d.indexOf("?")<0){d=d+"?userId="+g}else{d=d+"&userId="+g}}if(m<l){if($("#tpl-header-extend-list").length>0){t+=$("#tpl-header-extend-list").html().replace("@menuId",v).replace("@menuUrl",d).replace("@dataName",c).replace("@isOpenNewWindow",f).replace(/@extendName/g,c)}}else{r+=AmpTemplate.headerExpandItem(e[m])}}i=AmpTemplate.headerExpandDialogHtm(r);if(r!==""){n=$("#tpl-header-expand-more").html();s.html(t+n);$("body").append(i)}else{$("#ampExtend").html(t)}var h=$(".amp-header-logo").width();var A="";if(h<=200){A=h+110+"px"}else{A="330px"}$("#ampExtend").css("margin-left",A)}function o(){var e=AmpTemplate.getHeaderInternationHtml();$("body").append(e)}function p(){AmpDataUtils.getCurrentLocale(function(e){if(e.result=="success"){AmpGlobal.platformType=e.platformType;slide.init();var a=e.functionEnglishOn;var t=e.localeLang;if(t=="zh"){t="zh_CN"}else if(t=="en"){t="en_US"}AmpUtils.setCookie("amp.locale",t);localStorage.localeLang=t;if(a=="true"){AmpGlobal.currentLang=t;if(t=="zh_CN"){$("#ampInternationTool").find(".ampInterEnIcon").removeClass("amp-hide")}else{$("#ampInternationTool").find(".ampInterZhIcon").removeClass("amp-hide")}}else{$("#ampInternationTool").addClass("amp-internation-tool-hide")}AmpHeader.changeLanguage(t);if(AmpGlobal.loginFlag){m()}else{c();AmpUtils.deleteSessionStorageData("ampUserId");AmpUtils.deleteSessionStorageData("ampUserID");AmpUtils.deleteSessionStorageData("ampUserName");AmpUtils.deleteSessionStorageData("userType");AmpUtils.deleteSessionStorageData("ampUserTypeName");AmpUtils.deleteSessionStorageData("ampUserDepartment");AmpUtils.deleteSessionStorageData("ampUserSex");AmpUtils.deleteSessionStorageData("roles");AmpUtils.deleteSessionStorageData("userPhoto");AmpUtils.deleteSessionStorageData("displayMode");AmpUtils.deleteSessionStorageData("ampSiteType");AmpUtils.deleteLocalStorageData("ampUserId");f();$("#analysisUserId").val("guest");$("#analysisUserName").val("other")}if(AmpGlobal.platformType=="0"){$("#ampInternationTool").remove();$("#ampHeaderToolSkin").remove()}if(t=="en_US"){$("#ampPageHeaderPersonalIcon").attr("data-title","Personal center")}if(t=="en_US"){$("#ampPageHeaderHomeIcon").attr("data-title","Service hall")}}AmpHeader.initServiceCenterSousuo();u()})}function l(){if(AmpGlobal&&AmpGlobal.loginFlag&&AMPConfigure.boyaEntranceUrl){$("#ampHeaderCampusAI").removeClass("amp-hide");var e=window.innerWidth-400;var a=window.innerHeight-100;$("#ampHeaderCampusAI").on("click",function(){window.open(AMPConfigure.boyaEntranceUrl,"target","")})}else{$("#ampHeaderCampusAI").addClass("amp-hide")}}function m(){AmpDataUtils.userDesktopInfo("",function(e){var a=v(e);if(!a){var t=e.siteType;$("#analysisUserId").val($.trim(e.userId));$("#analysisUserName").val($.trim(e.userName));AmpUtils.setSessionStorageData("ampUserId",$.trim(e.userId));AmpUtils.setSessionStorageData("ampUserName",$.trim(e.userName));AmpUtils.setSessionStorageData("userType",$.trim(e.userType));AmpUtils.setSessionStorageData("userPhoto",$.trim(e.userPhoto));AmpUtils.setSessionStorageData("roles",JSON.stringify(e.roles));AmpUtils.setSessionStorageData("displayMode",$.trim(e.displayMode));AmpUtils.setSessionStorageData("ampUserIp",$.trim(e.userIp));AmpUtils.setSessionStorageData("ampUserID",$.trim(e.userID));AmpUtils.setSessionStorageData("ampUserTypeName",$.trim(e.userTypeName));AmpUtils.setSessionStorageData("ampUserDepartment",$.trim(e.userDepartment));AmpUtils.setSessionStorageData("ampUserSex",$.trim(e.userSex));AmpUtils.setSessionStorageData("ampSiteType",$.trim(e.siteType));localStorage.ampUserId=$.trim(e.userId);if(!(AMPConfigure.switchPortalSiteModel&&t=="1")){f()}l();if(AmpGlobal.loginFlag){AmpTaskCenter.getTaskDatas();var i=e.userName;$("#ampHasNoLogin").addClass("amp-hide");$("#ampHasLogin").removeClass("amp-hide").find("span.amp-username").text(i);$("#ampHasLoginTool").removeClass("amp-hide");$("#ampHeaderToolUserName").html(e.userName);if(e.userPhoto){$("#ampHeaderToolUser").attr("src",e.userPhoto);$("#ampHeaderToolUser").attr("has-photo","1")}var n=AmpTemplate.getHeaderUserInfoHtml();$("body").append(n);AmpDataUtils.getTopExtendList(function(e){if(null!=e.data&&e.data.length>0){$("#ampExtend").removeClass("amp-hide");s(e);if(typeof AMPConfigure.openExpansionSwitch!="undefined"){var a=$("#ampExtend");var t=a.find(".extendItemFlag").length;if(AMPConfigure.openExpansionSwitch&&t>0){a.find(".extendItemFlag:first-child").click()}}}else{$("#ampExtend").css("width",0)}});var o=$("#ampPersonalArticle");var p=$("#ampPersonalAsideLeftTabHead");if(AmpGlobal.platformType=="0"){o.find("#ampPersonalAsideLeftMini").find('[amp-id="canUseCards"]').remove();o.find("#ampPersonalAsideLeftNormal").find('[amp-id="canUseCards"]').remove();p.find(".amp-tab-item").css({width:AmpGlobal.personalCenter.leftAsideWidthPure/2+"px"})}else{p.find(".amp-tab-item").css({width:AmpGlobal.personalCenter.leftAsideWidthPure/3+"px"})}AmpDataUtils.getUserSkin(function(e){var a=e.themeColor;var t=e.skinName;var i=e.themeEyeShieldSwitch;if(t=="default"||t==""||t==null||t==undefined){t=AMPConfigure.portalSkin;var n={};n.themeColor=a;n.skinName=t;AmpDataUtils.switchSkin(n,function(e){if(e.result=="success"){console.log("默认皮肤插入成功")}})}else{t=r(t)}localStorage.themeColor=a;localStorage.skinName=t;var n={};n.skinName=t;n.themeColor=a;n.themeEyeShieldSwitch=i;var s=AmpTemplate.getHeaderUserSkinHtml(n,e);$("body").append(s);if(!i){$("#ampHeaderUserSkin").css("height","236px")}var p=$("#skinSwitch");var l=$("#skinSwitchText");var m="开启";var c="关闭";if(AmpGlobal.currentLang=="en_US"){c=$.i18n("closeSkinCool");m=$.i18n("openSkin")}if(a=="dark"){o.removeClass("amp-personCenter-bg");p.prop("checked",true);l.text(m)}else{p.prop("checked",false);o.addClass("amp-personCenter-bg");l.text(c)}AmpHeader.loadingCurrentSkin(n);var d="";var v="";var f=e.skinConfigList;var u=e.skinName;for(var g=0;g<f.length;g++){if(f[g].skinId==u){d=f[g].bgUrl;v=f[g].loginBgUrl;break}}AmpGlobal.currentBgUrl=d;AmpGlobal.currentLoginBgUrl=v;if($("#ampPageBgImg").hasClass("amp-page-img")){$("#ampPageBgImg").css("background-image","url("+d+")")}else{$("#ampPageBgImg").css("background-image","url("+v+")")}});$("#ampPageHeaderPersonalIcon").click();var m="帮助";var c="问题反馈";var u="重放引导动画";var g="查看更多帮助(FAQ)";if(AmpGlobal.currentLang=="en_US"){m=$.i18n("help");c=$.i18n("problemFeedback");u=$.i18n("replayBootAnimation");g=$.i18n("See More Help")}var h="";if($("#tpl-header-help-info").length>0){h=$("#tpl-header-help-info").html().replace("@help",m).replace("@problemFeedback",c).replace("@replayBootAnimation",u).replace("@faq",g)}$("body").append(h);if(AmpGlobal.platformType=="0"){$("#ampHelpBootpage").remove()}$("#ampServiceSearch").removeClass("amp-service-search-input-nologin")}d(e)}})}function c(){$("#ampNoLoginTool").removeClass("amp-hide");$("#ampPageHeaderHomeIcon").click();d()}function d(e){if(e==undefined){e={}}var a=parseInt(e.userType,10);var t=AmpUtils.getUserRoleId(a);var r=" 个多类型服务";if(AmpGlobal.currentLang=="en_US"){r=" applications"}AmpDataUtils.getSearchApps({key:"",labels:[]},function(e){if(e.searchResult!=undefined){$("#ampHeaderSearchResult").html(e.searchResult.length+r)}if(e.lastOnlineAppResult!=undefined){if(e.lastOnlineAppResult.length==0){$("#ampHeaderNewAppLabel").html("")}else{$("#ampHeaderNewAppLabel").html("+"+e.lastOnlineAppResult.length).addClass("amp-active")}}else{$("#ampHeaderNewAppLabel").html("")}})}function v(e){var a=e.siteType;var t=e.hasDefaultDesktopAuth;var r=false;if(AMPConfigure.switchPortalSiteModel&&e.hasTeacherDesktopAuth&&(AmpUtils.detectmob()&&AMPConfigure.useMobileSimpleModule||!AmpUtils.detectmob()&&a=="1")){AmpUtils.setTeacherSide();r=true}else if(a=="2"){AmpUtils.setXdSide();r=true}else if(a=="3"){AmpUtils.setAmp3Side();r=true}return r}function f(){if(AMPConstant.operationAnalysisRequestPath){if(typeof Wisedu!="undefined"){Wisedu.userActionDataSend();var e=sessionStorage["ampUserIp"];var a=sessionStorage["userType"];Wisedu.userActionDataSendNew(e,a)}}else{if(typeof Wisedu!="undefined"){Wisedu.userActionDataSend()}}}function u(){if(!AmpGlobal.loginFlag&&AmpUtils.detectmob()){$("#ampHasNoLogin").click()}}function g(e,a){var t=a.test(e);var r=e.replace(a,"");return{flag:t,val:r}}$(document).on("input keyup keydown keypress focus","input[checkNotEnterChinese],textarea[checkNotEnterChinese]",function(e){if($(this).prop("comStart"))return;var a=$(this).val();$(e.target).css("ime-mode","disabled");var t=/[\u0391-\uFFE5]/gi;var r=g(a,t);if(r.flag){$(this).val(r.val);return false}}).on("compositionstart","input:not([noCheckForbidden]), textarea:not([noCheckForbidden])",function(){$(this).prop("comStart",true)}).on("compositionend","input:not([noCheckForbidden]), textarea:not([noCheckForbidden])",function(){$(this).prop("comStart",false)});$(document).on("input blur keypress keydown keyup focus","input:not([noCheckForbidden]), textarea:not([noCheckForbidden])",function(){if($(this).parents("div.hasUEditer")&&$(this).parents("div.hasUEditer").length>0){return true}if($(this).prop("comStart"))return;var e=$(this).val();var a=/[`'"\~!@#＃_\$%\^&\*\{\}<>\?\|\\/\+=¥‘“？]+/g;var t=g(e,a);if(t.flag){$(this).val(t.val);return false}}).on("compositionstart","input:not([noCheckForbidden]), textarea:not([noCheckForbidden])",function(){$(this).prop("comStart",true)}).on("compositionend","input:not([noCheckForbidden]), textarea:not([noCheckForbidden])",function(){$(this).prop("comStart",false)})});(function(e,a){e.show=function(e){var a={};if(!e||e.type!=="breath"){a.html=r()}else{a.html=t()}if(e&&e.container){a.customClass="amp-loading-in"}if(e&&e.customClass){if(a.customClass){a.customClass+=" "+e.customClass}}var i=AmpTemplate.getLoadingFrameHtml(a);if(!e||!e.container){$("body").append(i)}else{e.container.append(i)}};e.close=function(e){var a=null;if(!e||!e.container){a=$("body")}else{a=e.container}var t=a.children('div[amp-role="loading"]');if(t.length>0){t.remove()}else{a.find('div[amp-role="loading"]').remove()}};function t(){return'<div class="amp-new-loading-breath"><div class="dot dot1"></div><div class="dot dot2"></div><div class="dot dot3"></div></div>'}function r(){return'<div class="amp-loading-reverse"></div>'}})(window.AmpLoading=window.AmpLoading||{});(function(e,a){e.init=function(){if(AmpGlobal.showLoginPageFlag){t();e.setLoginConteinerMargin();e.eventsListen();e.hasLogin();r();if(AmpGlobal.currentLang=="en_US"){$("#ampHasNoLogin").find(".amp-no-login-en").addClass("amp-hide")}}};e.setLoginConteinerMargin=function(){var e=window.innerHeight;var a=$("#ampLoginRoleNav").outerHeight(true);var t=e-a-24;var r=parseInt(t/2,10);var i=r-a/2;var n=$("#ampLoginRoleNav");var s=$("#ampLoginRoleNav").height();var o=(e-128-s)/2;if(!AmpUtils.IsPC()){o=o/2}n.css({"padding-top":o,"padding-bottom":o})};e.eventsListen=function(){$("#ampLoginArticle").on("click",".amp-has-nologin-btn",function(){AmpUtils.goLoginPage()});$("#ampLoginInBottomDesc").on("click",".icon",function(){var e=1;var a=$("#ampSlidePage").children(".amp-active");var t=a.index();var r=e>t?"down":"up";var i=$("body").find('article[role="slide"][slide-index="'+(t+1)+'"]')[0];slide.slideAnimate(r,i)})};e.hasLogin=function(){var e=$("#ampHasNoLogin");var a=$("#ampHasLogin");if(AmpGlobal.loginFlag){var t=AmpUtils.getSessionStorageData("ampUserName");e.addClass("amp-hide");a.removeClass("amp-hide");a.find("span.amp-username").text(t)}else{e.removeClass("amp-hide");a.addClass("amp-hide")}};function t(){var e=AMPConfigure.ehallTitle;var a=e.title;var t=e.smallTitle;var r=$("#ampLoginHeader");if(AmpGlobal.currentLang=="en_US"){r.find("h3").html(t);r.find("h3").css("font-size","22px")}else{r.find("h3").html(a);r.find("span").html(t)}}function r(){var e=AMPConfigure.ehallTitle;var a=e.title;var t=e.smallTitle;var r;if(AmpGlobal.currentLang=="en_US"){r=$("#tpl-header-en").html().replace("@enTitle",t)}else{r=$("#tpl-header").html().replace("@title",a).replace("@enTitle",t)}var i=$("#ampEhallBody");i.append(r);setTimeout(function(){var e=$("#ampLoginHeader").offset();$("#ampTplHeader").css({top:e.top,left:e.left});$("#ampEhallHeaderContent").css({left:e.left})},AmpGlobal.animateTimes+10)}})(window.AmpLoginIn=window.AmpLoginIn||{});(function(e,a){e.space={inputLockFlag:false};e.open=function(e){t(e)};function t(e){AmpDataUtils.getUserFavFolders(function(a){r(a,e)})}function r(e,a){var t=e.userFavFolders;var r=t.length;var n="";var s="amp-active";var o="收藏夹";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("favorite")}n+=$("#tpl-favorite-folder-item").html().replace("@folderId","0").replace("@folderName",o).replace("@activeClass",s);for(var p=0;p<r;p++){var l=t[p];var m=l.folderName;var c=l.wid;s="";n+=$("#tpl-favorite-folder-item").html().replace("@folderId",c).replace("@folderName",m).replace("@activeClass",s)}var d="新建";var v="新建文件夹";var f="5";if(AmpGlobal.currentLang=="en_US"){d=$.i18n("create");v=$.i18n("newFolder");f=$.i18n("folderLength")}n+=$("#tpl-favorite-folder-create").html().replace("@create",d).replace("@newFolder",v).replace("@folderLength",f).replace("@folderLength",f);var u="选择文件夹";var g=a.appTitle;if(g.length>10){g=g.substr(0,10)+"..."}var h="您收藏的<span class='appTitleColor' title='"+a.appTitle+"'>"+g+"</span>应用将会被放入指定文件夹中";var A="收藏";if(AmpGlobal.currentLang=="en_US"){u=$.i18n("chooseFolder");h=$.i18n("putInSpecificFolder");A=$.i18n("collect")}var C=$("#tpl-app-favorite").html().replace("@folderContrent",n).replace("@appId",a.appId).replace("@appType",a.appType).replace("@appName",a.appTitle).replace("@chooseFolder",u).replace("@putInSpecificFolder",h).replace("@collect",A).replace("@moduleName",a.moduleName);$("body").append(C);i();AmpUtils.niceScrollInit($("#ampFavoriteFolders"));AmpUtils.setIe9PlaceHolder()}function i(){var a=$("#ampFavorite");a.on("click",".amp-favorite-detail-folder-item",function(){l($(this))});a.on("click",".icon-chacha",function(){$("#ampFavorite").remove()});a.on("click",".amp-favorite-detail-btn",function(){var e=$(this).closest(".amp-favorite-detail-container").find(".favoriteDetailFolderInputFlag").hasClass("amp-active");if(!e){s()}});a.on("blur",".amp-favorite-detail-input",function(e){o()});a.on("compositionstart",".amp-favorite-detail-input",function(){e.space.inputLockFlag=true});a.on("compositionend",".amp-favorite-detail-input",function(){e.space.inputLockFlag=false});a.on("input",".amp-favorite-detail-input",function(a){if(!e.space.inputLockFlag){var t=$(a.currentTarget).closest(".amp-favorite-detail-input-container");n(t)}})}function n(e){var a=e.find(".amp-favorite-detail-input").val();var t=parseInt(a.length,10);e.find('span[amp-input-role="actual"]').text(t)}function s(){var a=$("#ampFavorite");var t=$("#ampFavoriteFolders");var r=$("#ampFavoriteFolders").find(".amp-favorite-detail-folder-item.amp-active");var i=r.attr("amp-folder-id");var n=a.attr("amp-favoriteapp-id");var s=a.attr("amp-favoriteapp-type");var o=a.attr("amp-favoriteapp-name");var p=r.find("span").text();var l=a.attr("amp-module-name");AmpDataUtils.favoriteApp({appId:n,type:s,favoriteFolderId:i},function(){var a="  收藏成功";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("collectedSuccessfully")}AmpPrompt.show({content:o+a});$("#ampFavorite").remove();e.favoriteCardApp(i,p,n);AmpFavorite.favoriteSynchronous(n,"active",s);AmpPersonalCenter.getMyFavoriteApps();AmpUtils.zhuge("收藏应用",{"应用ID":n,"应用名称":o,"收藏文件夹":p,"来源":l})})}function o(){var e=$("#ampFavoriteDetailFolderInput");var a=e.val();a=$.trim(a);var t={};if(a){AmpDataUtils.saveUserFavFolder(a,function(e){if(e.result=="success"){var r="新建文件夹成功";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("creatFolderSuccess")}AmpPrompt.show({content:r});t.folderName=a;t.folderId=e.folderId;p(t);AmpPersonalCenter.getMyFavoriteApps();AmpOpenFavorite.favoriteCardSyncAddNewFolder(t);AmpUtils.zhuge("新建收藏文件夹",{"文件夹名称":a})}else{var i="创建文件夹失败！";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("failedCreateFolder")}AmpPrompt.show({content:i})}})}else{var r="请输入文件夹名称";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("enterFolderName")}AmpPrompt.show({content:r});e.focus();return}}function p(e){var a=$("#ampFavoriteFolders");var t=e.folderId;var r=e.folderName;var i=$("#tpl-favorite-folder-item").html().replace("@activeClass","amp-active").replace("@folderId",t).replace("@folderName",r);a.find(".favoriteDetailFolderInputFlag").removeClass("amp-active").before(i)}function l(e){var e=e;if(e.hasClass("favoriteDetailFolderInputFlag")){var a=$("#ampFavoriteFolders").find(".amp-favorite-detail-folder-item").length;if(a>11){AmpPrompt.show({content:$.i18n("folderOutOfLimit")});return}else{$("#ampFavoriteDetailFolderInput").val("");$("#ampFavoriteDetailFolderInput").focus()}}e.siblings(".amp-favorite-detail-folder-item").removeClass("amp-active");e.addClass("amp-active")}e.unFavoriteCardApp=function(e){var a=$("#cardMyFavoriteContent");var t=$("#cardMyFavoriteContent").find('.appFlag[amp-appid="'+e.appId+'"]');if(t.length>0){t.each(function(e){var a=$(this).closest(".card-myFavorite-content-item");var t=a.attr("amp-classify");$(this).parent().remove();var r=$("#card-myfavorite-01");var i=r.find('li[amp-id="'+t+'"]');var n=i.find(".amp-app-count").text();i.find(".amp-app-count").text(parseInt(n)-1);var s="添加应用";if(AmpGlobal.currentLang=="en_US"){s=$.i18n("addApps")}if(parseInt(n)-1==0){var o=$("#tpl-card-myfavrite-addapp").html().replace(/@addApp/g,s);a.append(o)}})}};e.favoriteCardApp=function(e,a,t){var r=AmpDataUtils.space.allServiceData.searchResult;var i=$("#cardMyFavoriteContent");var n=i.find('.card-myFavorite-content-item[amp-classify="'+e+'"]');if(!(n.length>0)){var s={};s.folderName=a;s.folderId=e;AmpOpenFavorite.favoriteCardSyncAddNewFolder(s)}for(var o=0;o<r.length;o++){var p=r[o];var l=p.appId;if(l==t){var m=AmpUtils.assemblyAppAttributesToStr(p);var c=p.middleIcon;var d=p.appName;var v=$("#tpl-card-favorite-addApp").html().replace("@attributeBig",m).replace("@appItemmiddleIcon",c).replace("@titleappItemappName",d).replace("@appItemappName",d);if(e=="0"){i.find('.card-myFavorite-content-item[amp-classify="'+e+'"]').append(v)}else{i.find('.card-myFavorite-content-item[amp-classify="'+e+'"]').append(v);i.find('.card-myFavorite-content-item[amp-classify="0"]').append(v)}var f=$("#card-myfavorite-01");if(e!="0"){var u=f.find('li[amp-id="'+e+'"]');var g=u.find(".amp-app-count").text();u.find(".amp-app-count").text(parseInt(g)+1)}var h=f.find('li[amp-id="0"]');var A=h.find(".amp-app-count").text();h.find(".amp-app-count").text(parseInt(A)+1);if(parseInt(g)+1>0){i.find('.card-myFavorite-content-item[amp-classify="'+e+'"]').find(".widget-recommend-item-nodata").remove()}if(parseInt(A)+1>0){i.find('.card-myFavorite-content-item[amp-classify="0"]').find(".widget-recommend-item-nodata").remove()}break}}};e.favoriteCardSyncAddNewFolder=function(e){var a=e.folderId;var t=e.folderName;var r=$("#card-myfavorite-01");var i=$("#cardMyFavoriteContent");var n="";var s=$("#tpl-card-favorite-addNewFolder").html().replace("@folderId",a).replace("@folderName",t);n=$("#tpl-card-favorite-addNewFolderContent").html().replace("@folderId",a).replace("@activeClass","amp-hide");if(r.length>0){r.find("ul").append(s);i.append(n);m()}};e.favoriteCardSyncDelFolder=function(e){var a=$("#card-myfavorite-01");var t=a.find("ul");var r=$("#cardMyFavoriteContent");var i=false;$.each(e,function(e){var a=$(this);var n=a.attr("amp-id");var s=t.find('li[amp-id="'+n+'"]');if(s.attr("amp-type")=="amp-active"){i=true}s.remove();r.find('div.card-myFavorite-content-item[amp-classify="'+n+'"]').remove()});if(i){t.find('li[amp-id="0"]').click()}};function m(){$("body").on("click",".card-myfavorite-li-readd",function(e){var a=$(e.target);var t=a.closest(".amp-hover-slow-motion").attr("amp-id");a.closest(".amp-hover-slow-motion").siblings("li").attr("amp-type","amp-hide");a.closest(".amp-hover-slow-motion").attr("amp-type","amp-active");$("#cardMyFavoriteContent").find(".card-myFavorite-content-item").attr("amp-isShow","amp-hide");$("#cardMyFavoriteContent").find('.card-myFavorite-content-item[amp-classify="'+t+'"]').attr("amp-isShow","amp-active")})}})(window.AmpOpenFavorite=window.AmpOpenFavorite||{});(function(e,a){var t={hideWaitTime:3e3,height:38,margin:4};e.show=function(e){e=o(e);var a=AmpTemplate.getPromptHtml(e);var t=$(a);p();$("body").append(t);i(t);n(t);r(t)};function r(e){e.on("click",".amp-prompt-close",function(){s(e)})}function i(e){var a=e.outerWidth();e.css({top:"48px",left:"calc(50% - "+parseInt(a/2)+"px)",opacity:1})}function n(e){setTimeout(function(){if(e){s(e)}},t.hideWaitTime)}function s(e){e.css({opacity:0});setTimeout(function(){e.remove()},AmpGlobal.animateTimes)}function o(e){var a="";var t="";switch(e.state){case"warning":t="amp-warning";break;case"danger":t="amp-danger";break;default:t="amp-success";break}e.stateIconClass=a;e.promptStateClass=t;return e}function p(){var e=$("body").find('div[amp-role="prompt"]');e.each(function(){var e=$(this);var a=parseInt(e.css("top"),10);var r=a+t.margin+t.height;e.css("top",r+"px")})}})(window.AmpPrompt=window.AmpPrompt||{});var leaveSearchTimeout=null;var leaveSearchFlag=true;(function(serviceCenter,undefined){serviceCenter.space={loadCompleteFlag:true};eventsListen();serviceCenter.init=function(e){var a=$("#ampServiceArticle");if(a.getNiceScroll().length===0){AmpUtils.niceScrollInit($("#ampServiceRightContent"))}if(a.hasClass("ampLoadedFlag")){clearContainer();getSearchApps("",e)}else{var t=parseInt(AmpDataUtils.space.ampData.userType,10);var r=AmpUtils.getUserRoleId(t);clearContainer("init");if(AmpGlobal.loginFlag){AmpDataUtils.getUserFirstLogin(function(e){if(!e.isFirstLogin){getRecentUseApps()}else{getCommendServiceApps()}})}else{getCommendServiceApps()}getNewApps(r);getSearchApps("init",e);a.addClass("ampLoadedFlag")}serviceCenter.showPage("show");AmpUtils.setIe9PlaceHolder();serviceCenter.searchBoxBlur()};serviceCenter.searchBoxBlur=function(){var e=$("#ampServiceSearch").find(".ampserviceSearchInputFlag");var a=$.trim(e.val());if(!a){var t="搜索服务";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("searchService")}e.attr("placeholder",t);AmpUtils.setIe9PlaceHolder()}};function initContainers(e){if(e&&e.labels){labels=e.labels;var a=$("#ampServiceLabelNav");a.find('li[amp-label-flag="all"]').removeClass("amp-active");for(var t=0;t<labels.length;t++){a.find("li[amp-label-id="+labels[t]+"]").addClass("amp-active")}}}function clearContainer(e){if(e==="init"){$("#ampServiceArticle").children("aside").html("");$("#ampServiceLabelNav").html("");$("#ampServiceCenterNewApps").html("")}$("#ampServiceCenterSearchApps").html("")}function getHotApps(e){}function getRecentUseApps(){AmpDataUtils.getrecUseServiceList(function(e){showRecentUseApps(e)})}function getCommendServiceApps(){var e=parseInt(AmpDataUtils.space.ampData.userType,10);var a="all";AmpDataUtils.getEhallData(a,function(e){showCommendServiceApps(e)})}function showHotApps(e){var a="";var t=e.length;for(var r=0;r<t;r++){var i=e[r];a+=AmpTemplate.getSingleAppHtml(i,"single")}var n="热门服务";if(AmpGlobal.currentLang=="en_US"){n=$.i18n("popularService")}var s=AmpTemplate.getAsideAppsHtml({title:"cnStr",apps:a});$("#ampServiceArticle").children("aside").append(s)}function showRecentUseApps(e){var a="";var t=e.recUseServiceList;var r=t.length;if(r==0){getCommendServiceApps();return}for(var i=0;i<r&&i<10;i++){var n=t[i];a+=AmpTemplate.getSingleAppHtml(n,"single")}var s="最近使用";if(AmpGlobal.currentLang=="en_US"){s=$.i18n("recentlyUsedServices")}var o=AmpTemplate.getAsideAppsHtml({title:s,apps:a});$("#ampServiceArticle").children("aside").append(o)}function showCommendServiceApps(e){if(e.hotRecNewAppList==undefined){return}var a="";var t=e.hotRecNewAppList;var r=t.length;for(var i=0;i<r&&i<10;i++){var n=t[i];a+=AmpTemplate.getSingleAppHtml(n,"single")}var s="推荐服务";if(AmpGlobal.currentLang=="en_US"){s=$.i18n("recommendedService")}var o=AmpTemplate.getAsideAppsHtml({title:s,apps:a});$("#ampServiceArticle").children("aside").append(o)}function getNewApps(e){AmpDataUtils.getSearchApps(e,function(e){showNewApps(e)})}function showNewApps(e){var a=null;var t="";var r=0;if(e.lastOnlineAppResult==undefined){return}else{a=e.lastOnlineAppResult;r=a.length}for(var i=0;i<r;i++){var n="";var s="";var o="";var p=a[i];n=AmpTemplate.getAppCardSingleHtml(p);s+=AmpTemplate.getServiceAppCardHtml({data:p});o+=AmpTemplate.getHoverAppHtml({data:p});t+='<div class="amp-hover-app-card-group amp-pull-left amp-service-center-app-group">'+n+o+"</div>"}var l="最新上架的服务";if(AmpGlobal.currentLang=="en_US"){l=$.i18n("newlyPublishedServices")}var m={title:l,apps:t,count:r};var c=AmpTemplate.getBarAppsBlockHtml(m);$("#ampServiceCenterNewApps").html(c);if(r==0){$("#ampHeaderNewAppLabel").html("")}else{$("#ampHeaderNewAppLabel").html("+"+r).addClass("amp-active")}}function getSearchApps(e,a){serviceCenter.space.loadCompleteFlag=false;var t=$.trim($("#ampServiceSearchInput").val());var r="";var i=[];var n=[];var s=[];var o=[];if(a&&a.labels){i=a.labels}else{var p="";var l="";$("#ampServiceLabelNav").find(".amp-active").each(function(){var e=$(this);if(e.attr("amp-label-flag")!=="all"){if(e.attr("amp-label-type")=="1"){i.push(e.attr("amp-label-id"))}else if(e.attr("amp-label-type")=="2"){p=e.attr("amp-label-id")}else if(e.attr("amp-label-type")=="6"){l=e.attr("amp-label-id")}else{p+="___"+e.attr("amp-label-id")}}var a=$(this).closest(".amp-label-line").children("label").attr("amp-service-id");if(a==="1"){n.push(e.text())}else if(a==="2"){s.push(e.text())}else{o.push(e.text())}});if(p!=""){i.push(p)}if(l!=""){i.push(l)}}if(t===""&&i.length===0){r="all"}setTimeout(function(){if(!serviceCenter.space.loadCompleteFlag){AmpLoading.show({type:"reverse",container:$("#ampServiceSection")})}},500);AmpDataUtils.getSearchApps({key:t,labels:i},function(i){serviceCenter.space.loadCompleteFlag=true;AmpLoading.close();showSearchApps(i.searchResult,e,r,t);showSearchLabels(i.serviceLabels);initContainers(a)});if(t||n.length>0||s.length>0&&o.length>0){AmpUtils.zhuge("搜索应用",{"服务角色":n.join(","),"一级服务分类":s.join(","),"二级服务分类":o.join(","),"搜索关键字":t})}}function showSearchApps(data,flag,type,searchKey){var folderAppsSearchData="";var letterSplit=["A-D","E-H","I-L","M-P","Q-T","U-X","Y-Z","Other"];if(type!=="all"){letterSplit=["Other"]}else{folderAppsSearchData=AmpDataUtils.space.allServiceData.folderAppsMap}var letterSplitLen=letterSplit.length;var letterAppsData={};var letterDicsData={};for(var i=0;i<letterSplitLen;i++){var letterAppItem=letterAppsData[letterSplit[i]]={};letterAppItem.html="";letterAppItem.count=0;var letterDicItem=letterDicsData[letterSplit[i]]={};letterDicItem.html="";letterDicItem.count=0}var blockData={};var html="";if(data){var dataLen=data.length;if(dataLen){for(var k=0;k<dataLen;k++){var appCardSingleHtml="";var appCardHtml="";var hoverCardHtml="";var appItem=data[k];var letter=appItem.pinyingFirstChar;var appType=appItem.type;if(searchKey&&searchKey.trim()!=""){appItem.appNameNew=appItem.appName.replace(eval("/("+searchKey+")/ig"),"<span class='amp-service-search-color'>"+searchKey+"</span>")}else{appItem.appNameNew=appItem.appName}appCardSingleHtml=AmpTemplate.getAppCardSingleHtml(appItem);appCardHtml=AmpTemplate.getServiceAppCardHtml({data:appItem});hoverCardHtml+=AmpTemplate.getHoverAppHtml({data:appItem});if(appItem.type==1){var appGroupHtml=AmpTemplate.getAppCardGroupHtml(appCardSingleHtml+appCardHtml)}else{var appGroupHtml=$("#tpl-hover-service-center-app-card-group").html().replace("@content",appCardSingleHtml+hoverCardHtml)}var letterKey="";if(type!=="all"){letterKey="Other"}else{if(folderAppsSearchData&&folderAppsSearchData[appItem.appId]==appItem.appId){continue}if(/[A-D]/.test(letter)){letterKey="A-D"}else if(/[E-H]/.test(letter)){letterKey="E-H"}else if(/[I-L]/.test(letter)){letterKey="I-L"}else if(/[M-P]/.test(letter)){letterKey="M-P"}else if(/[Q-T]/.test(letter)){letterKey="Q-T"}else if(/[U-X]/.test(letter)){letterKey="U-X"}else if(/[Y-Z]/.test(letter)){letterKey="Y-Z"}else{letterKey="Other"}if(appType===1){var folderId=appItem.appId;AmpDataUtils.space.folderData[folderId]=appItem}}if(appItem.type==1){letterDicsData[letterKey].html+=appGroupHtml;letterDicsData[letterKey].count++}if(appItem.type==0){letterAppsData[letterKey].html+=appGroupHtml;letterAppsData[letterKey].count++}}for(var x=0;x<letterSplitLen;x++){letterAppsData[letterSplit[x]].html=letterDicsData[letterSplit[x]].html+letterAppsData[letterSplit[x]].html;letterAppsData[letterSplit[x]].count=letterDicsData[letterSplit[x]].count+letterAppsData[letterSplit[x]].count}for(var z=0;z<letterSplitLen;z++){var letterSplitItem=letterSplit[z];var letterAppsDataItem=letterAppsData[letterSplitItem];if(letterSplitItem==="other"){if(letterAppsDataItem.count===0){continue}}var cnSearchResultStr="搜索结果";if(AmpGlobal.currentLang=="en_US"){cnSearchResultStr=$.i18n("searchResult")}var blockClearClass=false;if(type!=="all"){blockClearClass=true;letterSplitItem=cnSearchResultStr}blockData={title:letterSplitItem,apps:letterAppsDataItem.html,count:letterAppsDataItem.count,clearClass:blockClearClass};html+=AmpTemplate.getBarAppsBlockHtml(blockData)}if(flag==="init"){}}else{html=getNoSearchDataHtml()}}else{html=getNoSearchDataHtml()}var $newAppBlock=$("#ampServiceCenterNewApps");if(type!=="all"){$newAppBlock.addClass("amp-hide")}else{$newAppBlock.removeClass("amp-hide")}$("#ampServiceCenterSearchApps").append(html)}function getNoSearchDataHtml(){var e="没有找到相关的服务哦";var a="搜索结果";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("sorryWeCannotFind");a=$.i18n("searchResult")}var t={title:a,apps:$("#tpl-search-no-data").html().replace("@sorryWeCannotFind",e),count:0,clearClass:true};return AmpTemplate.getBarAppsBlockHtml(t)}function showSearchLabels(e){var a=$("#ampServiceLabelNav");if(a.text().length===0){var t=AmpTemplate.getLabelsHtml(e);a.html(t);a.on("click",".amp-label-line-item",function(){var a=$(this).attr("amp-label-type");if(a=="2"){var t=$("#ampServiceLabelNav");t.find(".serviceCenterSubLabelFlag").remove()}serviceLabelSearch($(this));if($(this).hasClass("hasSubLabelFlag")){showSubLabels(e,$(this))}});setSearchAppsContainerMinHeight()}}serviceCenter.showPage=function(e){var a=$("#ampServiceArticle");var t="blur";var r=true;if(e==="show"){if(a.hasClass("amp-active")){r=false}a.removeClass("amp-animate-move-top-out").addClass("amp-animate-move-top-in").addClass("amp-active").removeClass("amp-hide");var i=$("#ampServiceLabelNav");if(i.find("li.amp-active").length==0){i.find("li").removeClass("amp-active");i.find('li[amp-label-flag="all"]').addClass("amp-active");i.find(".serviceCenterSubLabelFlag").remove()}}else{t="restore";if(!a.hasClass("amp-active")){r=false}a.removeClass("amp-animate-move-top-in").addClass("amp-animate-move-top-out").removeClass("amp-active")}setTimeout(function(){if(r){var e=null;if($("#ampPersonalArticle").hasClass("amp-active")){e=$("#ampPersonalArticle")}else if($("#ampPageHeaderHomeIcon").hasClass("amp-active")){e=$("#ampEhallBody").find("article.amp-active")}if(e!=null){e.removeClass("amp-active").addClass("amp-hide");$("#ampSlidePage").addClass("amp-hide");$("#ampPageBgCover").removeClass("amp-hide").addClass("amp-active")}}AmpUtils.niceScrollResize($("#ampServiceArticle"))},450)};function serviceLabelSearch(e){var a=e.attr("amp-label-flag");var t=e.closest("ul");var r=e.attr("amp-label-type");if(a!=="all"){var i=t.find('[amp-label-flag="all"]');i.removeClass("amp-active");if(r=="1"){e.toggleClass("amp-active");if(t.find("li.amp-active").length===0){i.addClass("amp-active")}else{e.siblings("li").removeClass("amp-active")}}else{e.addClass("amp-active");e.siblings("li").removeClass("amp-active")}}else{t.find("li").removeClass("amp-active");e.addClass("amp-active")}serviceCenter.init()}function eventsListen(){$("#ampServiceCenterSearchApps").on("click",".ampClearFlag",function(){$("#ampServiceLabelNav").find("li").each(function(){var e=$(this);if(e.attr("amp-label-flag")!=="all"){e.removeClass("amp-active")}else{e.addClass("amp-active")}});var e=$("#ampServiceSearchInput");e.val("");serviceCenter.init();$(".serviceCenterSubLabelFlag").hide()});var e="";$("#ampServiceSearch").on("input",".ampserviceSearchInputFlag",function(){$("#ampHistoryBox").remove();if($(this).prop("comStart")){return}var a=$(this).val();e=a;var t=/[`'"\~!@#＃_\$%\^&\*\{\}<>\?\|\\/\+=¥‘“？]+/g;var r=checkForbiddenChar(e,t);if(r.flag){$(this).val(r.val);return false}showSearchName(e)}).on("compositionstart",".ampserviceSearchInputFlag",function(){$(this).prop("comStart",true)}).on("compositionend",".ampserviceSearchInputFlag",function(){$(this).prop("comStart",false);if($(this).prop("comStart")){return}var a=$(this).val();e=a;var t=/[`'"\~!@#＃_\$%\^&\*\{\}<>\?\|\\/\+=¥‘“？]+/g;var r=checkForbiddenChar(e,t);if(r.flag){$(this).val(r.val);return false}showSearchName(e)});$("body").on("click",".amp-service-searchName-item",function(){var e=$(this).attr("amp-appname");$("#ampServiceSearchInput").val(e);$("#ampSearchNameBox").remove();serviceCenter.init()});$("#ampServiceSearch").on("click","#ampServiceSousuo",function(){serviceCenter.init()});$("#ampServiceSearch").on("click",".amp-service-history-box",function(){showHistoryBox();AmpUtils.zhuge("查看搜索记录",{})});$("#ampServiceSearch").on("mouseover",function(){leaveSearchFlag=false;clearTimeout(leaveSearchTimeout)});$("#ampServiceSearch").on("mouseout",function(){leaveSearchFlag=true;leaveSearchTimeout=setTimeout(function(){if(leaveSearchFlag===true){$("#ampHistoryBox").remove()}},500)});$("body").on("mouseover","#ampHistoryBox",function(){leaveSearchFlag=false;clearTimeout(leaveSearchTimeout)});$("body").on("mouseout","#ampHistoryBox",function(){leaveSearchFlag=true;leaveSearchTimeout=setTimeout(function(){if(leaveSearchFlag===true){$("#ampHistoryBox").remove()}},500)})}function setSearchAppsContainerMinHeight(){setTimeout(function(){var e=$("#ampServiceSection");var a=e.offset().top;var t=window.innerHeight;var r=t-a;e.css("min-height",r+"px")},AmpGlobal.animateTimes+10)}function showSubLabels(e,a){var t=t;var a=a;var r=a.attr("amp-label-id");var i="全部";var n="二级分类";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("all");n=$.i18n("sub-category")}var s="";var o=$("#tpl-sub-label-line").html();var p=$("#tpl-sub-label-line-item").html();var l="";if(e){var m=e.length;if(m>0){for(var c=0;c<m;c++){var d=e[c];var v=d.labels;var f=v.length;for(var u=0;u<f;u++){var g=v[u];var h=g.labelId;var A=g.subLabelList;if(h==r){for(var C=0;C<A.length;C++){if(C===0){l+=p.replace("@labelName",i).replace("@labelId",h).replace("@active","amp-active").replace("@labelFlag","all")}l+=p.replace("@labelName",A[C].lableName).replace("@labelId",A[C].labelId).replace("@active","").replace("@labelFlag","")}}}}s+=o.replace("@serviceId",h).replace("@labelName",n).replace("@labelList",l)}}var k=$("#ampServiceLabelNav");k.append(s)}function showSearchName(searchName){var re=new RegExp(searchName,"i");var searchVal=searchVal;var allServiceSearchData="";if(AmpDataUtils.space.allServiceData!=null){allServiceSearchData=AmpDataUtils.space.allServiceData.searchResult}var allServiceSearchLen=allServiceSearchData.length;var searchAppList=[];$("#ampSearchNameBox").remove();if(searchName==""){return}for(var i=0;i<allServiceSearchLen;i++){var appName=allServiceSearchData[i].appName;if(re.test(appName)){searchAppList.push(allServiceSearchData[i])}}var searchBoxTpl="";var searchItems="";for(var j=0;j<searchAppList.length;j++){var appName=searchAppList[j].appName;var regappName=appName.replace(eval("/("+searchName+")/ig"),"<span class='amp-service-search-color'>"+searchName+"</span>");searchItems+=$("#tpl-service-searchName-item").html().replace("@appName",regappName).replace("@searchname",appName).replace("@searchname",appName).replace("@mormalImg","portal/images/serviceCenter/u2595.png")}if(searchItems==""){var noData="无相关结果";if(AmpGlobal.currentLang=="en_US"){noData=$.i18n("noData")}searchItems=$("#tpl-service-searchName-nodata").html().replace("@noData",noData)}searchBoxTpl=$("#tpl-service-searchName").html().replace("@searchItems",searchItems);$("body").append(searchBoxTpl);var offserLeft=$("#ampServiceSearchInput").offset().left;if(AmpGlobal.loginFlag){offserLeft=offserLeft-6+"px"}else{offserLeft=offserLeft+10+"px"}$("#ampSearchNameBox").css("left",offserLeft);AmpUtils.niceScrollInit($("#ampSearchNameBox"))}function showHistoryBox(){AmpDataUtils.userSearchHistory(function(e){var e=e.data;var a="";var t="";if(e.length>0){for(var r in e){var i=e[r].searchKey;t+=$("#tpl-service-searchName-item").html().replace("@searchname",i).replace("@searchname",i).replace("@appName",i).replace("@mormalImg","portal/images/serviceCenter/u2455.png")}}else{var n="暂无数据";if(AmpGlobal.currentLang=="en_US"){n=$.i18n("noData")}t=$("#tpl-service-searchName-nodata").html().replace("@noData",n)}a=$("#tpl-service-history-box").html().replace("@searchItems",t);$("#ampSearchNameBox").remove();$("#ampHistoryBox").remove();$("body").append(a)})}function checkForbiddenChar(e,a){var t=a.test(e);var r=e.replace(a,"");return{flag:t,val:r}}})(window.AmpServiceCenter=window.AmpServiceCenter||{});(function(e,a){e.userInfo=function(){var e=AMPConstant.jsonpRequestPath+"userInfo.json";return AmpUtils.doJsonpAjax(e)};e.ehallAppData=function(e){var a="all";var t=AMPConstant.jsonpRequestPath+AMPConstant.APIList.serviceRoleApp+"?serviceRoleId="+e+"&type="+a;return AmpUtils.doJsonpAjax(t)};e.searchAppData=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.serviceCenterData;if(e.labels){a+="?"+e.labels;delete e.labels}return AmpUtils.doJsonpAjax(a,e)};e.myFavoriteApps=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userFavoriteApps;return AmpUtils.doJsonpAjax(e)};e.favoriteApp=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.favoriteApp;return AmpUtils.doJsonpAjax(a,e)};e.unFavoriteApp=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.unFaviroteApp;return AmpUtils.doJsonpAjax(a,e)};e.appIntroduction=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.appIntroduction;return AmpUtils.doJsonpAjax(a,e)};e.updateDesHasUpdateStatus=function(e){var a=AMPConstant.jsonpRequestPath+"updateDesHasUpdateStatus.json";return AmpUtils.doJsonpAjax(a,e)};e.appUnViewableDescription=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.appCheckforView;return AmpUtils.doJsonpAjax(a,e)};e.appRestoreViewableDescription=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.appCheckforView;return AmpUtils.doJsonpAjax(a,e)};e.appRestoreViewableDescription=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.appCheckforView;return AmpUtils.doJsonpAjax(a,e)};e.desktopData=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserDesktop;return AmpUtils.doJsonpAjax(a,e)};e.noReadMessageData=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.manageAPIList.getTagsMessages;return AmpUtils.doJsonpAjax(a,e)};e.recentUseApps=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.recentUseApps;return AmpUtils.doJsonpAjax(e)};e.desktopCreat=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.createUserDesktop;return AmpUtils.doSendAjax(a,e)};e.deleteDesktop=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.deleteDesktop;return AmpUtils.doJsonpAjax(a,e)};e.restoreDesktop=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.restoreDesktop;return AmpUtils.doJsonpAjax(a,e)};e.editDesktop=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.editDesktop;return AmpUtils.doJsonpAjax(a,e)};e.editUserDesktopOrder=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.editUserDesktopOrder;return AmpUtils.doJsonpAjax(a,e)};e.getUserCategoryAppList=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userCategoryAppList;return AmpUtils.doJsonpAjax(e)};e.getUserDesktopProperty=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserDesktopProperty;return AmpUtils.doJsonpAjax(a)};e.updateUserDesktopSeq=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updateUserDesktopSeq+"?desktopSeqJson="+e;return AmpUtils.doJsonpAjax(a)};e.deleteUserDesktopCard=function(e){var a=e.desktopId;var t=e.desktopType;var r=e.cardWid;var i=AMPConstant.jsonpRequestPath+AMPConstant.APIList.deleteUserDesktopCard+"?desktopId="+a+"&desktopType="+t+"&cardWid="+r;return AmpUtils.doJsonpAjax(i)};e.getRecommendCard=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getRecommendCard;return AmpUtils.doJsonpAjax(e)};e.updateRecommendCardStatus=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updateRecommendCardStatus+"?appPcCardRecommendJson="+e;return AmpUtils.doJsonpAjax(a)};e.userDesktopInfo=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userDesktopInfo+"?type="+e;return AmpUtils.doJsonpAjax(a)};e.updatePcCardMarkStatus=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updatePcCardMarkStatus+"?userPcCardRecordJson="+e;return AmpUtils.doJsonpAjax(a)};e.getTagsMessages=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getTagsMessages;return AmpUtils.doJsonpAjax(a,e)};e.userCheckforView=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userCheckforView+"?viewFlag="+e;return AmpUtils.doJsonpAjax(a)};e.getTaskSideCard=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getTaskSideCard;return AmpUtils.doJsonpAjax(e)};e.getTaskSideCardOfUnreadMessage=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getTaskSideCardOfUnreadMessage;return AmpUtils.doJsonpAjax(e)};e.getrecUseServiceList=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.recUseServiceList;return AmpUtils.doJsonpAjax(e)};e.sendRecUseApp=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.sendRecUseApp+"?appId="+e;return AmpUtils.doJsonpAjax(a)};e.updateUserDesktopStatus=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updateUserDesktopStatus+"?desktopId="+e;return AmpUtils.doJsonpAjax(a)};e.getUserSkin=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserSkin;return AmpUtils.doJsonpAjax(e)};e.switchSkin=function(e){var t=e.skinName;var r=e.themeColor;if(e.siteType!=a){var i=AMPConstant.jsonpRequestPath+AMPConstant.APIList.switchSkin+"?siteType="+e.siteType}else{var i=AMPConstant.jsonpRequestPath+AMPConstant.APIList.switchSkin+"?skinName="+t+"&themeColor="+r}return AmpUtils.doJsonpAjax(i)};e.userSearchHistory=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.userSearchHistory;return AmpUtils.doJsonpAjax(e)};e.getTopExtendList=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getTopExtendList;return AmpUtils.doJsonpAjax(e)};e.getUserFirstLogin=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserFirstLogin;return AmpUtils.doJsonpAjax(e)};e.setMsgsRead=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.setMsgsRead+"?msgIdsString="+e;return AmpUtils.doJsonpAjax(a)};e.setAllTagMsgsRead=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.setAllTagMsgsRead+"?typeId=-1";return AmpUtils.doJsonpAjax(a)};e.getTaskCount=function(e){var a=AMPConstant.taskCenterRequestPath+"sys/taskCenter/portalDataReceive/"+AMPConstant.APIList.getTaskCount;return AmpUtils.getTaskAjax(a)};e.getTaskDbLcData=function(e){var a=AMPConstant.taskCenterRequestPath+"sys/taskCenter/portalDataReceive/"+AMPConstant.APIList.getPortalDataTask+"?flag="+e;return AmpUtils.getTaskAjax(a)};e.getTaskZqfwData=function(e){var a=e.pageNumber;var t=e.pageSize;var r=AMPConstant.jsonpRequestPath+AMPConstant.APIList.readyAndOpenService+"?pageNumber="+a+"&pageSize="+t;return AmpUtils.doJsonpAjax(r)};e.updateUserReadGuidePage=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.updateUserReadGuidePage+"?isReadGuidePage="+e;return AmpUtils.doJsonpAjax(a)};e.getCurrentLocale=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getCurrentLocale;return AmpUtils.doJsonpAjax(e)};e.checkLogin=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.checkLogin;return AmpUtils.doJsonpAjax(e)};e.setCurrentLocale=function(e){if(e=="en_US"){e="en"}else if(e=="zh_CN"){e="zh"}var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.setCurrentLocale+"?lang="+e;return AmpUtils.doJsonpAjax(a)};e.getUserFavFolders=function(){var e=AMPConstant.jsonpRequestPath+AMPConstant.APIList.getUserFavFolders;return AmpUtils.doJsonpAjax(e)};e.saveUserFavFolder=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.saveUserFavFolder+"?folderName="+e;return AmpUtils.doJsonpAjax(a)};e.saveFavFolderOperates=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.saveFavFolderOperates+"?userFavFolderOperInfo="+e;return AmpUtils.doJsonpAjax(a)};e.setCurrentEnv=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.setCurrentEnv+"?curEnvTerminal="+e;return AmpUtils.doJsonpAjax(a)};e.dataAnalysisException=function(e){var a=AMPConstant.jsonpRequestPath+AMPConstant.APIList.dataAnalysisException+"?desc="+e;return AmpUtils.doJsonpAjax(a)};e.updateReceiveDate=function(e){var a=e.APP_ID;var t=e.TASK_ID;var r=AMPConstant.taskCenterRequestPath+"sys/taskCenter/modules/todoTask/"+AMPConstant.APIList.updateReceiveDate+"?APP_ID ="+a+"&TASK_ID="+t;return AmpUtils.getTaskAjax(r)}})(window.AmpServices=window.AmpServices||{});(function(e,a){e.space={moveFlag:false,animateTime:AmpGlobal.animateTimes,os:I(),macData:{wheelStart:false,maxWheel:0,preDelta:0,state:"increase"}};e.init=function(){var e=w(document,'[role="slide"]');t(e);r(e);f()};e.slideAnimate=function(e,a){h(e,a)};function t(e){var a=e.length;var t=window.innerHeight;var r=window.innerWidth;for(var i=0;i<a;i++){var n=e[i];var s=parseInt(n.getAttribute("slide-index"),10);var o=n.getAttribute("slide-direction");var p="bh-slide-animate-v";var l=0;var m=0;var c=0;if(s!==1){if(o==="vertical"){l=t;p="bh-slide-animate-v"}else{m=r;p="bh-slide-animate-h"}c=0}else{if(o==="vertical"){p="bh-slide-animate-v"}else{p="bh-slide-animate-h"}c=1}n.style.top=l+"px";n.style.left=m+"px";n.style.height=t+"px";n.style.width=r+"px";n.style.opacity=c;if(navigator.userAgent.indexOf("MSIE 9.0")>0){n.className+" "+p}else{n.classList.add(p)}}if(AmpGlobal.platformType=="0"){$("#ampLoginInBottomDesc").hide()}}function r(e){if(AmpGlobal.platformType=="0"){return}var a=e.length;var t="";var r='<div class="@activeClass"></div>';for(var n=0;n<a;n++){var s=n!==0?"":"amp-active";t+=r.replace("@activeClass",s)}var o=16;var p=8;var l=a*o+(a-1)*p;var m="calc(50% - "+parseInt(l/2,10)+"px);";t='<div id="ampSlidePage" class="bh-slide-page amp-zIndex-lv1" style="top:'+m+'">'+t+"</div>";$("#ampEhallBody").append(t);i()}function i(){$("#ampSlidePage").on("click","div",function(){var e=$(this);if(e.hasClass("amp-active")){return}var a=e.index();var t=$("#ampSlidePage").children(".amp-active");var r=t.index();var i=a>r?"down":"up";var n=$("body").find('article[role="slide"][slide-index="'+(r+1)+'"]')[0];var s=$("body").find('article[role="slide"][slide-index="'+(a+1)+'"]')[0];h(i,n,s)})}var n,s,o,p,l,m;var c=document.getElementById("ampClassifyArticle");var d=document.getElementById("ampEhallArticle");var v=document.getElementById("ampLoginRoleNav");function f(){if(AmpGlobal.platformType=="0"){return}if(document.addEventListener){document.addEventListener("DOMMouseScroll",g,false);if(window.windowScrollHandle){c.addEventListener("touchmove",g,false);d.addEventListener("touchmove",g,false);v.addEventListener("touchmove",g,false);window.addEventListener("touchload",f,false)}if(window.getTouchstartXY){c.addEventListener("touchstart",u,false);d.addEventListener("touchstart",u,false);v.addEventListener("touchstart",u,false)}}window.onmousewheel=document.onmousewheel=g}function u(e){n=e.touches[0].pageX;s=e.touches[0].pageY}function g(t){var r="";var i="";var c=t||window.event;if(c.wheelDelta==a&&(c.detail==a||!c.detail)){c.preventDefault();o=c.changedTouches[0].pageX;p=c.changedTouches[0].pageY;l=o-n;m=p-s;if(m>0||m==0){r="down";i="down"}else if(m<0){r="up";i="up"}}else{if(c.wheelDelta){i=c.wheelDelta}else if(c.detail){i=c.detail}if(i){if(i>0){r="up"}else{r="down"}}}if(i){var d=c.target;var v=null;if(d.getAttribute("role")==="slide"){v=d}else{v=k(d,'[role="slide"]')}if(v){if(e.space.os==="mac"){if(i>=-3&&i<=3){return}}h(r,v)}}}function h(t,r,i){if(e.space.moveFlag){return}var n=0;var s=parseInt(r.getAttribute("slide-index"),10);if(i!=a){n=parseInt(i.getAttribute("slide-index"),10)}var o=r.parentNode;var p=A(o);var l=p.length;var m="";var c="";var d="";var v=0;var f=window.innerHeight;var u=0;var g=0;var h=null;var C=null;var k=null;var b=null;var S=window.innerHeight;var y=null;var w=null;if(t==="up"){if(s===1){return}if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom){AmpUtils.animateLoginIn()}v=s-1;m="top";c=f+"px";d="0px";if(AmpGlobal.showLoginPageFlag){if(n){v=n;c=2*f+"px"}if(v===2){var P=$("#ampEhallRoleNavPlaceHolder");if(P.length>0){u=S+P.offset().top+"px";g=S+$("#ampEhallHeader").offset().top+"px"}else{u=0;g=0}h=$("#ampEhallRoleNav");C=$("#ampClassifyRoleNav");k=$("#ampEhallHeaderContent");b=$("#ampLoginHeaderContent");y=$("#ampEhallArticle").parent();w=$("#ampClassifyArticle");w=$("#ampLoginArticle").parent()}else if(v===1){AmpUtils.animateLoginIn();g=S+$("#ampLoginHeader").offset().top+"px";u=$("#ampEhallRoleNav").offset().top+"px";b=$("#ampEhallHeaderContent");k=$("#ampLoginHeaderContent");C=$("#ampEhallRoleNav");y=$("#ampLoginArticle").parent();w=$("#ampEhallArticle").parent();w=$("#ampClassifyArticle")}}else{var P=$("#ampEhallRoleNavPlaceHolder");if(P.length>0){u=S+P.offset().top+"px"}else{u=0}h=$("#ampEhallRoleNav");C=$("#ampClassifyRoleNav");y=$("#ampEhallArticle").parent();w=$("#ampClassifyArticle")}}else if(t==="down"){if(s===l){return}if(!AMPConfigure.showLoginPageFlag&&AMPConfigure.fudanEhallCustom){AmpUtils.animateLoginOut()}v=s+1;m="top";c="-"+f+"px";d="0px";if(AmpGlobal.showLoginPageFlag){if(n){v=n;c="-"+2*f+"px"}if(v==2){AmpUtils.animateLoginOut();var P=$("#ampEhallRoleNavPlaceHolder");if(P.length>0){u=P.offset().top-S+"px"}else{u=0}g=$("#ampEhallHeader").offset().top-S+"px";h=$("#ampEhallRoleNav");C=$("#ampClassifyRoleNav");b=$("#ampLoginHeaderContent");k=$("#ampEhallHeaderContent");y=$("#ampEhallArticle").parent();w=$("#ampLoginArticle").parent()}else if(v==3){AmpUtils.animateLoginOut();u=$("#ampClassifyRoleNavPlaceHolder").offset().top-S+"px";g=$("#ampEhallHeader").offset().top+"px";h=$("#ampClassifyRoleNav");C=$("#ampEhallRoleNav");b=$("#ampEhallHeaderContent");y=$("#ampClassifyArticle");w=$("#ampEhallArticle").parent()}}else{u=$("#ampClassifyRoleNavPlaceHolder").offset().top-S+"px";h=$("#ampClassifyRoleNav");C=$("#ampEhallRoleNav");y=$("#ampClassifyArticle");w=$("#ampEhallArticle").parent()}}else if(t==="left"){v=s+1}else if(t==="right"){v=s+1}var i=o.querySelector('[slide-index="'+v+'"]');r.style[m]=c;r.style.opacity=0;if(navigator.userAgent.indexOf("MSIE 9.0")>0){r.className=r.className.replace("amp-active","")}else{r.classList.remove("amp-active")}i.style[m]=d;i.style.opacity=1;if(navigator.userAgent.indexOf("MSIE 9.0")>0){i.className=i.className+" amp-active"}else{i.classList.add("amp-active")}var I=$("#ampSlidePage");var U=I.children();$(U[v-1]).addClass("amp-active");$(U[s-1]).removeClass("amp-active");var D=$("#ampEhallRoleNavAnimateBlock");if(AmpGlobal.showLoginPageFlag){var T=$("#ampTplHeader");if(v!==3){T.removeClass("amp-hide")}else{T.addClass("amp-hide")}if(v!==1){D.removeClass("amp-hide")}else{D.addClass("amp-hide")}setTimeout(function(){D.css("top",u);T.css("top",g)},10);C.addClass("amp-hide").removeClass("amp-active");b.addClass("amp-hide").removeClass("amp-active")}else{D.removeClass("amp-hide");setTimeout(function(){D.css("top",u)},10);C.addClass("amp-hide")}AmpUtils.niceScrollHide(w);e.space.moveFlag=true;if(AmpGlobal.showLoginPageFlag){setTimeout(function(){e.space.moveFlag=false;AmpUtils.niceScrollResize(y);if(v!==3){k.removeClass("amp-hide");T.addClass("amp-hide")}if(v!==1){h.removeClass("amp-hide");D.addClass("amp-hide")}},e.space.animateTime+80)}else{setTimeout(function(){e.space.moveFlag=false;AmpUtils.niceScrollResize(y);h.removeClass("amp-hide");D.addClass("amp-hide")},e.space.animateTime+10)}}function A(e){var a=e.children;var t=a.length;var r=[];for(var i=0;i<t;i++){var n=a[i];if(n.getAttribute("role")==="slide"){r.push(n)}}return r}function C(e,a){var t=b(a);for(var r=0;r<e.children.length;r++){var i=e.children[r];if(t(i)){return i}}return null}function k(e,a){var t=b(a);var r=e.parentNode;for(;;){if(!r||r===document){return null}if(t(r)){return r}r=r.parentNode}}function b(e){return e instanceof Function?e:function(a){return S(a,e)}}function S(e,a){if(a[0]==="."){return e.classList.contains(a.slice(1))}else if(a[0]==="["){var t=a.match(/\[([a-zA-Z]*)="?([a-zA-Z]*)"?]/);var r=t[1];var i=t[2];var n=e.attributes;var s=n.length;if(s>0){for(var o=0;o<s;o++){var p=n[o];if(p.localName===r&&p.value===i){return true}if(o===s-1){return false}}}}return e.nodeName.toLowerCase()===a}function y(e,a){return e.querySelector(a)}function w(e,a){return e.querySelectorAll(a)}function P(){var e=window;var a=window.innerHeight}function I(){var e=navigator.userAgent;var a=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(a){return"mac"}else{return"window"}}})(window.slide=window.slide||{});(function(e,a){e.getTaskDatas=function(){if(AmpGlobal.loginFlag){var e=AMPConfigure.taskcenterDataRefreshTime||1;var a=parseInt(e)*6e4;t();window.setInterval(function(){t()},a)}};function t(){var e=AMPConstant.taskCenterRequestPath+"sys/taskCenter/portalDataReceive/getAllPortalTask.do";$.ajax({type:"GET",url:e,dataType:"jsonp",data:{flag:1},jsonp:"callback",cache:false,success:function(e){if(e){sessionStorage.setItem("ampTaskCenterDatas",JSON.stringify(e))}},error:function(e){if(e.status==401){AmpUtils.goLoginPage(true)}}})}})(window.AmpTaskCenter=window.AmpTaskCenter||{});(function(e,a){e.getAppCardHtml=function(t){var r=t.data;var i=t.customClass;var n=$("#tpl-app-card").html();i=i?i:"";var s=r.middleIcon;var o=r.appName;var p=AmpUtils.getCategoryListStr(r.categoryList);var l=p;var m=r.favoriteCount;var c="";if(r.assessAvgScore!=a){c=e.getAppStarHtml(r.assessAvgScore)}var d=e.getAppPermissionHtml(r.hasPermission);var v=AmpUtils.assemblyAppAttributesToStr(r);var f=e.getAppDescHtml(r.description,v);var u=r.appType;var g="";var h="热";var A="新";if(AmpGlobal.currentLang=="en_US"){h=$.i18n("hot");A=$.i18n("new")}if(u==3){g=$("#tpl-ehall-app-hot-flag-card").html().replace("@text",h)}else if(u==2){g=$("#tpl-ehall-app-new-flag-card").html().replace("@text",A)}else{g=""}n=n.replace("@customClass",i).replace("@img",s).replace("@title",o).replace("@category",p).replace("@star",c).replace("@permission",d).replace("@attributes",v).replace("@ehallAppHotNewFlag",g).replace("@catetooltip",l).replace("@permissionBig",d);var C=e.getHoverAppHtml(t);var k=$("#tpl-hover-app-card-group").html().replace("@content",n+C);return k};e.getAppDescHtml=function(e,a){if(e){return $("#tpl-ehall-app-card-desc").html().replace("@attributeBig",a)}else{return""}};e.getHoverAppHtml=function(t){var r=t.data;var i=t.customClass;var n=$("#tpl-app-card").html();i=i?i:"";var s=r.middleIcon;var o=r.appName;var p=AmpUtils.getCategoryListStr(r.categoryList);var l=p;var m=r.favoriteCount;var c="";if(r.assessAvgScore!=a){c=e.getAppStarHtml(r.assessAvgScore)}var d=e.getAppNewPermissionHtml(r.hasPermission);var v=AmpUtils.assemblyAppAttributesToStr(r);var f="";if(r.appPc!=a){if(r.appPc.isEnableDescription){f=e.getiIconHtml(v)}}var u="";var g=r.appType;var h="热";var A="新";var C="人收藏";if(AmpGlobal.currentLang=="en_US"){h=$.i18n("hot");A=$.i18n("new");C=$.i18n("collected")}if(g==3){u=$("#tpl-ehall-app-hot-flag-card").html().replace("@text",h)}else if(g==2){u=$("#tpl-ehall-app-new-flag-card").html().replace("@text",A)}else{u=""}var k="";if(navigator.userAgent.indexOf("MSIE 9.0")>0){k="amp-app-card-hover-big-IE9"}var b=e.getAppDescHtml(r.description,v);var S=$("#tpl-hover-app-card").html().replace("@permission",d).replace("@imgBig",s).replace("@starBig",c).replace("@titleBig",o).replace("@Bigtitle",o).replace("@categoryBig",p).replace("@favoriteCount",m).replace("@attributeBig",v).replace("@attributedescBig",v).replace("@catetooltip",l).replace("@iShowHtml",f).replace("@appCardHoverHotNewFlag",u).replace("@bibTitleTip",o).replace("@collected",C).replace("@classie9",k);return S};e.getServiceAppCardHtml=function(t){var r=t.data;var i=t.customClass;var n=$("#tpl-service-app-card").html();i=i?i:"";var s=r.middleIcon;var o=r.appName;var p=AmpUtils.getCategoryListStr(r.categoryList);var l=p;var m="";if(r.assessAvgScore!=a){m=e.getAppStarHtml(r.assessAvgScore)}var c=e.getAppPermissionHtml(r.hasPermission);var d=AmpUtils.assemblyAppAttributesToStr(r);var v=r.appType;var f="";var u="热";var g="新";if(AmpGlobal.currentLang=="en_US"){u=$.i18n("hot");g=$.i18n("new")}if(v==3){f=$("#tpl-ehall-app-hot-flag-card").html().replace("@text",u)}else if(v==2){f=$("#tpl-ehall-app-new-flag-card").html().replace("@text",g)}else{f=""}n=n.replace("@customClass",i).replace("@img",s).replace("@title",o).replace("@category",p).replace("@star",m).replace("@permission",c).replace("@attributes",d).replace("@ehallAppHotNewFlag",f).replace("@catetooltip",l);return n};e.getAppCardSingleHtml=function(e){var a=$("#tpl-app-card-single").html();var t=e.middleIcon;var r=e.appNameNew;if(!r||typeof r=="undefined"){r=e.appName}var i=120;if(AmpGlobal.currentLang=="en_US"){i=100}var n=AmpUtils.getCutString({width:i,line:2,string:r,chFontSize:14}).string;a=a.replace("@img",t).replace("@title",n||r);return a};e.getFavAppCardSingleHtml=function(e){var a=$("#tpl-app-card-single-myfavorite").html();var t=e.middleIcon;var r=e.appName;a=a.replace("@img",t).replace("@title",r);return a};e.getiIconHtml=function(e){return $("#tpl-hover-app-card-i-icon").html().replace(" @attributedescBig",e)};e.getAppCardGroupHtml=function(e){var a=$("#tpl-app-card-group").html();return a.replace("@content",e)};e.getAppsCardGroupContainer1Html=function(e){var a=$("#tpl-bar-apps-block-1").html();return a.replace("@title",e.title).replace("@content",e.content)};e.getSingleAppHtml=function(t,r){var i="";if(r=="single"){i=$("#tpl-app-single").html();var n=t.middleIcon;var s=t.appName;var o=AmpUtils.assemblyAppAttributesToStr(t);var p="";if(t.appPc!=a){if(t.appPc.isEnableDescription){p=e.getSingleClassifyIconHtml(o)}}i=i.replace("@img",n).replace("@title",s).replace("@attributes",o).replace("@iShowIconHtml",p)}else if(r=="complex"){i=$("#tpl-app-complex").html();var n=t.middleIcon;var l=t.cardName;var m=t.cardId;var c=t.appId;var d=t.wid;var v=t.desktopId;var o=AmpUtils.assemblyAppAttributesToStr(t);i=i.replace("@img",n).replace("@title",l).replace("@attributes",o).replace("@cardNickName",m).replace("@cardName",l).replace("@hasUnReadMark",t.hasUnReadMarkClass).replace("@hasBtnClass",t.hasBtnClass).replace("@cardWid",d)}return i};e.getSingleClassifyIconHtml=function(e){return $("#tpl-app-single-i-icon").html().replace("@attributedescBig",e)};e.getAppStarHtml=function(e){if(!e){e=0}e=e.toFixed(0);var a="";for(var t=0;t<5;t++){if(t<e){a+='<i class="iconfont icon-xingxing"></i>'}else{a+='<i class="iconfont icon-xingxing xingxing-gray"></i>'}}return'<div class="amp-app-card-star amp-clearfix-child">'+a+"</div>"};e.getAppPermissionHtml=function(e){var t="";if(e!=a){var r="无权限";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("unauthorized")}t=e?"":'<div class="amp-app-card-permission amp-pull-right">'+r+"</div>"}return t};e.getAppNewPermissionHtml=function(e){var t="";if(e!=a){t=e?"":'<div class="triangle-bottomright"> <i class="iconfont icon-lock"></i></div>'}return t};e.getAppPageHtml=function(e,a){var t='<div id="@id" class="amp-apps-page @customClass">@page</div>';var r="";var i=a&&a.id?a.id:"";var n=a.customClass?a.customClass:"";for(var s=0;s<e;s++){var o=s!==0?"":"amp-active";r+='<div class="'+o+'"></div> '}t=t.replace("@page",r).replace("@id",i).replace("@customClass",n);return t};e.getEhallFudanPageHtml=function(e,a){var t=AMPConfigure.role_data;var r=t.length;var i="";for(var n=0;n<r;n++){var s=t[n];var o=s.id;var p=n!==r-1?"":"amp-active";i+='<div amp-role-id="'+o+'" class="'+p+'"></div> '}return i};e.getRoleTabHtml=function(e){var a="";var t='<div class="amp-ehall-nav-item @activeClass">'+"<h3>@chTitle</h3>"+"<div>@enTitle</div>"+"</div>";var r=e.length;for(var i=0;i<r;i++){var n=e[i];var s=i>0?"":"amp-active";var o=n.title;var p=n.enTitle?n.enTitle:"";a+=t.replace("@activeClass",s).replace("@chTitle",o).replace("@enTitle",p)}a+='<nav class="amp-ehall-nav">'+a+"</nav>";return a};e.getRoleNavHtml=function(e){var a=AMPConfigure.role_data;var t=a.length;var r=e.customClass||"";var i=e.roleId;if(t>=4){r+=" amp-ehall-nav-"+t}var n=$("#tpl-role-nav-item").html();if(AmpGlobal.currentLang=="en_US"){n=$("#tpl-role-nav-item-en").html()}var s=e&&e.id?e.id:"";var o="";for(var p=0;p<t;p++){var l=a[p];var m=l.name;var c=l.englishName;var d=l.id;var v=d!==i?"":"amp-active";o+=n.replace("@chTitle",m).replace("@enTitle",c).replace("@activeClass",v).replace("@roleId",d)}var f=$("#tpl-role-nav").html().replace("@content",o).replace("@customClass",r).replace("@navId",s);return f};e.getBarAppsBlockHtml=function(e){var a=e.clearClass?"":"amp-hide";var t=$("#tpl-bar-apps-block").html();var r="清空结果";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("deleteAllResults")}return t.replace("@title",e.title).replace("@apps",e.apps).replace("@count",e.count).replace("@clearClass",a).replace("@deleteAllResults",r)};e.getLabelsHtml=function(e){var a="";var t=$("#tpl-label-line").html();var r=$("#tpl-label-line-item").html();var i="全部";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("all")}if(e){var n=e.length;if(n>0){for(var s=0;s<n;s++){var o=e[s];var p=o.serviceName;if(AmpGlobal.currentLang=="en_US"){if(1==o.serviceId){p=$.i18n("serviceRole")}else if(2==o.serviceId){p=$.i18n("serviceType")}else if(0==o.serviceId){p=$.i18n("serviceScene")}else if(3==o.serviceId){p=$.i18n("serviceMethod")}else if(6==o.serviceId){p=$.i18n("serviceSector")}}var l=o.serviceId;var m=o.labels;var c=m.length;var d="";for(var v=0;v<c;v++){var f=m[v];var u=f.lableName;var g=f.labelId;var h="";var A="";h=f.subLabelList!=null&&f.subLabelList.length>0?"hasSubLabelFlag":"";if(v===0){d+=r.replace("@labelName",i).replace("@labelId","all").replace("@active","amp-active").replace("@labelFlag","all").replace("@labelType",l).replace("@hasSubLabelFlag","")}d+=r.replace("@labelName",u).replace("@labelId",g).replace("@active","").replace("@labelFlag","").replace("@hasSubLabelFlag",h).replace("@labelType",l)}a+=t.replace("@serviceId",l).replace("@labelName",p).replace("@labelList",d)}}}return a};e.getWidgetAddCardAsideHtml=function(){var e="添加应用";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("addApps")}return $("#tpl-widget-add-card-aside").html().replace("@addApps",e)};e.getWidgetAddCardMainHtml=function(){var e="添加应用卡片";var a=";";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("addAppCards");a='style="margin-left: -44px"'}return $("#tpl-widget-add-card-main").html().replace("@addAppCards",e).replace("@styleEn",a)};e.getWidgetDragCardMainHtml=function(){var e="从左侧选择需要的应用卡片";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("selectTheApp")}return $("#tpl-widget-drag-card-main").html().replace("@selectTheApp",e)};e.getWidgetLostPermissionCard=function(e){var a=e.widgetId;var t=e.widgetWid;var r=e.widgetsJsonData?e.widgetsJsonData[e.widgetId]:"";var i=" ";if(r){for(var n in r){i+=""+n+' = "'+r[n]+'" '}i+=' widget_title_enus  = "'+e.widgetTitleEnus+'" '}return $("#tpl-widget-lost-permission-card").html().replace("@content","<"+a+i+"></"+a+">").replace("@widgetid",a).replace("@widgetWid",t)};e.getWidgetMainItemHtml=function(e){var a=e.widgetsJsonData?e.widgetsJsonData[e.widgetId]:"";var t=" ";if(a){for(var r in a){t+=""+r+' = "'+a[r]+'" '}t+=' widget_title_enus  = "'+e.widgetTitleEnus+'" '}return $("#tpl-widget-main-item").html().replace("@content","<"+e.widgetId+t+" ></"+e.widgetId+">").replace("@widgetId",e.widgetId).replace("@widgetid",e.widgetId).replace("@dragClass",e.dragCardClass).replace("@widgetWid",e.widgetWid).replace("@recommedCard",e.recommCardClass).replace("@appId",e.appId).replace("@appKey",e.appKey).replace("@refreshClass",e.refreshClass)};e.getWidgetAsideNormalItemHtml=function(e){return $("#tpl-widget-aside-normal-item").html().replace("@content","<"+e+"></"+e+">").replace("@widgetId",e)};e.getPromptHtml=function(e){return AmpUtils.replaceHtmlAnnotation($("#tpl-prompt").html()).replace("@content",e.content).replace("@promptStateClass",e.promptStateClass).replace("@stateIconClass",e.stateIconClass)};e.getDetailHtml=function(){var e="服务说明";var a="下次不再显示";var t="登录";var r="后查看使用权限";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("serviceDescription");a=$.i18n("doNotShow");t=$.i18n("login");r=$.i18n("checkUsageRight")}return $("#tpl-app-detail").html().replace("@serviceDescription",e).replace("@doNotShow",a).replace("@loginbtn",t).replace("@checkUsageRight",r)};e.getFolderHtml=function(){var e="共 ";var a=" 个服务";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("aTotalOf");a=$.i18n("services")}return $("#tpl-folder").html().replace("@aTotalOf",e).replace("@services",a)};e.getApprovalCommentHtml=function(){var e="审批意见";var a="关闭";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("approvalAdvice");a=$.i18n("close")}return $("#tpl-approval-comments").html().replace("@approvalAdvice",e).replace("@close",a)};e.getHeaderUserInfoHtml=function(){var e=AmpDataUtils.space.ampData;var a="管理服务";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("editServices")}var t=!e.hasManagePermission?"":'<div id="ampHeaderUserInfoAdminBtn" class="amp-animate-all-fast" >'+a+"</div>";var r=e.userPhoto;var i="true";var n="重新上传";if(!r){r="portal/images/icons/user-role-teacher.png";i="false";n="上传图像"}var s="";if(AMPConfigure.personalCenterAuthserverUrl){var o="个人中心";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("personalCenter")}if($("#tpl-header-user-info-personal-center").length>0){s=$("#tpl-header-user-info-personal-center").html().replace("@personalCenter",o)}}var p="";if(AMPConfigure.switchPortalSiteModel){if(e.hasTeacherDesktopAuth){var l="简版门户";if(AmpGlobal.currentLang=="en_US"){l=$.i18n("liteEdition")}if($("#tpl-portal-site-model").length>0){p=$("#tpl-portal-site-model").html().replace("@siteTypeName",l)}}}if($("#tpl-header-user-info").length>0){var m="安全退出";if(AmpGlobal.currentLang=="en_US"){m=$.i18n("signOut")}return $("#tpl-header-user-info").html().replace("@username",e.userName).replace("@adminBtn",t).replace("@userPhotoSrc",r).replace("@personalCenterHtml",s).replace("@signOut",m).replace("@hasPhoto",i).replace("@siteTypeHtml",p)}else{return""}};e.getHeaderUserSkinHtml=function(e,a){var t=e.themeColor;var r=e.themeEyeShieldSwitch;var i="";var n="";var s="";var o="";var p="皮肤";var l="护眼模式";var m="开启";var c="关闭";var d="";if(AmpGlobal.currentLang=="en_US"){l=$.i18n("eyeShieldMode");p=$.i18n("skin");c=$.i18n("closeSkinCool");m=$.i18n("openSkin")}if($("#tpl-header-user-skin").length>0){n=$("#tpl-header-user-skin").html().replace("@skin",p)}i=t=="dark"?m:c;var v=a.skinConfigList;if(typeof v!="undefined"){for(var f=0;f<v.length;f++){var u=e.skinName;var g="";var h="";var A="";var C=v[f].skinId;if(v[f].skinId==u){g="ampSkinUseFlag"}else{g="ampSkinCheckFlag"}h=v[f].bgUrl;A=v[f].skinName;var k="选用皮肤";var b="使用中";if(AmpGlobal.currentLang=="en_US"){k=$.i18n("selectSkin");b=$.i18n("inUse")}else{}if($("#tpl-skin-item").length>0){s+=$("#tpl-skin-item").html().replace("@switchCheckFlag",g).replace("@smallImgSrc",h).replace("@skinName",A).replace("@skinbg",C).replace("@newSkinName",C).replace("@selectSkin",k).replace("@inUse",b);localStorage.userSkinHtml=s}}}if(r&&$("#tpl-header-user-skin").length>0){o=$("#tpl-header-skin-bhswitch").html().replace("@eyeShieldMode",l).replace("@skinSwitchText",i)}n=n.replace("@content",s).replace("@skinEyeSwitch",o);return n};e.getHeaderInternationHtml=function(e){return $("#tpl-header-internation-ue").html()};e.getCategoryTabHtml=function(e){var a="搜索可用卡片";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("searchAvailableCards")}return $("#tpl-category-tab").html().replace("@header",e.header).replace("@content",e.content).replace("@tabUlId",e.tabUlId).replace("@tabContentId",e.tabContentId).replace("@searchAvailableCards",a)};e.getCategoryTabHeadItemHtml=function(e){return $("#tpl-category-tab-head-item").html().replace("@id",e.id).replace("@name",e.name).replace("@customClass",e.customClass).replace("@hasUnReadMarkClass",e.hasUnReadMarkClass).replace("@appCount",e.appCount).replace("@titleName",e.name)};e.getCategoryTabHeadItemTplHtml=function(){return $("#tpl-category-tab-head-item").html()};e.getCategoryTabContentItemHtml=function(e){return $("#tpl-category-tab-content-item").html().replace("@id",e.key).replace("@content",e.content).replace("@customClass",e.customClass).replace("@num",e.id)};e.getLoadingFrameHtml=function(e){var a=e.customClass?e.customClass:"";if($("#tpl-loading-frame").length>0){return $("#tpl-loading-frame").html().replace("@content",e.html).replace("@customClass",e.customClass)}else{return""}};e.getAsideAppsHtml=function(e){return $("#tpl-aside-appList").html().replace("@title",e.title).replace("@content",e.apps)};e.getWidgetDesktopCreatItemHtml=function(e){return $("#tpl-widget-desktop-creat-item").html().replace("@content","<"+e+"></"+e+">").replace("@widgetId",e)};e.getWidgetAddSmalltoolItemHtml=function(e,a){var a=a;var t=a.title;var r=a.label;var i=a.content;var n="教务";var s="学工";var o="人事";var p="添加小工具";if(AmpGlobal.currentLang=="en_US"){n=$.i18n("educationalAffairs");s=$.i18n("studentAffairs");o=$.i18n("personnel");p=$.i18n("addGadgets")}var l=$("#tpl-add-smalltool-mb-content").html().replace("@title",t).replace("@content",i).replace("@educationalAffairs",n).replace("@studentAffairs",s).replace("@personnel",o).replace("@addGadgets",p);return $("#tpl-widget-add-smalltool-item").html().replace("@content","<"+e+"></"+e+">").replace("@widgetId",e).replace("@mbcontent",l)};e.getTagsMessages=function(e){var a=e.id;var t=e.title;var r=e.content;var i="";var n="";var s="";var o="";var p="";var l=e.typeId;var m=AmpUtils.getCutString({width:280,line:3,string:r,chFontSize:12,enFontSize:9});var c=m.string;c=c==null?"":c;var d=m.type;var v=AmpUtils.convertTimeToRecently(e.time);var f=e.type;var u="amp-message-item amp-animated";if("【回复】意见反馈"==t){u="amp-message-item amp-animated amp-feedback-message"}else if("【回复】应用评价反馈"==t){u="amp-message-item amp-animated amp-assess-message";if(typeof e.pcUrl=="string"){try{var g=JSON.parse(e.pcUrl);i=g.appId;n=g.appName;s=g.isHasHead;o=g.isThirdParty;p=g.url}catch(e){}}}else{u="amp-message-item amp-animated amp-normal-message"}return $("#tpl-tag-messages").html().replace(/@title/g,t).replace("@smallContent",c).replace("@fullContent",r).replace("@typeId",l).replace("@type",f).replace("@time",v).replace("@cutType",d).replace("@tipTitle",t).replace("@messageId",a).replace("amp-message-item amp-animated",u).replace("@url",p).replace("@appId",i).replace("@appName",n).replace("@hashead",s).replace("@isthirdparty",o)};e.getRecommendHtml=function(e){var a="推荐卡片-猜你需要的APP";var t="平台管理员向你推荐了这个应用卡片，您可以选择是否保留在桌面上。";var r="留下";var i="我不需要";var n="将卡片留在";var s="新建的桌面";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("recommendedCard");t=$.i18n("thePlatformAdministrator");r=$.i18n("keep");i=$.i18n("iDoNotNeedIt");n=$.i18n("keepTheCardIn");s=$.i18n("newDesktop")}return $("#tpl-card-recommed").html().replace("@desktopnacContent",e).replace("@recommendedCard",a).replace("@thePlatformAdministrator",t).replace("@keep",r).replace("@iDoNotNeedIt",i).replace("@keepTheCardIn",n).replace("@newDesktop",s)};e.getRecommendDesktopNav=function(e){var a=e.desktopId;var t=e.desktopName;var r=e.desktopType;var i=e.cardWid;return $("#tpl-recommend-desktop-nav").html().replace("@desktopId",a).replace("@desktopName",t).replace("@desktopName",t).replace("@desktopType",r).replace("@cardWid",i)};e.getPersonalEmptyPage=function(e){return $("#tpl-personal-empty-page").html().replace("@message",e)};e.getPersonalAsideRightZqfwEmptyPage=function(e){return $("#tpl-personal-aside-zqfw-empty-page").html().replace("@message",e)};e.getAdminNewDesktopHtm=function(){var e="新增桌面-管理员新增的桌面";var a="平台管理员根据您的业务需要，为您设置了新的桌面，好好使用吧！";var t="我知道了";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("newDesktops");a=$.i18n("administratorSetNewDesktop");t=$.i18n("iKnow")}return $("#tpl-admin-new-desktop").html().replace("@newDesktops",e).replace("@administratorSetNewDesktop",a).replace("@iKnow",t)};e.createDesktopDialogHtm=function(){var e="新建的桌面";var a="命名桌面";var t="保存";var r="取消";var i="8";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("newDesktop");a=$.i18n("desktopName");t=$.i18n("save");r=$.i18n("cancel");i=$.i18n("desktopLength")}return $("#tpl-create-desktop").html().replace("@newDesktop",e).replace("@desktopName",a).replace("@save",t).replace("@cancel",r).replace("@desktopLength",i)};e.createFolderNameDialogHtm=function(e,a){var t="重命名文件夹";var r=e;var i="保存";var n="取消";var s="5";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("rename folder");i=$.i18n("save");n=$.i18n("cancel");desktopLength=$.i18n("desktopLength")}return $("#tpl-create-folder-name").html().replace("@title",t).replace("@newFolderName",r).replace("@save",i).replace("@cancel",n).replace("@folderLength",s).replace("@folderId",a)};e.headerExpandDialogHtm=function(e){var a="";if($("#tpl-header-expand").length>0){a=$("#tpl-header-expand").html().replace("@expandContent",e)}return a};e.headerExpandItem=function(e){var a=e.wid;var t=e.url;var r=e.name;var i=e.isOpenNewWindow;var n="";var s=e.isAddUserid;if(s=="1"||s==1){var o=sessionStorage.ampUserId;if(t.indexOf("?")<0){t=t+"?userId="+o}else{t=t+"&userId="+o}}if($("#tpl-header-expand-item").length>0){n=$("#tpl-header-expand-item").html().replace("@menuId",a).replace("@menuUrl",t).replace("@dataName",r).replace("@isOpenNewWindow",i).replace("@menuName",r)}return n};e.getAsideRightTaskItem=function(a,t){var r=a.subject||"";var i="";var n="";if(a.isSingleData){i=e.getAsideRightTaskItemImgHtm()}if(a.isDisplayData){n=e.getAsideRightTaskItemDisplayDataHtm(a.dataNum)}var s="task-type-db";var o="";if("3"==t){o="审核中"}if("1"==t){if(a.priority&&a.priority===1){o="紧急";s="task-type-jj"}else{o="请处理";s="task-type-db"}}var p="审批意见";var l="流程图";var m="已完成";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("ToDoOnly");if("3"==t){o=$.i18n("processing")}if("1"==t){if(a.priority&&a.priority===1){o=$.i18n("urgent")}else{o=$.i18n("ToDoOnly")}}p=$.i18n("approvalAdvice");l=$.i18n("flowChart");m=$.i18n("completed")}if("COMPLETE"==a.processStatus){o=m;s="task-type-ywc"}if("ABORT"==a.processStatus){o="已终止";s="task-type-jj";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("terminated")}}return $("#tpl-aside-right-process-item").html().replace("@formUrl",a.formUrl).replace("@appId",a.appId).replace("@taskId",a.taskId).replace("@createTime",a.createTime).replace("@lctappId",a.appId).replace("@fulltaskTitle",r).replace("@taskTitle",r).replace("@isDisplayData",n).replace("@todoList",o).replace("@taskTypeColor",s)};e.getAsideRightTaskItemImgHtm=function(e){return $("#tpl-aside-right-process-item-img").html()};e.getAsideRightTaskItemDisplayDataHtm=function(e){var a="条";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("items")}return $("#tpl-aside-right-process-item-displayData").html().replace("@dataNum",e).replace("@items",a)};e.getAsideRightTaskZqfwItem=function(e){var a=e.openBeginTime;var i=e.openEndTime;var n=(new Date).getTime();var s=t(a);var o="";var p="";var l="";var m="开放";var c="开放中";var d="今天";var v="结束";var f="还剩";var u="天";if(AmpGlobal.currentLang=="en_US"){m=$.i18n("open");c=$.i18n("opening");d=$.i18n("today");v=$.i18n("finish");f=$.i18n("leftFor");u=$.i18n("open")}if(s>0){if(AmpGlobal.currentLang=="en_US"){f="";u=" Left"}o=r(a)+" "+m;p=f+s+u;l="tip amp-color-gray-lv3"}else if(s<0){o=r(i)+" "+v;p=c;l="tip amp-color-success-new-lv1"}else{if(a>n){o=r(a)+" "+m;p=d;l="tip amp-color-gray-lv3"}else{o=r(i)+" "+v;p=c;l="tip amp-color-success-new-lv1"}}var g=AmpUtils.assemblyAppAttributesToStr(e);return $("#tpl-aside-right-process-item-zqfwData").html().replace("@middleIcon",e.middleIcon).replace("@appName",e.appName).replace("@displayDate",o).replace("@tipClass",l).replace("@tipTxt",p).replace("@attrStr",g)};function t(e){var a=(new Date).getFullYear();var t=(new Date).getDate();var r=(new Date).getMonth();var i=new Date(e).getFullYear();var n=new Date(e).getDate();var s=new Date(e).getMonth();return(new Date(i,s,n).getTime()-new Date(a,r,t).getTime())/864e5}function r(e){var a=new Date(parseInt(e));var t=a.getMonth()+1;var r=a.getDate();var i=a.getHours();var n=a.getMinutes();if(t<10){t="0"+t}if(r<10){r="0"+r}if(i<10){i="0"+i}if(n<10){n="0"+n}return t+"/"+r+" "+i+":"+n}e.getDesktopBlurHtm=function(a){var t=e.getDesktopBlurItemsHtm(a);return $("#tpl-personal-center-desktop-blur").html().replace("@content",t)};e.getDesktopBlurItemsHtm=function(e){var a=$("#tpl-personal-center-desktop-blur-item").html();var t="";if(e>1){for(var r=0;r<e;r++){t+=a}}else{t=a}return t};function i(e){var a=e;var e="";var t=n(a);switch(a){case"indigo":e=t==""?"靛蓝":t;break;case"teal":e=t==""?"水鸭绿":t;break;case"millennium":e=t==""?"千禧绿":t;break;case"cherry":e=t==""?"樱桃红":t;break;case"magenta":e=t==""?"绛紫":t;break;case"golden":e=t==""?"香槟金":t;break}return e}function n(e){var a=AMPConfigure.portalSkin_custom;var t="";if(typeof a!="undefined"){skinList=a.length;if(skinList>0){for(var r=0;r<skinList;r++){var i=a[r];if(i.enable&&i.skinColor==e){t=i.skinName;break}}}}return t}e.getCanUseAppGroup=function(){var e=$("#tpl-canUseApp-group-apps").html();return e};e.geMyfavoriteTabHtml=function(e){return $("#tpl-myfavorite-apps-tab").html().replace("@header",e.header).replace("@content",e.content).replace("@tabUlId",e.tabUlId)};e.getMyFavoriteCategoryTabContentItemHtml=function(e){return $("#tpl-canUseApp-tab-content-item").html().replace("@id",e.id).replace("@content",e.content).replace("@customClass",e.customClass).replace("@num",e.id).replace("@classify",e.key)}})(window.AmpTemplate=window.AmpTemplate||{});(function(e,a){var t=$("body");t.on("click",".refresh-btn",function(){$("#timeoutPage").addClass("amp-hide");window.location.reload()})})(window.AmpTimeout=window.AmpTimeout||{});(function(e,a){e.bodyEventsListen=function(){$("body").on("click",function(e){i(e)})};e.doSendAjax=function(e,a){var t=$.Deferred();$.ajax({type:"GET",url:e,traditional:true,data:a,dataType:"json",cache:false,success:function(e){if(!e.hasLogin){r()}t.resolve(e)},error:function(e){t.reject(e)}});return t.promise()};e.doJsonpAjax=function(e,a){var t=$.Deferred();$.ajax({type:"GET",url:e,traditional:true,data:a,dataType:"json",cache:false,success:function(e){if(!e.hasLogin){r()}t.resolve(e)},error:function(e){t.reject(e)}});return t.promise()};e.checkIsLogin=function(){};e.goLoginPage=function(a){if(typeof a!="undefined"&&a){e.showTimeoutPage()}else{window.location.href=AMPConstant.requestPath+"login?service="+window.location.href}};e.logout=function(){window.location.href=AMPConstant.requestPath+"logout?service="+window.location.href};e.getCutString=function(e){return d(e)};e.convertTimeToRecently=function(e){return A(e)};e.showTimeoutPage=function(){$("#timeoutPage").removeClass("amp-hide")};e.getUserRoleId=function(e){var a="1__0";if(e){switch(e){case 1:a="1__0";break;case 2:a="1__1";break;case 3:a="1__2";break;case 4:a="1__3";break;case 5:a="1__4";break}}else{var t=AMPConfigure.role_data;var r=t.length;for(var i=0;i<r;i++){var n=t[i];if(n.active){a=n.id;break}}}return a};e.loadWidgetJson=function(e){var a=$.Deferred();var t=e.appId;var r=e.cardId;var i=e.desktopNum;var n="";if(typeof AMPConfigure.desktop_custom!="undefined"&&AMPConfigure.desktop_custom.pccard_customization){if(typeof i!="undefined"&&!i){n="portal_custom/pc_card_custom/"+t+"/"+r+"/card.json"}else{n="pc_card/"+t+"/"+r+"/card.json"}}else{n="pc_card/"+t+"/"+r+"/card.json"}$.ajax({type:"GET",url:n,dataType:"json",async:false,success:function(t){a.resolve(t,e)},error:function(t){a.reject(t,e)}});return a.promise()};e.setContainerMinHeight=function(e,a){var t=0;var r=a.diffHeight?parseInt(a.diffHeight,10):0;var i=a.excludeContainers;if(i){var n=i.length;if(n>0){for(var s=0;s<n;s++){t+=i[s].outerHeight(true)}}}var o=window.innerHeight;var p=o-t-r;e.css("height",p+"px")};e.clickPage4RotateYState=function(a,t){var r=a.container;var i=a.pageContainer;var n=t.container;var s=n.children();var o=s.length;var p=t.pageContainer;s.each(function(a,t){e.setRotateYState($(this),"hide",a*AmpGlobal.rotateYTimeStep)});setTimeout(function(){n.addClass("amp-hide");r.removeClass("amp-hide");if(p.length!==0&&i.length!==0){p.removeClass("amp-active");i.addClass("amp-active")}setTimeout(function(){r.children().each(function(a){e.setRotateYState($(this),"show",a*AmpGlobal.rotateYTimeStep)})},50)},450+(o-3)*AmpGlobal.rotateYTimeStep)};e.setRotateYState=function(e,a,t){setTimeout(function(){if(a==="show"){e.removeClass("amp-rotateY-hide")}else{e.addClass("amp-rotateY-hide")}},t)};e.animateMove=function(e,a){var t=e.container;var r=e.index;var i=e.pageContainer;var n=a.index;var s=a.container;var o=a.pageContainer;var p="";var l="";if(r>n){p="amp-animate-move-right-in";l="amp-animate-move-left-out"}else{p="amp-animate-move-left-in";l="amp-animate-move-right-out"}s.removeClass("amp-animate-move-right-in amp-animate-move-left-in").addClass(l).removeClass("amp-hide");setTimeout(function(){s.addClass("amp-hide");t.removeClass("amp-animate-move-right-out amp-animate-move-left-out").addClass(p).removeClass("amp-hide");if(o.length!==0&&i.length!==0){$("#ampEhallBody").find(".amp-ehall-nav").each(function(e){var a=$(this).children();if($(a[n]).hasClass("amp-active")&&s.hasClass("amp-hide")){$(a[n]).removeClass("amp-active");$(a[r]).addClass("amp-active")}else{t.addClass("amp-hide")}})}},250)};e.getCategoryListStr=function(e){var a="";if(e){var t=e.length;if(t>0){for(var r=0;r<t;r++){if(r!==0){a+="/"+e[r].categoryName}else{a+=e[r].categoryName}}}}return a};e.niceScrollInit=function(e,a){if(!e)return;e.niceScroll({zindex:1e3,cursorwidth:"12px",autohidemode:false,horizrailenabled:false})};e.niceScrollShow=function(e,a){if(!e)return;e.niceScroll({zindex:1e3,cursorwidth:"12px",autohidemode:false,horizrailenabled:false})};e.niceScrollResize=function(e){if(!e)return;e.getNiceScroll().resize()};e.niceScrollHide=function(e){e.getNiceScroll().hide()};e.customScrollInit=function(e){if(!e)return;e.mCustomScrollbar({theme:"minimal-dark"})};e.assemblyAppAttributesToStr=function(a){var t=a.appId;var r=a.appKey;var i="appShow?appId="+t;var n=a.appName;var s=a.favoriteApp;var o=a.hasPermission;var p=a.appPc;var l="";var m="";var c="";var d="";var v="";if(p){l=p.isEnableDescription;m=p.descriptionAuth;c=p.isOpenInNewTab;d=p.isHasHead;v=p.isThirdParty}else{l=a.isEnableDescription;m=a.descriptionAuth;c=a.isOpenInNewTab}var f=a.unviewableDescription;var u=a.type;var g=a.opening;var h=a.maintaining;var A=a.middleIcon;var C=a.version;var $=e.getCategoryListStr(a.categoryList);var k=' amp-appid="'+t+'"';k+=' amp-appkey="'+r+'"';k+=' amp-full-screen="'+c+'"';k+=' amp-url="'+i+'"';k+=' amp-title="'+n+'"';k+=' amp-favorite="'+s+'"';k+=' amp-haspermission="'+o+'"';k+=' amp-hasdescription="'+l+'"';k+=' amp-descriptionauth="'+m+'"';k+=' amp-unviewabledescription="'+f+'"';k+=' amp-type="'+u+'"';k+=' amp-opening="'+g+'"';k+=' amp-maintaining="'+h+'"';k+=' amp-img="'+A+'"';k+=' amp-version="'+C+'"';k+=' amp-category="'+$+'"';k+=' amp-hashead="'+d+'"';k+=' amp-isThirdParty="'+v+'"';return k};e.copyAppAttributesFromDomToDom=function(e,a){a.attr("amp-appid",e.attr("amp-appid"));a.attr("amp-appkey",e.attr("amp-appkey"));a.attr("amp-url",e.attr("amp-url"));a.attr("amp-title",e.attr("amp-title"));a.attr("amp-type",e.attr("amp-type"));a.attr("amp-hashead",e.attr("amp-hashead"));a.attr("amp-isthirdparty",e.attr("amp-isthirdparty"));a.attr("amp-modulename",e.attr("amp-modulename"))};e.loadWidgetComponentHtml=function(e,a){var t=e.appId;var r=e.cardId;var i=e.desktopNum;var n=r;if(!n||n==="undefined"){return}var s="card-link-"+n;if($("#"+s).length>0){return}var o=document.createElement("link");o.id=s;o.rel="import";var p="";if(typeof AMPConfigure.desktop_custom!="undefined"&&AMPConfigure.desktop_custom.pccard_customization){if(typeof i!="undefined"&&!i){p="portal_custom/pc_card_custom/"+t+"/"+r+"/card.html"}else{p="pc_card/"+t+"/"+r+"/card.html"}}else{p="pc_card/"+t+"/"+r+"/card.html"}o.href=p;document.getElementsByTagName("head")[0].appendChild(o);$("body").on("widgetComplete",n,function(){return a(n)})};e.replaceHtmlAnnotation=function(e){var a=new RegExp("<![^>]*?>");var t=e.replace(a,"");return t};e.currentPageBlurAnimate=function(a){var t=null;var r=$("body").find('article.amp-active[amp-page-flag="true"]');if(r.length===1){t=r}else{r.each(function(){var e=$(this);var a=e.attr("id");if(a==="ampServiceArticle"){t=e;return false}if(a!=="ampEhallArticle"&&a!=="ampClassifyArticle"){t=e}})}if(t){e.containerBlurAnimate(t,a)}};e.containerBlurAnimate=function(e,a){var t=AmpGlobal.blurDegree;var r=a==="blur"?1:t;var i=AmpGlobal.animateTimes;var o=60;var p=i*o/1e3;var l=i/p;var m=parseInt(o/p,10);var c=s(e);if(a==="blur"){if(c===t){return}}else{if(!c){return}}var d={index:r,container:e,flag:a,intervalTimes:l,blurDegree:t,step:m,stopFlag:false};n(d)};e.setContainerBlue=function(e,a){o(e,a)};e.synchronousAppAttributes=function(e,a){$("body").find('.appFlag[amp-appid="'+e+'"]').each(function(){var e=$(this);for(var t in a){var r=a[t];e.attr(t,r)}});$("body").find('.ampAppdescFlag[amp-appid="'+e+'"]').each(function(){var e=$(this);for(var t in a){var r=a[t];e.attr(t,r)}})};e.getContainerPosition=function(e){var a=e.offset();var t=e.outerWidth();var r=e.outerHeight();return{top:a.top,left:a.left,right:a.left+t,bottom:a.top+r,width:t,height:r}};e.NewGuid=function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()};function t(){return((1+Math.random())*65536|0).toString(16).substring(1)}e.encode=function(e){return $("<div/>").text(e).html()};e.decode=function(e){return $("<div/>").html(e).text()};function r(){if($("#user").find("img").attr("data-tooltip-title")){e.goLoginPage();return}}function i(e){var a=$(e.target||e.srcElement);if(a.closest("#ampPageHeaderSearch").length===0&&a.attr("id")!=="ampPageHeaderSearch"&&!$("#ampServiceArticle").hasClass("amp-active")){AmpHeader.searchRestore()}if(a.closest("#ampHeaderToolUser").length===0&&a.closest("#ampHeaderToolUserName").length===0){$("#ampHeaderUserInfo").removeClass("amp-active")}}function n(e){var a=e.index;var t=e.container;var r=e.flag;var i=e.intervalTimes;var s=e.blurDegree;var o=e.step;var p=e.stopFlag;t.css({"-webkit-filter":"blur("+a+"px)","-moz-filter":"blur("+a+"px)","-ms-filter":"progid:DXImageTransform.Microsoft.Blur(PixelRadius="+a+")",filter:"blur("+a+"px)",filter:"progid:DXImageTransform.Microsoft.Blur(pixelRadius="+a+",   MakeShadow=false)"});setTimeout(function(){if(r==="blur"){if(p){return}e.index=a+o;if(e.index>s){e.index=s;e.stopFlag=true}}else{if(p){return}a--;e.index=a-o;if(e.index<0){e.index=0;e.stopFlag=true}}n(e)},i)}function s(e){var a=/\d+/;var t=null;if(e.css("filter")&&e.css("filter")!=="none"){t=e.css("filter").match(a)}else{if(e.css("-webkit-filter")){t=e.css("-webkit-filter").match(a)}else if(e.css("-ms-filter")){t=e.css("-ms-filter").match(a)}else if(e.css("-moz-filter")){t=e.css("-moz-filter").match(a)}}var r=0;if(t){r=parseInt(t[0],10)}return r}function o(e,a){var t=AmpGlobal.blurDegree;var r=a==="blur"?t:0;e.css({"-webkit-filter":"blur("+r+"px)","-moz-filter":"blur("+r+"px)","-ms-filter":"blur("+r+"px)",filter:"blur("+r+"px)",filter:"progid:DXImageTransform.Microsoft.Blur(pixelRadius="+r+",   MakeShadow=false)"})}AmpUtils.tooltipInit=function(){var e=$("body");e.on("mouseover",".tooltipFlag",function(e){p(e)});e.on("mouseout",".tooltipFlag",function(e){l(e)})};function p(e){var a=$(e.target||e.srcElement);if(!a.hasClass("tooltipFlag")){return}var t=a[0].offsetWidth,r=a[0].offsetHeight,i=a.offset(),n=a.hasClass("tooltipLeftFlag"),s=a.attr("data-tooltip-title");if(s){var o=AmpUtils.NewGuid(),p=c(s,o),l=p.outerWidth(true),m=p.outerHeight(true),d=n?0:parseInt(i.left+t/2),v=n?i.left:d-parseInt(l/2),f=i.top+r+4,u={left:v+"px",top:f+"px",height:0};if(v+l>$("body").width()){u={right:"0",top:f+"px",height:0}}p.css(u).show().animate({height:m+"px"},300);a.attr("data-tooltip-guid",o)}}function l(e){var a=$(e.target||e.srcElement),t=a.attr("data-tooltip-guid"),r=$("body").find("#tooltip_"+t);r.animate({height:0},300).promise().done(function(){r.remove()})}AmpUtils.NewGuid=function(){return m()+m()+"-"+m()+"-"+m()+"-"+m()+"-"+m()+m()+m()};function m(){return((1+Math.random())*65536|0).toString(16).substring(1)}function c(e,a){$("body").append('<div id="tooltip_'+a+'" class="amp-tooltip">'+e+"</div>");return $("#tooltip_"+a)}e.setLocalStorageData=function(e,a){var t=window.localStorage;t.setItem(e,a)};e.getLocalStorageData=function(e){var a=window.localStorage;return a.getItem(e)};e.deleteLocalStorageData=function(e){localStorage.removeItem(e)};e.setSessionStorageData=function(e,a){sessionStorage.setItem(e,a)};e.getSessionStorageData=function(e){return sessionStorage.getItem(e)};e.deleteSessionStorageData=function(e){sessionStorage.removeItem(e)};e.animateLoginOut=function(){$("#ampPageBgImg").animate({opacity:"0.5"},10,"swing",function(){$(this).removeClass("amp-login-img").addClass("amp-page-img").animate({opacity:"1"},10,"linear");e.getUserSkinImg()})};e.animateLoginIn=function(){$("#ampPageBgImg").animate({opacity:"0.5"},10,"swing",function(){$(this).removeClass("amp-page-img").addClass("amp-login-img").animate({opacity:"1"},10,"linear");e.getUserSkinImg()})};e.getByteLen=function(e){var a=0;for(var t=0;t<e.length;t++){var r=e.charAt(t);if(r.match(/[^\x00-\xff]/gi)!=null){a+=2}else{a+=1}}return a};e.isIE=function(){if(!!window.ActiveXObject||"ActiveXObject"in window){return true}else{return false}};function d(e){var a="normal";var t="";var r=e.width;var i=e.line;var n=e.string;var s=/<[^>]+>/g;var o=/<[^>]+> *<[^>]+>/g;var p=n?n.replace(o,""):null;var l=p?p.replace(s,""):null;var m=l==null?0:l.length;var c=e.chFontSize;var d=parseInt(r*i/c,10);if(m<=d){t=n}else{var u=f(n);a="cut";t=g(r*i-c*2,d,l,e);t=v(t,u);t+="..."}return{string:t,type:a}}function v(e,a){var t="";var r=a.length;if(r===0){t=e}else{var i=e.split("");var n=i.length;for(var s=0;s<r;s++){var o=a[s];var p=o.index;var l=o.tag;if(p<n){if(/^<\//.test(l)){i[p-1]=i[p-1]+l}else{i[p]=l+i[p]}}else{if(/^<\//.test(l)){var m=a[s-1].index;i.splice(m,n-m)}break}}t=i.join("")}return t}function f(e){var a=/<[^>]+>/g;var t=e.match(a);var r=[];if(t){var i=t.length;for(var n=0;n<i;n++){var s=t[n];var o=e.indexOf(s);e=e.replace(s,"");r.push({index:o,tag:s})}}return r}function u(e,a,t,r){var i=e.indexOf(a.tag,t);r++;if(r===a.times){return i}else{return u(e,a,i+1,r)}}function g(e,a,t,r){var i=t.substring(0,a);var n=t.substring(a,t.length);var s=h(i,r);var o="";if(s<e){var p=e-s;if(p>r.chFontSize){var l=parseInt(p/r.chFontSize,10);o=g(p,l,n,r)}}return i+o}function h(e,a){var t=e.match(/[^\x00-\xff]/g);var r=t?t.length:0;var i=e.match(/[A-Z@]/g);var n=i?i.length:0;var s=e.length-r-n;var o=(r+n)*a.chFontSize+s*a.enFontSize;return o}function A(e){var a=new Date;var t=a.getFullYear();var r=a.getMonth()+1;var i=a.getDate();var n=new RegExp("(\\d*)-(\\d*)-(\\d*) (\\d*):(\\d*):(\\d*)");var s=e.match(n);var o=s[1];var p=s[2];var l=s[3];var m=s[4];var c=s[5];var d=24*60*60*1e3;var v="";var f=new Date(t+"/"+r+"/"+i).getTime();var u=new Date(o+"/"+p+"/"+l).getTime();var g=(f-u)/d;if(g<1){var h="今天";if(AmpGlobal.currentLang=="en_US"){h=$.i18n("today")}v=h}else if(g<2){var h="昨天";if(AmpGlobal.currentLang=="en_US"){h=$.i18n("yesterday")}v=h}else if(g<3){var h="前天";if(AmpGlobal.currentLang=="en_US"){h=$.i18n("theDayBeforeYesterday")}v=h}else{v=p+"-"+l}return v+" "+m+":"+c}AmpUtils.getScreenWidthHeight=function(){return{screenH:window.screen.availHeight,screenW:window.screen.availWidth}};e.getTaskAjax=function(e){var a=$.Deferred();$.ajax({type:"get",url:e,dataType:"jsonp",jsonp:"callback",cache:false,success:function(e){if(!e.hasLogin){r()}a.resolve(e)},error:function(e){a.reject(e)}});return a.promise()};e.setScroll=function(e,a){a=a||550;if(e.css("overflow-y")==="hidden"){setTimeout(function(){e.getNiceScroll().resize()},a);return}setTimeout(function(){AmpUtils.niceScrollInit(e)},a)};e.checkEvent=function(e,a,t){if(!e||!a){return}t=t||50;var r=20;if(e()){a()}else{var i=null;var n=function(){i=setTimeout(function(){if(e()){clearTimeout(i);a()}else{r--;clearTimeout(i);if(r!==0){n()}}},t)};n()}};e.getJsonpAppPath=function(){return AMPConstant.jsonpRequestPath};e.setIe9PlaceHolder=function(){if(navigator.userAgent.indexOf("MSIE 9.0")>0){$("input,text,textarea").placeholder()}};e.setCookie=function(e,a){var a=e+"="+escape(a)+";path=/"+";expires="+new Date(2099,12,31).toGMTString();if("https:"==document.location.protocol){a+=";secure"}document.cookie=a};e.getCookie=function(e){var a=document.cookie;var t=a.indexOf(e);if(t!=-1){t+=e.length+1;var r=a.indexOf(";",t);if(r==-1){r=a.length}var i=unescape(a.substring(t,r))}return i};e.IsPC=function(){var e=navigator.userAgent;var a=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];var t=true;for(var r=0;r<a.length;r++){if(e.indexOf(a[r])>0){t=false;break}}return t};e.zhuge=function(e,a,t){};e.dataAnalysis=function(e,a,t,r){if(typeof tracker=="undefined"){if(typeof r==="function"){r.call(null)}return}if(!t){if(r){tracker.track(e,a,r)}else{tracker.track(e,a)}}else{if(a&&a.schoolId)tracker.load(a.schoolId,"amp","应用管理平台");if(r){tracker.identify(e,a,r)}else{tracker.identify(e,a)}}};e.moduleName=function(e){var a="";var t=e.closest("#ampEhallBody");if(t.hasClass("ampLoadActiveFlag")){var r=t.find("article.amp-active").attr("id");if("ampEhallSlideIndex"===r){a="办事大厅-推荐服务"}else if("ampClassifyArticle"===r){a="办事大厅-应用分类查看"}}var i=e.closest("#ampPersonalAsideLeft");if(i.length>0){a="个人中心-左侧边栏-"+i.find("div#ampPersonalAsideLeftNormal").find("div.amp-active").find("span").html()}var n=e.closest(".amp-widget");if(n.length>0){a="个人中心-"+n.children().attr("widget_title")+"卡片"}var s=e.closest("#ampPersonalAsideRight");if(s.length>0){a="个人中心-右侧边栏-周期服务"}var o=e.closest(".amp-aside-apps");if(o.length>0){a="搜索中心-"+o.children("h5").text()}var p=e.closest("#ampServiceRightContent");if(p.length>0){a="搜索中心-应用列表"}return a};AmpUtils.synchronousAppAssess=function(e){var a=$("#iframeList");a.find("iframe").each(function(){var a=$(this);var t=a.attr("src");if(t.indexOf("ehall.html")>0||t.indexOf("serviceCenter.html")>0||t.indexOf("favorite.html")>0||t.indexOf("personalCenter.html")>0){var r=this.contentWindow;var i=r.$("body");var n=i.find("div[data-appid="+e+"]");if(n.length>0){if(t.indexOf("serviceCenter.html")>0){r.fwzxSearchBtn.click()}else if(t.indexOf("ehall.html")>0){r.$("#homeTabList").children().each(function(){var e=$(this);e.removeAttr("data-flag");if(e.hasClass("active")){e.click()}})}else if(t.indexOf("personalCenter.html")>0){n.each(function(){var e=$(this).closest(".my-site-widget");var a=e.attr("data-widget-id");e.find(a).after("<"+a+"></"+a+">").remove()})}else if(t.indexOf("favorite.html")>0){r.favSearchBtn.click()}}}})};e.detectmob=function(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){return true}else{return false}};e.setTeacherSide=function(){var e="";var a=window.location.host;var t=window.location.pathname;if(t.indexOf("indexShell.html")>0){return}var r=t.split("/");var i="";var n="0";var s=false;for(var o=0;o<r.length;o++){if(o==r.length-1){if(AmpUtils.detectmob()){n="1";i+="/index_teacher_phone.html"}else{i+="/index_teacher.html"}s=true}else{if(r[o]!="")i+="/"+r[o]}}if(s){try{AmpDataUtils.setCurrentEnv(n,function(t){if(t.result=="success"){e=a+i;window.location.href=window.location.protocol+"//"+e}})}catch(e){console.log(e.message)}}else{e=a+i;window.location.href=window.location.protocol+"//"+e}return s};e.setXdSide=function(){var e="";var a=window.location.host;var t=window.location.pathname;var r=t.split("/");var i="";var n="0";for(var s=0;s<r.length;s++){if(s==r.length-1){i+="/index_xd.html"}else{if(r[s]!="")i+="/"+r[s]}}e=a+i;window.location.href=window.location.protocol+"//"+e};e.setAmp3Side=function(){var e="";var a=window.location.host;var e=a+AMPConstant.requestPath+"amp3/index.html";window.location.href=window.location.protocol+"//"+e};e.getUserSkinImg=function(){var e=AmpGlobal.currentBgUrl;var a=AmpGlobal.currentLoginBgUrl;if(e&&a){if($("#ampPageBgImg").hasClass("amp-page-img")){$("#ampPageBgImg").css("background-image","url("+e+")")}else{$("#ampPageBgImg").css("background-image","url("+a+")")}}}})(window.AmpUtils=window.AmpUtils||{});(function(e,a){e.eventsListen=function(){t()};function t(){$("body").on("click",function(e){var a=$(e.target||e.srcElement);var t=a.closest(".amp-wf-head-set");var r=$("body");if(t.length===0){r.find(".amp-wf-head.amp-active").removeClass("amp-card-wf-head-keep").removeClass("amp-active");r.find(".amp-wf-setting.amp-active").removeClass("amp-active")}else{r.find(".amp-wf-head.amp-active").each(function(){var e=$(this);if(e.find(".amp-wf-head-set")[0]!==t[0]){e.removeClass("amp-card-wf-head-keep").removeClass("amp-active");e.closest("amp-w-frame").parent().children("amp-w-setting").children(".amp-wf-setting").toggleClass("amp-active")}})}})}e.getDesktopId=function(){return $("#ampDesktopNav").children(".amp-active").attr("amp-desktop-id")}})(window.AmpWidgetCustom=window.AmpWidgetCustom||{});(function(e,a){e.space={searchFilterFlag:false};e.show=function(e){n(e)};e.saveData=function(e){t(e)};function t(e){var a=null;if(e.pcAppCategory){a=i(e.pcAppCategory)}r(a);u();sessionStorage.setItem("allCanUseApps",JSON.stringify(a));var t=e.appFolderList;sessionStorage.setItem("appFolderListData",JSON.stringify(t))}function r(e){var a=d(e);$("#ampPersonalAsideLeftAllCanUseApps").html(a);AmpUtils.niceScrollInit($("#ampPersonalAsideLeftAllCanUseAppsTabContent"));setTimeout(function(){try{$("#ampPersonalAsideLeftAllCanUseApps").find("input").placeholder()}catch(e){}},0)}function i(e){var a={};var t=a.classify=[];var r=a.data={};if(e){var i=e.length;for(var n=0;n<i;n++){var s=e[n];var o=s.categoryId;var p=s.appList.length;s.appCount=p;t.push(o);r[o]=s}}return a}function n(e,a){var t=$("#ampPersonalAsideLeftAllCanUseAppsTabContent");var r=JSON.parse(sessionStorage.getItem("allCanUseApps"));var i=p(r,e,a);t.children('[amp-classify="'+e+'"]').html(i);$("#ampPersonalAsideLeftAllCanUseAppsTabUl").find("li").each(function(){var e=$(this).attr("amp-id");var a=$(this).attr("amp-subid");var t=o(r,e,a);$(this).find(".amp-app-count").text(t)})}function s(){var e="暂无可用应用";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("noAvailableApps")}var a=e;return AmpTemplate.getPersonalEmptyPage(a)}function o(e,t,r){var i=$.trim($("#ampPersonalAsideLeftAllCanUseAppsSearchInput").val());var n=e.data;var s=n[t];var o=s.subCategoryList;var p=[];if(r!=a){for(var l=0;l<o.length;l++){if(o[l].categoryId==r){p=c(o[l].appList,i);break}}}else{if(t=="all"){p=c(s.appList,i)}else{p=c(s,i);var m=[];var d=[];if(p.length==a){m.push(p.appList)}else{if(r==a){if(typeof p[0]=="object"&&isNaN(p[0].length)){for(var l=0;l<p.length;l++){d.push(p[l])}}else{var v=p[0];if(v!=a){if(v.length!=a){for(var f=0;f<v.length;f++){d.push(v[f])}}else{d.push(v)}}for(var l=1;l<p.length;l++){var u=p[l].appList;if(typeof u=="object"&&!isNaN(u.length)){for(var g=0;g<u.length;g++){d.push(u[g])}}}}m.push(d)}}p=C(m)}}var h=p.length;return h}function p(t,r,i){var n=$.trim($("#ampPersonalAsideLeftAllCanUseAppsSearchInput").val());var o=t.data;var p=o[r];var d={};if(i!==a){var v=p.subCategoryList;var f={};for(var u=0;u<v.length;u++){if(v[u].categoryId===i){f=v[u].appList}}d=c(f,n)}else{if(r=="all"){d=c(p.appList,n)}else{d=c(p,n)}}if(n==""){e.space.searchFilterFlag=false}if(!e.space.searchFilterFlag){if(r=="all"){var g=JSON.parse(sessionStorage.getItem("appFolderListData"));var h=g.length;if(h>0){d=d.concat(g);A(g)}}}var C=d.length;if(C===0){return s(d)}var k="";if(r=="all"||i!=a){k=l(d)}else{if(d.appList!=a){k=l(d.appList)}else{if(d.length==1&&typeof d[0].appList=="undefined"){k=l(d)}else{var b=false;for(var u=0;u<d.length;u++){if(d[u].appList!=a){b=true;break}}if(!b){k=l(d)}else{k=m(d)}}}}return k}function l(e){var t="";var r=e.length;var i=$("#tpl-app-single-canUseApp").html();for(var n=0;n<r;n++){var s="";var o=e[n];var p=o.middleIcon;var l=o.appName;var m=AmpUtils.assemblyAppAttributesToStr(o);if(o.appPc!=a&&o.appPc!=null){if(o.appPc.isEnableDescription){s=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",m)}}if(o.type){s=""}t+=i.replace("@attributes",m).replace("@img",p).replace("@title",l).replace("@iShowIconHtml",s).replace("@appBelongFlag","canUseAppFlag").replace("@top","2").replace("@dragAppFlag","")}return t}function m(e){var t="";var r="";var i="";var n="";var s=$("#tpl-app-single-canUseApp").html();var o=e.length;for(var p=0;p<o;p++){var l=e[p];if(l.appList==a){if(typeof l=="object"&&isNaN(e[0].length)){var m=l.middleIcon;var c=l.appName;var d=AmpUtils.assemblyAppAttributesToStr(l);if(l.appPc!=a){if(l.appPc.isEnableDescription){t=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",d)}}if(l.type){t=""}n+=s.replace("@attributes",d).replace("@img",m).replace("@title",c).replace("@iShowIconHtml",t).replace("@appBelongFlag","canUseAppFlag").replace("@top","2").replace("@dragAppFlag","")}else{for(var v=0;v<l.length;v++){var m=l[v].middleIcon;var c=l[v].appName;var d=AmpUtils.assemblyAppAttributesToStr(l[v]);if(l[v].appPc!=a){if(l[v].appPc.isEnableDescription){t=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",d)}}if(l.type){t=""}n+=s.replace("@attributes",d).replace("@img",m).replace("@title",c).replace("@iShowIconHtml",t).replace("@appBelongFlag","canUseAppFlag").replace("@top","2").replace("@dragAppFlag","")}}}else{var f=l.categoryName;var u=l.categoryId;var g=l.appList;var h="";for(var A=0;A<g.length;A++){var m=g[A].middleIcon;var c=g[A].appName;var d=AmpUtils.assemblyAppAttributesToStr(g[A]);if(g[A].appPc!=a){if(g[A].appPc.isEnableDescription){t=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",d)}}if(l.type){t=""}h+=s.replace("@attributes",d).replace("@img",m).replace("@title",c).replace("@iShowIconHtml",t).replace("@top","8").replace("@dragAppFlag","")}i+=AmpTemplate.getCanUseAppGroup().replace("@subCategoryName",f).replace("@canUseAppListHtml",h)}}r=n+i;return r}function c(e,t){var r=new RegExp(t);var i=[];if(!t){if(e.subCategoryList!==a&&e.subCategoryList!==null&&e.subCategoryList.length>0){i.push(e.appList);for(var n=0;n<e.subCategoryList.length;n++){i.push(e.subCategoryList[n])}}else{i=e}}else{if(e.subCategoryList!==a&&e.subCategoryList!==null&&e.subCategoryList.length>0){var s=e.appList.length;var o=[];for(var n=0;n<s;n++){var p=e.appList[n];var l=p.appName;if(r.test(l)){i.push(p)}}for(var n=0;n<e.subCategoryList.length;n++){var p=e.subCategoryList[n];var m=p.appList;var c=[];for(var d=0;d<m.length;d++){var v=m[d];var l=m[d].appName;if(r.test(l)){c.push(v)}}if(c.length>0){p.appList=c;i.push(p)}}}else{var s=e.length;if(s==a){e=e.appList;s=e.length}for(var n=0;n<s;n++){var p=e[n];var l=p.appName;if(r.test(l)){i.push(p)}}}}return i}function d(e){if(!e){return s()}var a=e.classify;var t=e.data;var r=a.length;var i="";var n="";var o=AmpTemplate.getCategoryTabHeadItemTplHtml();var p=$("#tpl-canUseApp-tab-content-item").html();var l={};for(var m=0;m<r;m++){var c=a[m];var d=t[c];var v=d.categoryName;var f="";var u=d.appCount;var g="";var h="";var A="";h=d.subCategoryList!=null&&d.subCategoryList.length>0?"hasSubCategory":"";A=d.subCategoryList!=null&&d.subCategoryList.length>0?"closeSubCategory":"";i+=o.replace("@id",c).replace("@name",v).replace("@customClass",f).replace("@hasUnReadMarkClass",g).replace("@appCount",u).replace("@hasSubCategoryFlag",h).replace("@subCategoryState",A).replace("@titleName",v);if(c!="all"){l=d.subCategoryList;if(l!=null){var C=l.length;for(var k=0;k<C;k++){var b=l[k];i+=$("#tpl-sub-category-tab-head-item").html().replace("@id",c).replace("@subId",b.categoryId).replace("@name",b.categoryName).replace("@appCount",b.appList.length)}}}n+=p.replace("@customClass","").replace("@classify",c).replace("@content","").replace("@id","")}var S="搜索可用服务";if(AmpGlobal.currentLang=="en_US"){S=$.i18n("searchAvailableServices")}var y=$("#tpl-canUseApp-tab").html().replace("@header",i).replace("@content",n).replace("@searchAvailableServices",S);return y}function v(e){var a=new Object;var t=[];var r=false;var i="全部";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("all")}a.categoryName=i;a.categoryId="all";if(e){var n={};var s=e.length;for(var o=0;o<s;o++){f(n,e[o].appList);if(e[o].hasUnReadMark){r=true}}for(var p in n){var l=n[p];t.push(l)}a.appList=t;if(r){a.hasUnReadMark=true}}return a}function f(e,a){var t=a.length;for(var r=0;r<t;r++){var i=a[r];var n=i.appId;e[n]=i}}function u(){var a=$("#ampPersonalAsideLeftAllCanUseApps");a.on("click","li",function(){g($(this))});a.on("click",".icon-wenti1",function(e){AmpDetail.open($(this).closest(".appFlag"));e.stopPropagation()});$("#ampPersonalAsideLeftAllCanUseAppsSearchIcon").on("click",function(){e.space.searchFilterFlag=true;h()});$("#ampPersonalAsideLeftAllCanUseAppsSearchInput").on("keyup",function(a){if(a.keyCode===13){e.space.searchFilterFlag=true;$("#ampPersonalAsideleftCanuseappDelete").css("display","block");h();var t=$.trim($("#ampPersonalAsideLeftAllCanUseAppsSearchInput").val());if(t)AmpUtils.zhuge("搜索可用应用",{"关键字":t})}});$("#ampPersonalAsideLeftAllCanUseAppsDeleteIcon").on("click",function(a){$("#ampPersonalAsideLeftAllCanUseAppsSearchInput").val("");$(this).parent().css("display","none");e.space.searchFilterFlag=false;h()})}function g(e){if(e.hasClass("amp-active")){return}var a=$("#ampPersonalAsideLeftAllCanUseApps");var t=a.find("li.openSubCategory");if(!e.hasClass("amp-canuseapp-sub-category")&&t.length>0){b(t);t.removeClass("openSubCategory").addClass("closeSubCategory")}if(e.hasClass("hasSubCategory")){if(e.hasClass("closeSubCategory")){k(e);e.removeClass("closeSubCategory").addClass("openSubCategory")}else{b(e);e.removeClass("openSubCategory").addClass("closeSubCategory")}}e.siblings(".amp-active").removeClass("amp-active");e.addClass("amp-active");var r=e.attr("amp-id");var i=e.attr("amp-subid");var s=$("#ampPersonalAsideLeftAllCanUseAppsTabContent");s.children(".amp-category-content-item").addClass("amp-hide");s.children('[amp-classify="'+r+'"]').removeClass("amp-hide");n(r,i)}function h(){var e=$("#ampPersonalAsideLeftAllCanUseAppsTabUl").children(".amp-active").attr("amp-id");n(e)}function A(e){var e=e;var a=e.length;for(var t=0;t<a;t++){var r=e[t].appId;AmpDataUtils.space.folderData[r]=e[t]}}function C(e){var t=[];var r=e.length;for(var i=0;i<r;i++){var n=e[i];if(n.appList==a){for(var s=0;s<n.length;s++){var o=n[s];t.push(o)}}else{for(var p=0;p<n.appList.length;p++){var o=n.appList[p];t.push(o)}}}var l={};var m=[];f(l,t);for(var c in l){var d=l[c];m.push(d)}return m}function k(e){var e=e;var a=e.attr("amp-id");var t=$("#ampPersonalAsideLeftAllCanUseAppsTabUl");var r=t.find(".amp-canuseapp-sub-category[amp-id="+a+"]");t.find("li.amp-canuseapp-sub-category").addClass("amp-hide");r.each(function(e){var a=$(this);setTimeout(function(){a.removeClass("amp-hide")},0)})}function b(e){var e=e;var a=e.attr("amp-id");var t=$("#ampPersonalAsideLeftAllCanUseAppsTabUl").find(".amp-canuseapp-sub-category[amp-id="+a+"]");var r=t.length;t.each(function(e){var a=$(this);setTimeout(function(){a.addClass("amp-hide")},0)})}})(window.AmpCanUseApps=window.AmpCanUseApps||{});(function(e,a){e.show=function(e){f(e)};e.saveData=function(e){t(e)};function t(e){var a=null;if(e.pcCardCategory){a=l(e.pcCardCategory)}r(a);d();sessionStorage.setItem("canUseCardsData",JSON.stringify(a));AmpUtils.setIe9PlaceHolder()}function r(e){var a=n(e);$("#ampPersonalAsideLeftCanUseCards").html(a);if(!i()){AmpPersonalCenter.showCanUseCardEmptyPage()}}function i(){var e=false;var a=$("#ampDesktopNav");var t=a.find(".amp-tab-item").filter("[amp-desktop-id]").length;if(t>0){e=true}return e}function n(e){if(!e){return p()}var a=e.data;var t=a.length;var r=s(a);if(r){var i='<span class="amp-admin-new-desktopnav"></span>';$('.amp-tab-item[amp-id="canUseCards"]').append(i);$('.amp-aside-box-mini-item[amp-id="canUseCards"]').addClass("amp-left-top")}var n="";var l="";var m=true;for(var c in a){var d=a[c];var v=!m?"":"amp-active";var f=d.hasUnReadMark;var u=f?"tabhasUnReadMark":"";var g=o(d);l+=AmpTemplate.getCategoryTabHeadItemHtml({id:c,name:d.categoryName,customClass:v,hasUnReadMarkClass:u,appCount:g});var h=d.appList;var A="";var C=[];$.each(h,function(e,a){var t=a.appPcCardList;if(!t){return}var r=a.middleIcon;$.each(t,function(e,a){a.middleIcon=r;C.push(a)})});A+=AmpPersonalCenter.getCanUseAppsHtml(C,"complex");var k=!m?"amp-hide":"";n+=AmpTemplate.getCategoryTabContentItemHtml({id:"ampCategoryContentCanUseItem"+c,content:A,customClass:k,key:c});m=false}var b="canUseTabListId";var S=AmpTemplate.getCategoryTabHtml({header:l,content:n,tabUlId:b});return S}function s(e){var a=false;$.each(e,function(e,t){if(t.hasUnReadMark){a=true;return false}});return a}function o(e){var a=0;var t=e.appList;appListLen=t.length;if(appListLen>0){for(var r in t){if(t[r].appPcCardList){a+=t[r].appPcCardList.length}}}return a}function p(){var e="暂无可用卡片";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("noAvailableCards")}var a=e;return AmpTemplate.getPersonalEmptyPage(a)}function l(e){var a={};var t=a.classify=[];var r=a.data={};if(e){e.splice(0,0,m(e));var i=e.length;for(var n=0;n<i;n++){var s=e[n];var o=s.categoryId;var p=s.appList.length;s.appCount=p;t.push(o);r[o]=s}}return a}function m(e){var a=new Object;var t=[];var r=false;var i="全部";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("all")}a.categoryName=i;a.categoryId="all";if(e){var n={};var s=e.length;for(var o=0;o<s;o++){c(n,e[o].appList);if(e[o].hasUnReadMark){r=true}}for(var p in n){var l=n[p];t.push(l)}a.appList=t;if(r){a.hasUnReadMark=true}}return a}function c(e,a){var t=a.length;for(var r=0;r<t;r++){var i=a[r];var n=i.appId;e[n]=i}}function d(){var e=$("#ampPersonalAsideLeftCanUseCards");$("#ampPersonalAsideLeftAllCanUseCardsSearchIcon").on("click",function(){v()});$("#ampPersonalAsideLeftAllCanUseCardsSearchInput").on("keyup",function(e){if(e.keyCode===13){$("#ampPersonalAsideleftCanusecardDelete").css("display","block");v();var a=$.trim($("#ampPersonalAsideLeftAllCanUseCardsSearchInput").val());if(a)AmpUtils.zhuge("搜索可用卡片",{"关键字":a})}});$("#ampPersonalAsideLeftAllCanUseCardsDeleteIcon").on("click",function(e){$("#ampPersonalAsideLeftAllCanUseCardsSearchInput").val("");$(this).parent().css("display","none");v()})}e.cardtabChange=function(e){if(e.hasClass("amp-active")){return}e.siblings(".amp-active").removeClass("amp-active");e.addClass("amp-active");var a=e.attr("amp-id");var t=$("#ampCategoryTabContent");t.children(".amp-category-content-item").addClass("amp-hide");t.children('[amp-id="'+a+'"]').removeClass("amp-hide");f(a)};function v(){var e=$("#canUseTabListId").children(".amp-active").attr("amp-id");f(e)}function f(e){var a=$("#ampCategoryTabContent");var t=JSON.parse(sessionStorage.getItem("canUseCardsData"));var r=g(t,e);a.children('[amp-id="'+e+'"]').html(r);$("#canUseTabListId").find("li").each(function(){var e=$(this).attr("amp-id");var a=u(t,e);$(this).find(".amp-app-count").text(a)})}function u(e,a){var t=$.trim($("#ampPersonalAsideLeftAllCanUseCardsSearchInput").val());var r=e.data;var i=r[a];var n=h(i.appList,t);var s=n.length;return s}function g(e,a){var t=$.trim($("#ampPersonalAsideLeftAllCanUseCardsSearchInput").val());var r=e.data;var i=r[a];var n=h(i.appList,t);var s=n.length;if(s===0){return p()}var o="";var l=[];$.each(n,function(e,a){var t=a.appPcCardList;if(!t){return}var r=a.middleIcon;$.each(t,function(e,a){a.middleIcon=r;l.push(a)})});o+=AmpPersonalCenter.getCanUseAppsHtml(l,"complex");return o}function h(e,a){var t=new RegExp(a);var r=[];if(!a){r=e}else{var i=e.length;for(var n=0;n<i;n++){var s=e[n];var o=s.appName;if(t.test(o)){r.push(s)}}}return r}})(window.AmpCanUseCard=window.AmpCanUseCard||{});(function(e,a){$("#ampPersonalAsideLeftMini").on("click",".amp-aside-box-mini-item",function(){localStorage.leftAsideOpenFlag="1";AmpPersonalCenter.setCustomDesktopCenter("left","normal");t($(this));var e=1e3;setTimeout(function(){r();if(AmpGlobal.platformType!="0"){AmpPersonalCenter.showRecommendCrad();AmpPersonalCenter.setCreateDesktopPosition();AmpPersonalCenter.initSortingCards()}AmpPersonalCenter.setDesktopBlurHtm();AmpPersonalCenter.showAdminNewDesktop()},e);AmpUtils.setIe9PlaceHolder()});$("#ampPersonalAsideLeftClose").on("click",function(){localStorage.leftAsideOpenFlag="0";AmpUtils.setIe9PlaceHolder();if(navigator.userAgent.indexOf("MSIE 9.0")>0){setTimeout(function(){AmpPersonalCenter.setCustomDesktopCenter("left","mini")},450)}else{AmpPersonalCenter.setCustomDesktopCenter("left","mini")}var e=1e3;setTimeout(function(){setTimeout(function(){var e=$("#ampTabContentItem0");if(e.find(".recommedCard").length>0){var a=e.find(".recommedCard:first").offset().top;$("#ampDesktopContent").animate({scrollTop:a-240},300)}},200);if(AmpGlobal.platformType!="0"){AmpPersonalCenter.showRecommendCrad();AmpPersonalCenter.setCreateDesktopPosition();AmpPersonalCenter.initSortingCards()}AmpPersonalCenter.setDesktopBlurHtm();AmpPersonalCenter.showAdminNewDesktop()},e);AmpPersonalCenter.setPcDesktopToolAddOrDrag(true)});function t(e){var a=e.attr("amp-id");$("#ampPersonalAsideLeftMini").find(".amp-active").removeClass("amp-active");var t=$("#ampPersonalAsideLeftTabHead").find('[amp-id="'+a+'"]');AmpPersonalCenter.asideLeftTabChange(t)}function r(){var e=416;var a=$("#ampDesktopContent").offset().left;var t=$("#ampDesktopNav").css("padding-left");var r=$("#ampPersonalAsideLeftTabContent");var i=$("#ampPersonalAsideLeftTabHead");var n=$("#ampPersonalAsideLeftClose");var s=parseInt(e);var o=parseInt(a)+parseInt(t);if(o<s){r.addClass("amp-aside-covered-bg");i.find(".amp-tab-item").addClass("amp-aside-covered-bg");n.addClass("amp-aside-covered-bg")}else{r.removeClass("amp-aside-covered-bg");i.find(".amp-tab-item").removeClass("amp-aside-covered-bg");n.removeClass("amp-aside-covered-bg")}}})(window.AmpPersonalLeftAside=window.AmpPersonalLeftAside||{});(function(e,a){var t=null;e.space={lazyComplete:true,login:false};p();r();n();e.show=function(){i(0)};e.refresh=function(){i()};function r(){var a=60;var r=+a*1e4*6;function o(){i(0,function(a){if(a.result=="success"&&a.hasLogin){$("#ampTagMessages").empty();s(a);e.space.lazyComplete=true}else{clearTimeout(t)}});n();if(typeof AMPConfigure.messageDataRefreshEnable!="undefined"&&AMPConfigure.messageDataRefreshEnable){t=setTimeout(o,r)}}if(typeof AMPConfigure.messageDataRefreshEnable!="undefined"&&AMPConfigure.messageDataRefreshEnable){t=setTimeout(o,r)}}function i(a,t){e.space.lazyComplete=false;var r={};r.typeName="未读消息";r.start=a;var i=t||function(a){if(a.result=="success"&&a.hasLogin){s(a);e.space.lazyComplete=true}};AmpDataUtils.getTagsMessages(r,i)}function n(){AmpDataUtils.getAsideWidgetsDataOfUnreadMessage(function(e){if(e.result=="success"){if(e.taskSideMessageBiz.appId==null){messageCount=e.taskSideMessageBiz.totalSize;if(messageCount&&messageCount!="0"){$("#ampMessageTaskCount").addClass("amp-task-count-bg").text(messageCount);$("#messageSumCount").text(messageCount);$('#ampPersonalAsideRightTabHead [amp-id="message"]').find(".amp-red-corner").removeClass("amp-hide")}else{$("#messageSumCount").text("0")}}}})}function s(e){var a=$("#ampTagMessages");var t=e.data;var r=t.children;var i=t.count;if(i){$("#ampMessageTaskCount").text(i)}var n="";if(r.length===0){f();if(a.children(".amp-message-item").length===0){n=o()}}else{n=u(r)}if(a.children(".amp-personal-empty-page").length>0){a.html(n)}else{a.append(n)}$("#ampTagMessages").off("click",".amp-feedback-message").on("click",".amp-feedback-message",function(){window.open(AMPConstant.requestPath+"new/indexShell.html?portal/html/myFeedback/feedback.html")});$("#ampTagMessages").off("click",".amp-normal-message").on("click",".amp-normal-message",function(){var e=$(this).attr("amp-typeid");window.open(AMPConstant.requestPath+"new/portal/html/message/scenes_message_center.html?typeId="+e)});$("#ampTagMessages").off("click",".amp-assess-message").on("click",".amp-assess-message",function(){var e=$(this);var a=e.attr("amp-url");var t=e.attr("amp-appid");var r=e.attr("amp-hashead");var i=e.attr("amp-appname");var n=e.attr("amp-isthirdparty");if(!(t&&i&&r&&n&&a)){return}if(r=="1"){if(n=="1"){var s="thirdAppIndexShell.html";localStorage.isthirdpartyUrl=a;localStorage.isthirdpartyAppId=t;window.open(s)}else{if(a.indexOf("http")===-1&&a.indexOf("//")===-1){a=AMPConstant.requestPath+a}window.open(a)}}else{var o=AMPConstant.requestPath+"new/indexShell.html";localStorage.openHasNoHeadAppUrl=a;localStorage.openHasNoHeadAppId=t;localStorage.openHasNoHead="0";localStorage.openHasNoHeadTitle=i;localStorage.isthirdparty=n;window.open(o)}});AmpUtils.setScroll(a,1)}function o(){var e="暂无未读消息";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("noUnreadMessages")}return AmpTemplate.getPersonalEmptyPage(e)}function p(){v();var e=$("#ampTagMessages");e.on("click",".amp-arrow",function(e){m($(this).closest(".amp-message-item").children(".amp-message-description"));e.stopPropagation()});e.on("click",".icon-chacha, .amp-message-item",function(e){l($(this).closest(".amp-message-item"));e.stopPropagation()});$("#ampPersonalMessageHeader").on("click","span",function(){var e=$(this).attr("amp-type");if(e==="allRead"){f();g()}else{A();AmpUtils.zhuge("查看消息中心",{"来源":"个人中心-右侧边栏-点上方的消息栏目时触发"})}})}function l(e){$clickItem=e;var a=$clickItem.attr("amp-message-id");var t=$("#ampMessageTaskCount");AmpDataUtils.setMsgsRead(a,function(a){if(a.result=="success"){var r=$("#messageSumCount");var i=r.text();r.text(parseInt(i)-1);if(!(parseInt(i)-1)){$('.amp-tab-item[amp-id="message"]').find(".amp-red-corner").removeClass("amp-red-corner")}var n=parseInt(t.text())-1;if(!n){$("#ampMessageTaskCount").removeClass("amp-task-count-bg");t.text("")}else{t.text(n)}e.addClass("amp-animate-move-right-out");setTimeout(function(){e.remove()},AmpGlobal.animateTimes)}})}function m(e){var a=c(e);if(a==="init"){setTimeout(function(){d(e)},10)}else{d(e)}}function c(e){var a="hasInit";if(!e.attr("small-height")){a="init";var t=e.children(".amp-message-small");var r=e.children(".amp-message-full");var i=t.outerHeight();var n=r.outerHeight();e.css({height:i+"px"}).attr("small-height",i+"px").attr("full-height",n+"px")}return a}function d(e){var a=e.closest(".amp-message-item");if(a.hasClass("amp-show-full")){var t=e.attr("small-height");e.css({height:t});setTimeout(function(){a.removeClass("amp-show-full")},AmpGlobal.animateTimes)}else{var r=e.attr("full-height");e.css({height:r});a.addClass("amp-show-full")}}function v(){$("#ampTagMessages").on("scroll",function(){var a=$(this),t=a.height(),r=a.get(0).scrollHeight,n=a.scrollTop();if(r-t-n-45<=0){var s=a.children().length;if(e.space.lazyComplete){i(s)}}})}function f(){$("#ampTagMessages").off("scroll")}function u(e){var a="";var t=e.length;for(var r=0;r<t;r++){a+=AmpTemplate.getTagsMessages(e[r])}return a}function g(){var e=$("#ampTagMessages");var a=window.innerHeight;var t=e.offset().top;e.getNiceScroll().hide();var r=[];e.children(".amp-message-item").each(function(e){var i=$(this);var n=i.offset().top;var s=i.outerHeight();var o=n+s;if(o>=t&&n<=a){r.unshift(i)}});var i=r.length;var n=100;for(var s=0;s<i;s++){var p=r[s];h(p,s,n)}setTimeout(function(){AmpDataUtils.setAllTagMsgsRead(function(a){if(a.result=="success"){var t=$("#messageSumCount");t.text(0);var r=o();e.html(r);e.getNiceScroll().show()}})},n*i+AmpGlobal.animateTimes)}function h(e,a,t){setTimeout(function(){e.addClass("amp-animate-move-right-out")},a*t)}function A(){window.open("portal/html/message/scenes_message_center.html")}})(window.AmpMessage=window.AmpMessage||{});(function(e,a){e.space={dragFolderId:"",dragingFlag:false,elLeftSort:"",elRightSort:""};e.initMyFavoriteApps=function(a){sessionStorage.setItem("myFavoriteAppsData",JSON.stringify(a));e.initMyFavApps();t();AmpUtils.niceScrollInit($("#ampMyFavoriteCategoryTabContent"))};e.removeCreateFolderDialog=function(a){var t=$("#ampMyFavoriteCreateFolder");if(t.length>0){t.remove();if(a.closest("li.amp-hover-slow-motion").length<1){e.favTabChange($("#myFavoriteTabListId").find('li[amp-id="0"]'))}}};function t(){var a=$("#ampPersonalAsideLeftMyFavorite");a.off("click").on("click","li",function(){var a=$(this).attr("amp-id");if(a=="favoriteset"){c($(this))}else{if($(this).hasClass("amp-hide")){e.favTabChange($("#myFavoriteTabListId").find('li[amp-id="0"]'))}else{e.favTabChange($(this))}}});a.on("click",".amp-app-delete",function(e){var a=$(e.target||e.srcElement);var t=a.closest("li");t.addClass("amp-hide");t.attr("amp-folder-delete","true");t.find(".amp-app-operate").addClass("amp-hide")});a.on("click",".amp-app-operateBtn",function(e){var a=$(e.target||e.srcElement);var t=a.closest("li");t.find(".amp-app-operate").removeClass("amp-hide");t.siblings("li").find(".amp-app-operate").addClass("amp-hide")});a.on("click",".amp-app-rename",function(e){var a=$(e.target||e.srcElement);var t=a.closest("li");if($("#ampAdminNewFolderName").length==0){var r=t.find(".amp-left-aside-canuseapp-name").text();var i=t.attr("amp-id");var n=AmpTemplate.createFolderNameDialogHtm(r,i);$("#ampPersonalAsideLeftMyFavorite").append(n);t.find(".amp-app-operate").addClass("amp-hide")}});$("body").on("click",".amp-favorite-icon-jia",function(){$("#ampPageHeaderSearch").click()});a.on("click",".amp-create-foldername-btn-save",function(e){var a=$(e.target||e.srcElement);var t=a.closest(".amp-create-folderName").attr("folderId");r(t)});a.on("click",".amp-create-foldername-btn-cancel",function(e){i()})}function r(e){var a=$("#ampCreateFolderNameInput").val();a=$.trim(a);var t=$("#myFavoriteTabListId");var r=t.find('li[amp-id="'+e+'"]');var n=r.find(".amp-left-aside-canuseapp-name");if(a){n.attr("amp-old-folderName",n.text());r.attr("amp-folderName-edit","true");n.text(a);i()}else{var s="请输入重命名文件夹名称";if(AmpGlobal.currentLang=="en_US"){s=$.i18n("enterFolderName")}AmpPrompt.show({content:s});return}}function i(){$("#ampAdminNewFolderName").remove()}function n(){var t="请移动到正确的目标文件夹";var r="归入文件夹成功";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("moveCorrectFolder");r=$.i18n("belongToFolderSuccess")}var i=$("#ampPersonalAsideLeftMyFavorite");if(navigator.userAgent.indexOf("MSIE")>=0){$("#myFavoriteTabListId").mouseenter(function(r){var n=$(r.target||r.srcElement);var s=n.closest("li");var o=$("#myFavoriteTabListId");var p=o.find("li.amp-active");var l=s.attr("amp-id");s.addClass("amp-drag-active");if(e.space.dragingFlag&&l!=a&&l!=""&&i.hasClass("isEditState")){if(s.hasClass("amp-drag-active")){e.space.dragFolderId=l;e.space.dragingFlag=false;setTimeout(function(){s.removeClass("amp-drag-active")},1e3);if(l==p.attr("amp-id")||l=="create"){AmpPrompt.show({content:t})}}}s.removeClass("amp-drag-active")})}else{$("#myFavoriteTabListId").mouseup(function(a){var r=$(a.target||a.srcElement);var n=r.closest("li");var s=$("#myFavoriteTabListId");var o=s.find("li.amp-active");var p=n.attr("amp-id");console.log(e.space.dragingFlag);if(navigator.userAgent.indexOf("MSIE 9.0")>0){n.addClass("amp-drag-active")}if(e.space.dragingFlag&&i.hasClass("isEditState")){if(n.hasClass("amp-drag-active")){setTimeout(function(){n.removeClass("amp-drag-active")},1e3);if(p==o.attr("amp-id")||p=="create"){AmpPrompt.show({content:t})}e.space.dragFolderId=p;e.space.dragingFlag=false}}if(navigator.userAgent.indexOf("MSIE 9.0")>0){n.removeClass("amp-drag-active")}});$("#myFavoriteTabListId .amp-favorite-edit").hover(function(){$(this).addClass("amp-drag-active")},function(){$(this).removeClass("amp-drag-active")})}}e.initMyFavApps=function(){var e=s();var a="整理";var t="保存";var r="取消";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("organize");t=$.i18n("save");r=$.i18n("cancel")}var i=$("#tpl-myfavorite-set").html().replace("@organize",a).replace("@save",t).replace("@cancel",r);$("#ampPersonalAsideLeftMyFavorite").html(e+i)};function s(){var e=JSON.parse(sessionStorage.getItem("myFavoriteAppsData"));var a=e.userFavFolders;var t=a.length;var r=e.searchResult;var i="";var n="";var s={};s.searchApps=r;s.userFavFolders=a;var o=p(s);n=o.classifyHtml;i=o.contentsHtml;if(t>0){for(var l=0;l<t;l++){var m=a[l];s.folderList=m;var c=p(s);n+=c.classifyHtml;i+=c.contentsHtml}}var d="新建文件夹";if(AmpGlobal.currentLang=="en_US"){d=$.i18n("createNewFolder")}n+=$("#tpl-myfavorite-create-folder").html().replace("@createNewFolder",d).replace("@titleName",d);i+=AmpTemplate.getMyFavoriteCategoryTabContentItemHtml({id:"ampCategoryContentMyFavoriteItem"+"create",content:"",customClass:"",key:"create"});var v="myFavoriteTabListId";var f=AmpTemplate.geMyfavoriteTabHtml({header:n,content:i,tabUlId:v});return f}e.favTabChange=function(e){if(e.hasClass("amp-active")){return}var a=$("#ampMyFavoriteCreateFolder");if(a.length>0){$("#ampMyFavoriteCreateFolder").remove()}if(e.attr("amp-id")=="create"){var t=$("#myFavoriteTabListId").find('li[amp-folder="true"]').length;if(t>9){AmpPrompt.show({content:$.i18n("folderOutOfLimit")});return}else{o()}}e.siblings(".amp-active").removeClass("amp-active");e.addClass("amp-active");var r=e.attr("amp-id");var i=$("#ampMyFavoriteCategoryTabContent");i.children(".amp-category-content-item").addClass("amp-hide").removeClass("amp-active");i.children('[amp-classify="'+r+'"]').removeClass("amp-hide");g()};function o(){var e="新建文件夹";var a="新建文件夹";var t="文件夹可以放置您需要放置的应用";var r="确定";var i="取消";var n="5";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("createNewFolder");a=$.i18n("newFolder");t=$.i18n("folderCan");r=$.i18n("confirm");i=$.i18n("cancel");n=$.i18n("folderLength")}var s=$("#tpl-myfavorite-create-folder-page").html().replace("@createNewFolder",e).replace("@newFolder",a).replace("@folderCan",t).replace("@confirm",r).replace("@cancel",i).replace("@folderLength",n);$("body").append(s);var o=$("#ampMyFavoriteCreateFolder");var p=$("#ampPersonalAsideLeftMyFavorite").find('li[amp-id="create"]').offset();o.css({left:"120px",top:"108px"})}e.saveFolder=function(){var e=$("#ampFolderInput").val();e=$.trim(e);var a={};if(e){var t=encodeURI(e);AmpDataUtils.saveUserFavFolder(t,function(t){var r="新建文件夹成功";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("creatFolderSuccess")}AmpPrompt.show({content:r});a.folderName=e;a.folderId=t.folderId;m(a);AmpOpenFavorite.favoriteCardSyncAddNewFolder(a);AmpUtils.zhuge("新建收藏文件夹",{"文件夹名称":e})})}else{var r="请输入文件夹名称";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("enterFolderName")}AmpPrompt.show({content:r});return}};function p(e){var t=e.searchApps;var r=e.folderList;var i=e.userFavFolders;var n=t;var s=n.length;var o="";var p="";var m="";var e={};var c="";var d="";var v=0;var f="";var u="";var g=false;var h="amp-active";var A="重命名";if(AmpGlobal.currentLang=="en_US"){A=$.i18n("rename")}var C="删除";if(AmpGlobal.currentLang=="en_US"){C=$.i18n("delete")}if(r==a){var k=[];for(var b=0;b<t.length;b++){if(t[b].favoriteFolderId=="0"){k.push(t[b])}}v=t.length;c="0";d="收藏夹";if(AmpGlobal.currentLang=="en_US"){d=$.i18n("favorite")}f="amp-active";u="amp-active";m=I(t,i)}else{c=r.wid;d=r.folderName;f="";u="amp-hide";g=true;var S=[];for(var y=0;y<s;y++){if(t[y].favoriteFolderId==c){S.push(t[y])}}v=S==a?0:S.length;m=l(S,true,true)}h=g?"amp-active":"amp-hide";p+=$("#tpl-myfavorite-app-tab-item").html().replace("@id",c).replace("@name",d).replace("@titleName",d).replace("@appCount",v).replace("@activeClass",f).replace("@ampFavoriteType",g).replace("@showiconFlag",h).replace("@rename",A).replace("@delete",C);o+=AmpTemplate.getMyFavoriteCategoryTabContentItemHtml({id:"ampCategoryContentMyFavoriteItem"+c,content:m,customClass:u,key:c});e.classifyHtml=p;e.contentsHtml=o;return e}function l(e,t,r){var i="";var n=e==a?0:e.length;var s=$("#tpl-app-single-canUseApp").html();var o="";if(r){o=$("#tpl-app-single-myfaviriteDragApp").html()}if(n){for(var p=0;p<n;p++){var l="";var m=e[p];var c=m.middleIcon;var d=m.appName;var v=AmpUtils.assemblyAppAttributesToStr(m);if(m.type){P(m)}if(m.appPc!=a&&m.appPc!=null){if(m.appPc.isEnableDescription){l=$("#tpl-single-hover-app-card-i-icon").html().replace("@attributedesc",v)}}if(m.type){l=""}i+=s.replace("@attributes",v).replace("@img",c).replace("@title",d).replace("@iShowIconHtml",l).replace("@appBelongFlag","myFavoriteFlag").replace("@dragAppFlag",o)}}var f="添加应用";if(AmpGlobal.currentLang=="en_US"){f=$.i18n("addApps")}if(t){i+=$("#tpl-favorite-tool").html().replace("@addApps",f)}return i}function m(e){var a=e.folderId;var t=e.folderName;var r="";var i="";var n="";var s="添加应用";if(AmpGlobal.currentLang=="en_US"){s=$.i18n("addApps")}n=$("#tpl-favorite-tool").html().replace("@addApps",s);var o="重命名";if(AmpGlobal.currentLang=="en_US"){o=$.i18n("rename")}var p="删除";if(AmpGlobal.currentLang=="en_US"){p=$.i18n("delete")}r=$("#tpl-myfavorite-app-tab-item").html().replace("@activeClass","amp-active").replace("@id",a).replace("@name",t).replace("@titleName",t).replace("@appCount",0).replace("@ampFavoriteType",true).replace("@showiconFlag","amp-active").replace("@rename",o).replace("@delete",p);i=AmpTemplate.getMyFavoriteCategoryTabContentItemHtml({id:"ampCategoryContentMyFavoriteItem"+a,content:n,customClass:"amp-active",key:a});$("#ampPersonalAsideLeftMyFavorite").find('li[amp-id="create"]').removeClass("amp-active").before(r);$("#ampMyFavoriteCategoryTabContent").find('div[amp-classify="create"]').removeClass("amp-active").before(i);$("#ampMyFavoriteCreateFolder").remove()}function c(e){var a=$("#ampPersonalAsideLeftMyFavorite");var t=$("#ampMyfavoriteSetBtn");var r=a.find("li[amp-folder=true]");var i=$("#myFavoriteTabListId");var n=r.find(".amp-app-count");var s=r.find(".amp-app-operateBtn");k(true);w(true);if(e.hasClass("favoriteArrangeFlag")){s.removeClass("amp-hide");n.addClass("amp-hide");e.addClass("amp-hide").siblings("li").removeClass("amp-hide");a.addClass("isEditState");i.find("li").addClass("amp-favorite-edit");g();k(false)}else if(e.hasClass("favoriteCancelFlag")){u("cancle");C();w(false);d()}else if(e.hasClass("favoriteSaveFlag")){f();C();w(false)}}function d(){var e=$("#myFavoriteTabListId");var a=e.find('li[amp-folderName-edit="true"]');$.each(a,function(e){var a=$(this);var t=a.find(".amp-left-aside-canuseapp-name");var r=t.attr("amp-old-foldername");t.text(r);a.removeAttr("amp-folderName-edit");t.removeAttr("amp-old-foldername")});i();v()}function v(){var e=$("#myFavoriteTabListId");e.find("li").find(".amp-app-operate").addClass("amp-hide")}function f(){var e=$("#ampPersonalAsideLeftMyFavorite");var a=$("#ampMyFavoriteCategoryTabContent");var t=e.find('li[amp-folder-delete="true"]');var r=a.find('.myFavoriteFlag[isdragfavoriteappflag="true"]');var i=$("#myFavoriteTabListId");var n=i.find('li[amp-folderName-edit="true"]');var s="";var o="";var p=[];var l="";var m=[];var c=[];var d="";$.each(t,function(e){var a=$(this);var t=a.attr("amp-id");o+="'"+t+"',";m.push(a.find(".amp-left-aside-canuseapp-name").text())});o=o.substr(0,o.length-1);$.each(r,function(e){var a=$(this);var t=a.attr("amp-appid");var r=a.closest(".amp-category-content-item").attr("amp-classify");a.attr("isdragfavoriteappflag","false");l+="{'appId':'"+t+"','folderId':'"+r+"'}"+","});l=l.substr(0,l.length-1);$.each(n,function(e){var a=$(this);var t=a.find(".amp-left-aside-canuseapp-name");var r=a.attr("amp-id");var i=encodeURI(t.text());d+="{'wid':'"+r+"','folderName':'"+i+"'}"+","});d=d.substr(0,d.length-1);s='{"deleteFolderIds":['+o+"],updateAppFavs:["+l+"],userFavoriteFolders:["+d+"]}";AmpDataUtils.saveFavFolderOperates(s,function(e){if(e.result=="success"){u("save");var a=e.delAppIds;if(a&&a.length>0){for(var t=0;t<a.length;t++){var r={appId:a[t],appType:0};AmpFavorite.favoriteSynchronous(r.appId,"cancel",r.appType);AmpFavorite.syFavoriteFolderApps(r.appId);AmpPersonalCenter.getMyFavoriteApps();AmpOpenFavorite.unFavoriteCardApp(r)}}if(o){AmpUtils.zhuge("删除收藏文件夹",{"文件夹名称":m.join(",")})}if(l){AmpUtils.zhuge("整理收藏夹",{})}var i="保存成功！";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("savedSuccessfully")+"!"}AmpPrompt.show({content:i})}});AmpOpenFavorite.favoriteCardSyncDelFolder(t)}function u(e){var a=$("#ampPersonalAsideLeftMyFavorite");var t=$("#ampMyfavoriteSetBtn");var r=a.find("li[amp-folder=true]");var i=$("#myFavoriteTabListId");var n=$("#ampMyFavoriteCategoryTabContent");var s=r.find(".amp-app-count");var o=r.find(".amp-app-operateBtn");if(e=="cancle"){a.find('li[amp-folder-delete="true"]').removeClass("amp-hide").removeAttr("amp-folder-delete");S(i,n)}else if(e=="save"){a.find('li[amp-folder-delete="true"]').remove();AmpPersonalCenter.getMyFavoriteApps()}o.addClass("amp-hide");s.removeClass("amp-hide");t.find("li").addClass("amp-hide");t.find("li.favoriteArrangeFlag").removeClass("amp-hide");a.removeClass("isEditState");i.find("li").removeClass("amp-favorite-edit")}function g(){var e=$("#ampMyFavoriteCategoryTabContent").find(".amp-category-content-item").not(".amp-hide");var a=$("#myFavoriteTabListId");if(!e||!e[0]){return}if(!a||!a[0]){return}if(e.attr("is-sortable-init")!=="true "||a.attr("is-sortable-init")!=="true"){h(e,a);e.attr("is-sortable-init","true");e.attr("is-sortable-init","true")}}function h(a,t){e.space.elRightSort=Sortable.create(t[0],{filter:".myfavorite-create-folder,.amp-active",group:{name:"favoriteApp",put:false,pull:false},animation:100,sort:false,scroll:false});e.space.elLeftSort=Sortable.create(a[0],{group:{name:"favoriteApp",put:false,pull:[true,"clone"]},forceFallback:true,animation:100,sort:false,scroll:false,filter:".amp-favorite-icon-jia,.amp-canUseApp-group-app",onMoveToSelf:function(e){var a=$(e.dragged);a.addClass("sortable-clonen");a.removeClass("amp-drag-app-bg");a.find("img").hide();a.find("h5").hide()},onMove:function(e){var a=$(e.dragged)},onStart:function(a){var t=$(a.item);t.removeClass("sortable-clonen");t.addClass("amp-drag-app-bg");e.space.dragingFlag=true;n()},onEnd:function(e){var a=$(e.item);a.removeClass("sortable-clonen");a.removeClass("amp-drag-app-bg");a.find("img").show();a.find("h5").show();A(e)}})}function A(t){$("#myFavoriteTabListId .amp-hover-slow-motion").unbind("mouseenter").unbind("mouseleave");var r=t.item;var i=$(r);var n=e.space.dragFolderId;var s=$("#myFavoriteTabListId");var o=s.find("li.amp-active");var p=$("#ampMyFavoriteCategoryTabContent");var l=o.attr("amp-id");var m="请移动到正确的目标文件夹";var c="归入文件夹成功";if(AmpGlobal.currentLang=="en_US"){m=$.i18n("moveCorrectFolder");c=$.i18n("belongToFolderSuccess")}if(!n){AmpPrompt.show({content:m})}if(n!=""&&n!=a&&n!==l){i.attr("isDragFavoriteAppFlag","true");var d=p.find('.amp-category-content-item[amp-classify="'+n+'"]');var v=p.find('.amp-category-content-item[amp-classify="'+l+'"]');var f=s.find('li[amp-id="'+n+'"]').find(".amp-app-count");var u=f.text();var g=o.find(".amp-app-count").text();var h=parseInt(g)-1;f.text(parseInt(u)+1);o.find(".amp-app-count").text(h);d.find(".amp-favorite-icon-jia").before(r);b(r,v);if(!h){if(v.find(".amp-favorite-icon-jia").length==0){y(v)}}AmpPrompt.show({content:c});e.space.dragFolderId=""}}function C(){e.space.elLeftSort.option("disabled",true);e.space.elRightSort.option("disabled",true)}function k(e){var a=e?"amp-active":"amp-hide";var t=a=="amp-active"?"amp-hide":"amp-active";var r=$("#myFavoriteTabListId");r.find('li[amp-id="create"]').addClass(a).removeClass(t);r.find('li[amp-id="create"]').removeClass("amp-active")}function b(e,a){var t=e.outerHTML;if(a.attr("amp-classify")=="0"){a.children(".appTitleFlag:last").after(t)}else{a.find(".amp-favorite-icon-jia").before(t)}var r=$(e).attr("amp-appid");a.find('.myFavoriteFlag[amp-appid="'+r+'"]').attr("is-old-folder-drag-app","true").removeAttr("isdragfavoriteappflag").addClass("amp-hide")}function S(e,a){var t=a.find('.myFavoriteFlag[is-old-folder-drag-app="true"]');$.each(t,function(a){var t=$(this);var r=t.closest(".amp-category-content-item");var i=r.attr("amp-classify");var n=e.find('li[amp-id="'+i+'"]');var s=n.find(".amp-app-count").text();n.find(".amp-app-count").text(parseInt(s)+parseInt(1));t.removeClass("amp-hide").removeAttr("is-old-folder-drag-app")});var r=a.find('.myFavoriteFlag[isdragfavoriteappflag="true"]');$.each(r,function(a){var t=$(this);var r=t.closest(".amp-category-content-item");var i=r.attr("amp-classify");var n=e.find('li[amp-id="'+i+'"]');var s=n.find(".amp-app-count").text();n.find(".amp-app-count").text(parseInt(s)-parseInt(1));t.remove();if(r.find(".myFavoriteFlag").length<1&&r.find(".amp-favorite-icon-jia").length<1){y(r)}})}function y(e){var a="";var t="添加应用";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("addApps")}a=$("#tpl-favorite-tool").html().replace("@addApps",t);e.append(a)}function w(e){var a=$("#ampMyFavoriteCategoryTabContent");if(e){a.find(".myFavoriteFlag").removeClass("appFlag")}else{a.find(".myFavoriteFlag").addClass("appFlag")}}function P(e){var a=e.appId;AmpDataUtils.space.folderData[a]=e}function I(e,a){var e=e;var a=a;var t=a.length;var r="";var i="";var n=[];var s=[];for(var o=0;o<e.length;o++){var p=e[o].favoriteFolderId;if(p=="0"){n.push(e[o])}}for(var m=0;m<t;m++){var c=a[m];var d=c.wid;var v=c.folderName;var f=[];var u={};for(var g=0;g<e.length;g++){var p=e[g].favoriteFolderId;if(d==p){f.push(e[g])}}if(f.length>0){u.folderName=v;u.appList=f;s.push(u)}}for(var h=0;h<s.length;h++){var A="";var f=s[h].appList;var v=s[h].folderName;if(h==s.length-1){A=l(f,true,false)}else{A=l(f,false,false)}r+=AmpTemplate.getCanUseAppGroup().replace("@subCategoryName",v).replace("@canUseAppListHtml",A)}if(!r){i+=l(n,true,true)}else{i+=l(n,false,true)}return i+r}})(window.AmpMyfavoriteApp=window.AmpMyfavoriteApp||{});(function(e,a){e.space={loadState:0,loadCompleteState:2,desktopRefresh:false,sessionStorageRecommendData:[],favEmpty:false,hasRightSideData:false};e.init=function(){setTimeout(function(){if(e.space.loadState!==e.space.loadCompleteState){AmpLoading.show()}},500);AmpUtils.niceScrollInit($("#ampDesktopContent"));AmpUtils.niceScrollInit($("#ampTagMessages"));setTimeout(function(){AmpDesktopCommon.setDesktopWidth("left","mini")},50);m();e.getMyFavoriteApps();e.getMainWidgetsData();e.getUserCategoryAppData();e.getTaskCount();b()};e.initContainerLayout=function(e){};e.getMyFavoriteApps=function(){AmpDataUtils.getMyFavoriteApps(function(e){n(e)})};e.getUserCategoryAppData=function(){AmpDataUtils.getUserCategoryAppData(function(e){AmpCanUseApps.saveData(e);AmpCanUseCard.saveData(e)})};e.getTaskCount=function(){AmpDataUtils.getAsideWidgetsData(function(a){if(a.result=="success"){var r=a.taskSideCard;var i=0;var n=0;if(r){for(var s in r){var o=r[s];if(o.appId=="4764373267044847"){i=o.totalSize;if(i){$("#ampzqfwTaskCount").addClass("amp-task-count-bg").text(i)}$("#zqfwTask").removeClass("amp-aside-box-hide")}if(o.appId=="4764356755066632"){e.space.hasRightSideData=true;$("#dbTask").removeClass("amp-aside-box-hide")}if(o.appId=="4764368506642413"){e.space.hasRightSideData=true;$("#lcgzTask").removeClass("amp-aside-box-hide")}}if(e.space.hasRightSideData){var p=parent.window.AMPConfigure.taskcenterDataRefreshTime||1;var l=parseInt(p)*6e4;window.setTimeout(function(){t()},500);window.setInterval(function(){t()},l)}}sessionStorage.setItem("zqfwCount",i)}})};function t(){if(sessionStorage.getItem("ampTaskCenterDatas")){var e=JSON.parse(sessionStorage.getItem("ampTaskCenterDatas"));var a=e.queryTodoTask.taskDataTotal;var t=e.queryProcessTrack.taskDataTotal;if(a){$("#ampDbTaskCount").addClass("amp-task-count-bg").text(a)}if(t){$("#ampLcgzTaskCount").addClass("amp-task-count-bg").text(t)}sessionStorage.setItem("taskCount",parseInt(a)+parseInt(t))}}e.getMainWidgetsData=function(t){if(t!=a&&t){e.space.desktopRefresh=true;r(t)}else{AmpDataUtils.desktopInfo(function(e){r(e)})}};e.hideMainWidgets=function(){$("#ampDesktopContent").find(".amp-widget").addClass("amp-hide")};e.showMainWidgets=function(){o()};e.dragViewing=function(){$(window).scroll(function(){var e=document.getElementById("eq").offsetTop;if(e>=$(window).scrollTop()&&e<$(window).scrollTop()+$(window).height()){alert("div在可视范围")}})};function r(a){var t=null;var r=0;if(a){var n=ge(a);if(!n){return false}t=a.desktopUserList;t=ue(t);r=t.length}if(r===0){if(AmpGlobal.platformType!="0"){i()}}var l={};var m="";var c="";var d=true;for(var v=0;v<r;v++){var f=t[v];var u=f.desktopId;var g=f.desktopId;var h=f.isEditable;var A=f.desktopName;var C=f.desktopType;var k=f.appPcCardList;var b=k?k.length:0;var S=v!==0?"":"amp-active";var w=f.isNew==1?' <span class="amp-admin-new-desktopnav"></span>':"";if(AmpGlobal.platformType=="0"){if(C=="1"){continue}else{if(v==0){S=d?"amp-active":""}else{S=""}}}m+='<div class="amp-tab-item amp-left-tab-item '+S+'" amp-desktop-id="'+u+'" amp-desktop-type="'+C+'" is-editable="'+h+'" title="'+A+'">'+A+w+"</div>";var P=R({widgets:k,widgetsLen:b,desktopNum:v});if(v==0){if(AmpGlobal.platformType!="0"){var I=a.appPcCardBizList;if(I){var U=I.length;var D="recommedCard";P+=R({widgets:I,widgetsLen:U,recommCardClass:D})}}}else{if(AmpGlobal.platformType!="0"){var T={};T.desktopId=u;T.desktopName=A;T.desktopType=C;c+=AmpTemplate.getRecommendDesktopNav(T)}}if(AmpGlobal.platformType!="0"){if(typeof AMPConfigure.desktop_custom!="undefined"&&AMPConfigure.desktop_custom.pccard_customization&&v==0){P=P}else{P+=AmpTemplate.getWidgetAddCardMainHtml();P+=AmpTemplate.getWidgetDragCardMainHtml()}}P='<div id="ampTabContentItem'+v+'" class="amp-tab-content-item amp-active amp-animated amp-animate-move-bottom-in" amp-desktop-id="'+u+'"  amp-desktop-type="'+C+'">'+P+"</div>";var L=$("#ampDesktopContent");if(v===0){L.off("animationend").on("animationend",".amp-tab-content-item",function(){if(AmpGlobal.platformType!="0"){p();y();setTimeout(function(){e.showRecommendCrad();e.showAdminNewDesktop()},0)}});L.html(P);AmpWidgetUtils.addLoadingToWidget(L)}else{if(AmpGlobal.platformType=="0"){if(C=="0"&&d){L.append(P);AmpWidgetUtils.addLoadingToWidget(L)}d=false}l[u]=P}}if(AmpGlobal.platformType!="0"){var F=$("#tpl-personalCenterSet-btn").html();m+=F}$("#ampDesktopNav").html(m);sessionStorage.setItem("ampDesktopData",JSON.stringify(l));sessionStorage.setItem("recommendDesktopNavHtml",c);setTimeout(function(){if(e.space.desktopRefresh){o()}else{s()}},10)}function i(){var e=$("#ampDesktopNav");var a=$("#ampDesktopContent");var t="";if(AmpGlobal.platformType!="0"){var r=$("#tpl-personalCenterSet-btn").html();t+=r}e.html(t);e.addClass("amp-active");var i="新建桌面";var n="开启全新服务体验";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("createANewDesktop");n=$.i18n("openANewServiceExperience")}var s=$("#tpl-desktop-ampty-page").html().replace("@openANewServiceExperience",n).replace("@createANewDesktop",i);a.html(s)}function n(e){AmpMyfavoriteApp.initMyFavoriteApps(e);s()}function s(){e.space.loadState++;if(e.space.loadState===e.space.loadCompleteState){AmpLoading.close();$("#ampPersonalAsideLeft").removeClass("amp-hide");$("#ampPersonalAsideRight").removeClass("amp-hide");o();if(e.space.favEmpty){pe()}if(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE()){$("#ampDesktopContent").getNiceScroll().remove();AmpUtils.niceScrollInit($("#ampDesktopContent"))}fe();he();var a=AmpUtils.getCookie("openLoginServicePageFlag");var t=AmpUtils.getCookie("loginServiceserchVal");if(a=="true"){if(t!=""){$("#ampPageHeaderSearch").click()}else{$("#ampPageHeaderSearch").click()}}}}function o(){I();ne();l();e.setCustomDesktopCenter()}function p(){var e=O();if(e){B()}var a=$("#ampDesktopContent");var t=$("#ampDesktopNav")}function l(){var a=$("#ampDesktopContent");var t=$("#ampDesktopNav");var r=t.find(".amp-active").attr("amp-desktop-id");var i=a.children('[amp-desktop-id="'+r+'"]');var n=i.children();var s=150;var o=O();n.each(function(e){var a=$(this);if(o){if(a.hasClass("amp-widget-add")){return true}else if(a.hasClass("ampLoadingDragCompleteFlag")){a.removeClass("amp-widget-drag-hide")}}else{if(a.hasClass("ampLoadingDragCompleteFlag")){a.addClass("amp-widget-drag-hide")}}a.removeClass("amp-hide");setTimeout(function(){if(a.find("amp-w-frame").attr("has-scroll")==="true"){AmpUtils.niceScrollInit(a.find(".amp-wf-body"))}},450+10)});if(n.length>2){i.find(".amp-desktop-tool").addClass("amp-tool-hide")}if(navigator.userAgent.indexOf("MSIE")>0){if(navigator.userAgent.indexOf("MSIE 9.0")>0){if(AmpGlobal.platformType!="0"){p();y();setTimeout(function(){e.showRecommendCrad();e.showAdminNewDesktop()},0)}}}var l=n.length;setTimeout(function(){var e=parseInt($("#ampDesktopContent").width()/540);var a=AmpTemplate.getDesktopBlurHtm(e);$("#ampDesktopContent").append(a);n.each(function(e){var a=$(this);if(a.hasClass("recommedCard")){var t="newRecommendCard"+e;$(a).addClass(t);var r=a.children().attr("widget_title");if(AmpGlobal.currentLang=="en_US"){r=a.children().attr("widget_title_enus")}var i='<div class="widget-name-title"><span>'+r+"</span></div>";$("body").append(i);var n=$(".widget-name-title span").width()+25+"px";if($(".widget-name-title span").width()+25<90){n=90+"px"}$("body").append('<style type="text/css">.'+t+":after {left:"+n+";} </style>");$("body").find(".widget-name-title").remove()}})},l*s);setTimeout(function(){e.openAsideBoxConfig()},l*s);if(AmpGlobal.platformType=="0"){a.find(".amp-widget").find(".amp-wf-head").removeClass("amp-card-move-flag")}}function m(){$("#ampDesktopNav").on("click",".amp-tab-item",function(){var e=$(this);if(e.hasClass("ampDesktopAddFlag")){U($(this))}else if(e.hasClass("ampDesktopSetFlag")){if(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE()){$("#ampPersonalArticle").addClass("amp-hide").removeClass("amp-active")}else{$("#ampPersonalArticle").addClass("amp-hide").removeClass("amp-active")}setTimeout(function(){AmpDesktopSet.init()},AmpGlobal.animateTimes)}else if(e.hasClass("amp-desktop-admin")){return}else{if(!e.hasClass("amp-desktop-add-input-container")){c($(this));L()}AmpUtils.zhuge("切换桌面",{"桌面名称":e.text()})}});$("#ampDesktopContent").on("click",".empty-desktop-create",function(){U($(this))});$("#ampPersonalAsideLeftTabHead").on("click",".amp-tab-item",function(){h($(this),true);if($(this).attr("amp-id")=="canUseCards"){B()}j($(this))});$("#ampPersonalAsideLeftCanUseCards").on("click","li",function(){AmpCanUseCard.cardtabChange($(this));var e=$(this);if($(this).parent().attr("id")=="canUseTabListId"){B();ee($(this));x()}});$("#ampDesktopContent").on("click",".amp-widget-add",function(){e.setPcDesktopToolAddOrDrag(false);F()});$("#ampPersonalAsideLeftCanUseCards").on("click touchend",".amp-app-complex-add",function(){var e=me($(this));if(!e){return}else{E($(this))}});$("#ampPersonalAsideLeftCanUseCards").on("click touchend",".amp-app-complex-del",function(){var e=me($(this));if(e){return}else{_($(this))}});$("#ampDesktopContent").on("click",".amp-recommend-no-need",function(){V()});$("#ampDesktopContent").on("click",".recommend-keep-title",function(){Z()});$("#ampDesktopContent").on("click",".desktop-title",function(){$("#ampRecommendShowDesktop").toggle()});$("#ampDesktopContent").on("click",".recommend-keep-desktop-nav",function(){X($(this))});$("#ampDesktopContent").on("click",".amp-recommend-i-know",function(){se($(this))});$("#ampDesktopNav").on("click",".amp-create-btn-cancel",function(){ce($(this))});$("#ampDesktopNav").on("click",".amp-create-btn-save",function(){de($(this))});$("#ampCreateDesktopInput").on("change",function(){});$("#ampDesktopContent").scroll(function(){ve()});$("#ampDesktopContent").scroll(function(){var e=$("#ampDesktopContent").scrollTop();if(e>0){$("#amp-desktopBlur").css("opacity","1");$("#amp-desktopBlur").css("height","20px")}else{$("#amp-desktopBlur").css("height","0")}});$("body").on("click",".amp-myfavorite-create-folder",function(e){var a=$(e.target||e.srcElement);var t=$("#ampMyFavoriteCreateFolder");if(a.attr("id")=="ampFolderCancle"){t.remove();AmpMyfavoriteApp.favTabChange($("#myFavoriteTabListId").find('li[amp-id="0"]'))}if(a.attr("id")=="ampFolderSave"){AmpMyfavoriteApp.saveFolder()}})}function c(e){var a=$("#ampDesktopNav");var t=a.find(".amp-active");var r=t.attr("amp-desktop-id");var i=e.attr("amp-desktop-id");if(typeof AMPConfigure.desktop_custom!="undefined"&&AMPConfigure.desktop_custom.pccard_customization){var n=$("#ampPersonalAsideLeftTabHead").find('.amp-tab-item[amp-id="canUseCards"]').hasClass("amp-active");if(n&&a.find(".amp-tab-item:first").attr("amp-desktop-id")==i){$("#ampPersonalAsideLeftTabHead").find('[amp-id="myFavorite"]').click()}}t.removeClass("amp-active");e.addClass("amp-active");var s=$("#ampDesktopContent");var p=s.children('[amp-desktop-id="'+r+'"]');p.removeClass("amp-active");p.find(".amp-widget").addClass("amp-hide");var l=s.children('[amp-desktop-id="'+i+'"]');l.addClass("amp-active");if(l.length!==0){l.removeClass("amp-hide")}else{var m=JSON.parse(sessionStorage.getItem("ampDesktopData"))[i];s.append(m);AmpWidgetUtils.addLoadingToWidget(s)}d(i);o();if(e.find("span").length==1){oe(i)}}function d(t){var r=$("#ampDesktopContent");var i=e.space.sessionStorageRecommendData;var n=i.length;if(n>0){for(var s in i){var o=i[s];var p=o.desktopId;var l=o.cardWid;var m=o.cardId;var c=o.desktopRecommendCardHtm;var d=false;if(p==t){var v=r.children('[amp-desktop-id="'+t+'"]').children();var f=v.filter('[widget-wid="'+l+'"]').length;if(f==0){var u="";for(var s in v){var g=v[s];if(s==v.length-3){u+=c;if(g.outerHTML!=a){u+=g.outerHTML}}else{if(g.outerHTML!=a){u+=g.outerHTML}}}r.children('[amp-desktop-id="'+t+'"]').html(u)}}}}}function v(){var e=sessionStorage.getItem("canUseCards");var a=$("#ampPersonalAsideLeftCanUseCards");var t=$(e).find("ul li").length;if(t==0||!t){var r="暂无应用卡片";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("noAppCards")}var i=r;var n=AmpTemplate.getPersonalEmptyPage(i);e=n}a.html(e);ie();x()}e.getCanUseAppsHtml=function(e,a){var t="";var r=e.length;for(var i=0;i<r;i++){var n="";var s="";n=e[i].unReadMark?"apphasUnReadMark":"";e[i].hasUnReadMarkClass=n;if(a=="complex"){s=f(e[i])?"amp-app-complex-del":"amp-app-complex-add";e[i].hasBtnClass=s}t+=AmpTemplate.getSingleAppHtml(e[i],a)}return t};function f(e){var a=e.cardId;var t=false;var r=$("#ampDesktopNav");var i=$("#ampDesktopContent");var n=r.find(".amp-active").attr("amp-desktop-id");var s=i.children('[amp-desktop-id="'+n+'"]');var o=s.children();o.each(function(e){var r=$(this);var i=r.attr("widget-id");if(a==i){t=true;return false}});return t}function u(e,a){var t=e.appList;var r=t.length;for(var i=0;i<r;i++){var n=t[i];var s=n.appId;var o=a[s];if(!o){a[s]={};o=a[s];o.name=n.appName;o.apps=[]}o.apps.push(e)}return a}function g(e,a){a=a||550;if(e.css("overflow-y")==="hidden"){setTimeout(function(){e.getNiceScroll().resize()},a);return}setTimeout(function(){AmpUtils.niceScrollInit(e)},a)}function h(a,t){var r=a.attr("amp-id");var i={myFavorite:"#ampPersonalAsideLeftMyFavorite",allCanUseApps:"#ampPersonalAsideLeftAllCanUseAppsTabContent"}[r];if(typeof AMPConfigure.desktop_custom!="undefined"&&AMPConfigure.desktop_custom.pccard_customization){if(r=="canUseCards"&&$("#ampDesktopNav").find(".amp-tab-item:first").hasClass("amp-active")){AmpPrompt.show({content:"当前桌面不能添加卡片，请选择其他桌面添加！"});return}}if(a.hasClass("amp-active")){A(a);C(a);if(i){g($(i))}if(r=="canUseCards"){e.setPcDesktopToolAddOrDrag(false);x()}return}var n=a.closest(".amp-tab");var s=n.find(".amp-tab-content");var o=n.find(".amp-tab-item.amp-active");var p=o.attr("amp-id");o.removeClass("amp-active");s.children('[amp-id="'+p+'"]').addClass("amp-hide");a.addClass("amp-active");s.children('[amp-id="'+r+'"]').removeClass("amp-hide");var l=null;if(r==="allCanUseApps"){var m=$("#ampPersonalAsideLeftAllCanUseAppsTabUl");if(m.children("amp-active").length===0){m.children('[amp-id="all"]').click()}l=$("#ampPersonalAsideLeftAllCanUseAppsTabContent");scrollCateUlPan=$("#ampPersonalAsideLeftAllCanUseAppsTabUl")}else if(r==="canUseCards"){e.setPcDesktopToolAddOrDrag(false);x();var c=$("#ampPersonalAsideLeftCanUseCards");if($.trim(c.html()).length===0){v()}var d=c.find("ul li:first");ee(d);l=$("#ampPersonalAsideLeftCanUseCards #ampCategoryTabContent");scrollCateUlPan=$("#ampPersonalAsideLeftCanUseCards #canUseTabListId");B()}else{l=$("#ampPersonalAsideLeftMyFavorite")}if(l){if(t){g(l,1);g(scrollCateUlPan,1)}else{g(l);g(scrollCateUlPan)}}}e.asideLeftTabChange=h;function A(e){var a=e.attr("amp-id");if(a==="allCanUseApps"){var t=$("#ampPersonalAsideLeftAllCanUseAppsTabUl");if(t.children(".amp-active").length===0){t.children('[amp-id="all"]').click()}}}function C(e){var a=e.attr("amp-id");if(a==="canUseCards"){var t=$("#canUseTabListId");if(t.children('[amp-id="all"]').hasClass("amp-active")){t.children('[amp-id="all"]').click()}}}function k(e){if(e.hasClass("amp-active")){return}var a=e.closest("ul");var t=e.closest(".amp-category-tab");var r=t.children("div");var i=e.attr("amp-id");var n=r.children('[amp-id="'+i+'"]');var s=a.children(".amp-active");var o=s.attr("amp-id");var p=r.children('[amp-id="'+o+'"]');s.removeClass("amp-active");p.addClass("amp-hide");e.addClass("amp-active");n.removeClass("amp-hide")}function b(){$("body").on("widgetRemove",function(e,a){var t=a.desktopId;var r=a.desktopType;var i=a.widgetId;var n=a.cardWid;var s=a.cardName;var o=a.desktopName;AmpDataUtils.deleteUserDesktopCard(a,function(e){if(e.result==="success"){var a="删除成功";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("deletedSuccessfully")}AmpPrompt.show({content:a});B();Ce();AmpUtils.zhuge("删除桌面卡片",{"桌面名":o,"卡片名":s,"来源":"卡片右上方点删除"})}})})}function S(e,a){e+=$("#tpl-widget-main-item").html().replace("@content","").replace("@widgetId","ampEmptyWidgetPlaceholderFlag");return e}function y(){var e=$("#ampDesktopNav");var a=e.find(".amp-active").attr("amp-desktop-id");var t=e.find(".amp-active").attr("amp-desktop-type");var r=e.find(".amp-active").attr("is-editable");var i={};i.desktopId=a;i.desktopType=t;var n=$("#ampDesktopContent");var s=n.children(".amp-active");if(s.attr("is-sortable-init")!=="true"){if(navigator.userAgent.indexOf("MSIE")>0&&navigator.userAgent.indexOf("MSIE 9.0")>0){document.body.onselectstart=document.body.ondrag=function(){return false}}if(r=="1"){w(s[0]);s.attr("is-sortable-init","true")}else{setTimeout(function(){$("#ampDesktopContent").find('[amp-desktop-id="'+a+'"]').find(".icon-drag").remove()},1e3)}}var o=window.navigator.userAgent;if(o.indexOf("Safari")>0){if(s.find(".amp-widget-drag").length>1){s.find(".amp-widget-drag:eq(1)").addClass("amp-hide")}}}function w(e){Sortable.create(e,{filter:".amp-card-hasno-drag",handle:".amp-card-wf-head",animation:150,draggable:".amp-widget-only-drag",scroll:true,ghostClass:"amp-sort-ghost-class",setData:function(e,a){$(a).find(".amp-wf-body").hide()},onStart:function(e){var a=$(e.item);a.find(".amp-wf-body").show()},onEnd:function(e){var a=$("#ampDesktopNav");var t=$("#ampDesktopContent");var r=a.find(".amp-active").attr("amp-desktop-id");var i=a.find(".amp-active").attr("amp-desktop-type");var n=t.children('[amp-desktop-id="'+r+'"]');var s=n.children().not(".recommedCard");var o={};o.desktopId=r;o.desktopType=i;z(s,o);ve()}})}function P(e){var a=e.pcCardCategory;if(!a){return}var t=a.length;var r=isNewCreateCVard(a);if(r){var i='<span class="amp-admin-new-desktopnav"></span>';$('.amp-tab-item[amp-id="canUseCards"]').append(i);$('.amp-aside-box-mini-item[amp-id="canUseCards"]').addClass("amp-left-top")}var n="";var s="";var o=true;for(var p in a){var l=a[p];var m=!o?"":"amp-active";var c=l.hasUnReadMark;var d=c?"tabhasUnReadMark":"";var v=getCanUseCardCount(l);s+=AmpTemplate.getCategoryTabHeadItemHtml({id:p,name:l.categoryName,customClass:m,hasUnReadMarkClass:d,appCount:v});var f=l.appList;var u="";var g=[];$.each(f,function(e,a){var t=a.appPcCardList;if(!t){return}var r=a.middleIcon;$.each(t,function(e,a){a.middleIcon=r;g.push(a)})});u+=getCanUseAppsHtml(g,"complex");var h=!o?"amp-hide":"";n+=AmpTemplate.getCategoryTabContentItemHtml({id:"ampCategoryContentCanUseItem"+p,content:u,customClass:h,key:p});o=false}var A="canUseTabListId";var C=AmpTemplate.getCategoryTabHtml({header:s,content:n,tabUlId:A});sessionStorage.setItem("canUseCards",C)}function I(){var e=$("#ampDesktopNav");var a=e.find(".amp-tab-item").filter('[amp-desktop-type="1"]').length;if(a>=3){e.find(".ampDesktopAddFlag").remove()}}function U(e){if(e.hasClass("amp-btn-active")){return}if($(".ampDesktopAddFlag")&&$(".ampDesktopAddFlag").length==1){$(".ampDesktopAddFlag").addClass("amp-btn-active")}if($(".empty-desktop-create")&&$(".empty-desktop-create").length==1){$(".empty-desktop-create").addClass("amp-btn-active")}var a=AmpTemplate.createDesktopDialogHtm();$("#ampDesktopNav").append(a);$("#ampCreateDesktopInput").focus().select();var t=$("#ampDesktopNav").find(".ampDesktopAddFlag").offset().left-$("#ampPersonalAsideLeft").width()-16;$("#ampAdminNewDesktop").css("left",""+t+"px")}function D(e,a){var t="";var r=e.desktopId;var i=a;var n=e.isEditable||1;var s=1;t+='<div class="amp-tab-item amp-active" amp-desktop-id="'+r+'" amp-desktop-type="'+s+'" is-editable="'+n+'">'+i+"</div>";var o=$("#ampDesktopNav").children().filter('[amp-desktop-type="0"]:first');$("#ampDesktopNav").find(".amp-tab-item.amp-active").removeClass("amp-active");$(".ampDesktopBtn:first").before(t);var p=$("#ampDesktopNav [amp-desktop-id]").length-1;var l="";var m=1;l+=AmpTemplate.getWidgetDragCardMainHtml();l+=AmpTemplate.getWidgetAddCardMainHtml();l='<div id="ampTabContentItem'+p+'" class="amp-tab-content-item amp-active amp-animated amp-animate-move-bottom-in" amp-desktop-id="'+r+'" amp-desktop-type="'+s+'">'+l+"</div>";var c=$("#ampDesktopContent");c.find(".amp-tab-content-item").removeClass("amp-active").addClass("amp-hide");c.append(l);T();I();ne();B()}function T(){var e=$("#ampDesktopNav");var a=$("#ampDesktopContent");var t=e.find(".amp-active").attr("amp-desktop-id");var r=a.find('.amp-tab-content-item[amp-desktop-id="'+t+'"]');r.find(".amp-widget-add").addClass("amp-hide").removeClass("amp-animate-move-bottom-in");r.find(".amp-widget-drag").removeClass("amp-widget-drag-hide");F()}function L(){var e=$("#ampPersonalAsideLeft");var a=$("#ampDesktopNav");var t=$("#ampDesktopContent");var r=a.find(".amp-active").attr("amp-desktop-id");var i=t.find('.amp-tab-content-item[amp-desktop-id="'+r+'"]');if(e.hasClass("amp-mini")){i.find(".amp-widget-add").removeClass("amp-hide").addClass("amp-animate-move-bottom-in");i.find(".amp-widget-drag").addClass("amp-widget-drag-hide")}}function F(){var e=$("#ampPersonalAsideLeft");var a=$("#ampPersonalAsideLeftTabHead").find('[amp-id="canUseCards"]');if(e.hasClass("amp-mini")){$("#ampPersonalAsideLeftMini .amp-aside-box-mini-item").click();a.click()}else{if(!a.hasClass("amp-active")){a.click()}}}function x(){var e=$("#ampDesktopContent");var a=$("#ampPersonalAsideLeftCanUseCards");var t=a.find(".amp-category-content-item").not(".amp-hide");var r=e.children(".amp-active");var i=a.find("ul");if(!t||!t[0]){return}if(!r||!r[0]){return}if(t.attr("is-sortable-init-side")!=="true"||r.attr("is-sortable-init-side")!=="true"){H(t,r);t.attr("is-sortable-init-side","true")}if(r.attr("is-sortable-init-side")!=="true"||i.attr("is-sortable-init-side")!=="true"){M(i,r);r.attr("is-sortable-init-side","true")}}function H(a,t){Sortable.create(a[0],{filter:".ampHasAddedFlag,.amp-card-hasno-drag",group:{name:"card",pull:"clone",put:false},animation:100,sort:false,scroll:false,onMoveToSelf:function(e){var a=$(e.dragged);a.removeClass("amp-sorting-crad-change-big");a.find("h5").removeClass("apphasUnReadMark");a.find(".amp-app-complex-btn").addClass("amp-app-complex-add")},onMove:function(e){var a=$(e.dragged);a.addClass("amp-sorting-crad-change-big");a.find("h5").removeClass("apphasUnReadMark");a.find(".amp-app-complex-btn").removeClass("amp-app-complex-add")},onEnd:function(a){var t=a.item;var r=$(t);var i=$(a.clone);var n=$(a.item);i.find(".amp-app-complex-btn").removeClass("amp-app-complex-add").addClass("amp-app-complex-del");n.find(".amp-app-complex-btn").removeClass("amp-app-complex-add").addClass("amp-app-complex-del");i.addClass("ampHasAddedFlag");n.addClass("ampHasAddedFlag");var s=[];var o=0;var p=N(r);s.push(p);o=s.length;var l="dragToDesktop";var m=R({widgets:s,widgetsLen:o,dragCardClass:l});var c=$("#ampDesktopNav");var d=$("#ampDesktopContent");var v=c.find(".amp-active").attr("amp-desktop-id");var f=c.find(".amp-active").attr("amp-desktop-type");var u=d.children('[amp-desktop-id="'+v+'"]');if(u.find(".amp-app-complex").length!=0){u.find(".amp-app-complex").after(m).remove()}else{u.find(".amp-widget-add").before(m)}setTimeout(function(){e.showRecommendCrad()},450);d.find(".dragToDesktop").removeClass("amp-hide").addClass("amp-animate-move-bottom-in");var g=d.children('[amp-desktop-id="'+v+'"]');var h=g.children().not(".recommedCard");var A={};A.desktopId=v;A.desktopType=f;z(h,A);ve()}});if(navigator.userAgent.indexOf("MSIE 9.0")<0){Sortable.create(t[0],{group:{name:"card",put:[a[0].id]},forceFallback:true,animation:100,scroll:false,filter:".amp-card-hasno-drag",handle:".amp-card-wf-head",draggable:".amp-widget-only-drag",ghostClass:"amp-sort-ghost-class",sort:false,filter:".amp-card-hasno-drag"})}}function M(e,a){var e=e;var a=a;Sortable.create(e[0],{group:{name:"card",pull:"clone",put:false},animation:100,sort:false,scroll:false,filter:".amp-card-hasno-drag",onMoveToSelf:function(e){$(e.dragged).removeClass("amp-sorting-crad-change-big");$(e.dragged).find("h5").removeClass("tabhasUnReadMark")},onMove:function(e){$(e.dragged).addClass("amp-sorting-crad-change-big");$(e.dragged).find("h5").removeClass("tabhasUnReadMark")},onEnd:function(e){var a=$(e.item).attr("amp-id");var t=$("#ampCategoryTabContent");var r=t.children('[amp-id="'+a+'"]').children();r=r.find(".amp-app-complex-add").closest(".amp-app-complex");var i=[];var n=0;var s=[];r.each(function(){var e=$(this);e.addClass("ampHasAddedFlag");var a=N(e);i.push(a);s.push(e.attr("card-name"))});n=i.length;var o="dragToDesktop";var p=R({widgets:i,widgetsLen:n,dragCardClass:o});var l=$("#ampDesktopNav");var m=$("#ampDesktopContent");var c=l.find(".amp-active").attr("amp-desktop-id");var d=l.find(".amp-active").attr("amp-desktop-type");var v=l.find(".amp-active").text();var f=m.children('[amp-desktop-id="'+c+'"]');f.find("li.amp-sorting-crad-change-big").after(p).remove();m.find(".dragToDesktop").removeClass("amp-hide").addClass("amp-animate-move-bottom-in");r.find(".amp-app-complex-btn").removeClass("amp-app-complex-add").addClass("amp-app-complex-del");var u=m.children('[amp-desktop-id="'+c+'"]');var g=u.children().not(".recommedCard");var h={};h.desktopId=c;h.desktopType=d;h.desktopName=v;h.cardName=s;z(g,h);ve()}});if(navigator.userAgent.indexOf("MSIE 9.0")<0){Sortable.create(a[0],{group:{name:"card",put:[e[0].id]},animation:100,scroll:false,filter:".amp-card-hasno-drag",handle:".amp-card-wf-head",draggable:".amp-widget-only-drag",ghostClass:"amp-sort-ghost-class",sort:false,onStart:function(){}})}}function N(e){var a=e.attr("amp-appid");var t=e.attr("cardnickname");var r=e.attr("card-name");var i=e.attr("app-card-wid");var n={appId:a,cardName:r,cardId:t,cardWid:i};return n}function R(e){var a=e.widgets;var t=e.widgetsLen;var r=e.dragCardClass;var i=e.recommCardClass;var n=e.desktopNum;var s="";var o={};for(var p=0;p<t;p++){var l=a[p];var m=l.cardName;var c=l.cardNameEnus;var d=l.cardId;var v=l.cardWid||l.wid;var f=l.hasAuthLose;var u=l.appId;var g=l.cardId;var h=l.appKey;var A="";var C=true;var $={};$.appId=u;$.cardId=g;$.desktopNum=n;AmpUtils.loadWidgetJson($).done(function(e,a){if(m){e.widget_title=m}o[a.cardId]=e}).fail(function(e,a){C=false});if(!C){return}if(u=="5117447931670328"){A="refreshFlag"}AmpUtils.loadWidgetComponentHtml($,function(e){AmpWidgetUtils.loadWidgetComplete(e,"main")});if(f){s+=AmpTemplate.getWidgetLostPermissionCard({widgetId:d,widgetWid:v,widgetsJsonData:o})}else{s+=AmpTemplate.getWidgetMainItemHtml({widgetId:d,dragCardClass:r,widgetWid:v,recommCardClass:i,widgetsJsonData:o,appId:u,appKey:h,widgetTitle:m,widgetTitleEnus:c,refreshClass:A})}}return s}function E(a){var a=a;a.removeClass("amp-app-complex-add").addClass("amp-app-complex-del");a.closest(".amp-app-complex").addClass("ampHasAddedFlag");q(a);setTimeout(function(){var t=[];var r=0;var i=a.parent();var n=N(i);t.push(n);r=t.length;var s="dragToDesktop";var o=R({widgets:t,widgetsLen:r,dragCardClass:s});var p=$("#ampDesktopNav");var l=$("#ampDesktopContent");var m=p.find(".amp-active").attr("amp-desktop-id");var c=p.find(".amp-active").attr("amp-desktop-type");var d=l.children('[amp-desktop-id="'+m+'"]');var v=p.find(".amp-active").text();setTimeout(function(){var a=d.children().filter(".recommedCard");if(a.length>0){a.first().before(o);setTimeout(function(){e.showRecommendCrad()},450)}else{d.find(".amp-desktop-tool:first").before(o)}Ce();l.find(".dragToDesktop").removeClass("amp-hide").addClass("amp-animate-small-to-big");setTimeout(function(){l.find(".dragToDesktop").removeClass("amp-animate-small-to-big").removeClass("dragToDesktop");J()},500);var t=l.children('[amp-desktop-id="'+m+'"]');var r=t.children().not(".recommedCard");var n={};n.desktopId=m;n.desktopType=c;n.desktopName=v;n.cardName=i.children("h5").text();z(r,n)},100);$("body").find(".clone-img").remove()},500)}function _(a){var a=a;a.removeClass("amp-app-complex-del").addClass("amp-app-complex-add");a.closest(".amp-app-complex").removeClass("ampHasAddedFlag");var t=a.parent().attr("cardnickname");var r=a.parent().attr("app-card-wid");var i=a.parent().text();var n=$("#ampDesktopNav");var s=$("#ampDesktopContent");var o=n.find(".amp-active").attr("amp-desktop-id");var p=n.find(".amp-active").attr("amp-desktop-type");var l=n.find(".amp-active").attr("title");var m=s.children('[amp-desktop-id="'+o+'"]');var c=m.children('[widget-wid="'+r+'"]');var d=c.hasClass("recommedCard");c.addClass("amp-animate-big-to-small");c.hide(100,function(){$(this).remove();setTimeout(function(){e.showRecommendCrad()},150);Ce()});if(d){var v={};v.cardWid=r;Y(v)}else{var f={};f.desktopId=o;f.desktopType=p;f.cardWid=r;f.desktopName=l;AmpDataUtils.deleteUserDesktopCard(f,function(e){if(e.result==="success"){var a="删除成功";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("deletedSuccessfully")}AmpPrompt.show({content:a});AmpUtils.zhuge("删除桌面卡片",{"桌面名":l,"卡片名":i,"来源":"左侧可用卡片中点-按钮"})}})}}e.showRecommendCrad=function(){var e=$("#ampDesktopNav");var a=W();var t=$("#ampRecommendBtn").css("display");var r=$(".amp-recommed-card-container");if(a){r.css("display","block")}else{r.css("display","none");return false}if($("#ampTabContentItem0").find(".amp-recommed-card-container").length==0){var i=sessionStorage.getItem("recommendDesktopNavHtml");$recommendCardHtml=AmpTemplate.getRecommendHtml(i);$("#ampTabContentItem0").append($recommendCardHtml);if(i==""){$("#ampDesktopTitle").remove()}}setTimeout(function(){var e=$("#ampDesktopContent");var a=$("#ampDesktopContent").find(".amp-tab-content-item:first").find(".recommedCard:first");var t=$("#ampDesktopContent").find(".amp-widget-drag");var r=a.offset().top;var i="";var n="";var s="";if(r<240&&r>0){i=r-80+"px";$("#ampRecommendBtn").addClass("amp-recommend-down").removeClass("amp-recommend-up")}else if(r<0){i=-r+(e.offsetHeight-e.scrollTop())+"px"}else{s=e.scrollTop();if(s){i=s+a.offset().top-240+"px"}else{i=a.offset().top-240+"px"}$("#ampRecommendBtn").removeClass("amp-recommend-down").addClass("amp-recommend-up")}var o=$("#ampPersonalAsideLeft").width();var p=$("#ampPersonalAsideRight").width();if(o==60){n=a.offset().left-100+16+"px"}else{if(p==60){n=a.offset().left-580+"px"}else{n=a.offset().left-420+"px"}}$(".amp-recommed-card-container").css({top:i,left:n});$(".amp-recommed-card-container").show()},600);var n=O();if(!n){setTimeout(function(){var e=$("#ampTabContentItem0").find(".recommedCard:first").offset().top;$("#ampDesktopContent").animate({scrollTop:e-240},300)},200)}};function G(e){var a=$("#ampDesktopContent");var t=e.attr("amp-desktop-id");var r=a.find('[amp-desktop-id="'+t+'"]').attr("id");$("#"+r+" div.amp-widget-drag").removeClass("amp-widget-drag-hide").removeClass("amp-hide").addClass("amp-animate-move-bottom-in");$("#"+r+" div.amp-widget-add").addClass("amp-hide").removeClass("amp-animate-move-bottom-in")}function B(e){var a=$("#ampDesktopContent");var t=$("#ampPersonalAsideLeftCanUseCards");var r=t.find(".amp-category-content-item").not(".amp-hide");var i=r.children();i.each(function(){e=$(this);var a=e.attr("app-card-wid");var t=false;var r=$("#ampDesktopNav");var i=$("#ampDesktopContent");var n=r.find(".amp-active").attr("amp-desktop-id");var s=r.find(".amp-active").attr("is-editable");var o=i.children('[amp-desktop-id="'+n+'"]');var p=o.children();p.each(function(r){var i=$(this);var n=i.attr("widget-wid");if(a==n){t=true}if(s==="1"){e.find(".amp-app-complex-btn").show();if(t){e.find(".amp-app-complex-btn").addClass("amp-app-complex-del").removeClass("amp-app-complex-add");e.addClass("ampHasAddedFlag");return true}else{e.find(".amp-app-complex-btn").addClass("amp-app-complex-add").removeClass("amp-app-complex-del");e.removeClass("ampHasAddedFlag");return true}}else{e.find(".amp-app-complex-btn").hide();e.addClass("ampHasAddedFlag")}})})}function j(e){var a=O();var t=$("#ampDesktopNav");var r=$("#ampDesktopContent");var i=t.find(".amp-active").attr("amp-desktop-id");var n=r.find('.amp-tab-content-item[amp-desktop-id="'+i+'"]');if(a){n.find(".amp-widget-add").addClass("amp-hide").removeClass("amp-animate-move-bottom-in");n.find(".amp-widget-drag").removeClass("amp-widget-drag-hide")}else{n.find(".amp-widget-add").removeClass("amp-hide").addClass("amp-animate-move-bottom-in");n.find(".amp-widget-drag").addClass("amp-widget-drag-hide")}if(n.children().hasClass("ampEmptyWidgetPlaceholderFlag")){n.find(".ampEmptyWidgetPlaceholderFlag").removeClass("amp-hide")}}function O(){var e=false;var a=$("#ampPersonalAsideLeftTabHead");var t=a.children(".amp-active").attr("amp-id");if(t=="canUseCards"){e=true}return e}function W(){var e=false;var a=$("#ampDesktopNav");var t=$("#ampDesktopContent");var r=a.find(".amp-active").attr("amp-desktop-id");var i=a.find(".amp-tab-item:first").attr("amp-desktop-id");var n=t.children('[amp-desktop-id="'+r+'"]');if(r==i&&n.children().hasClass("recommedCard")){e=true}return e}function q(e){var a=e;var t=a.siblings(".amp-app-complex-img");var r=t.clone().addClass("clone-img").css("opacity","0.7");var i=$("#ampDesktopContent");var n=$("#ampDesktopNav");var s=n.find(".amp-active").attr("amp-desktop-id");var o=i.children('[amp-desktop-id="'+s+'"]');var p=o.find(".amp-widget-drag-icon").offset().top;var l=o.find(".amp-widget-drag-icon").offset().left;r.css({"z-index":9e3,display:"block",position:"absolute",top:t.offset().top+"px",left:t.offset().left+"px",width:t.width()+"px",height:t.height()+"px"});$("body").append(r);r.animate({top:p,left:l,width:50,height:50},"slow")}function z(e,t){var r=t.desktopId;var i=t.desktopType;var n=t.desktopName;var s=t.cardName;var o="";var p=0;var l="";e.each(function(){var e=$(this).attr("widget-wid");if(e!=a&e!="@widgetWid"){p++;cardSeq=p;l+='{"cardWid":"'+e+'","cardSeq":'+parseInt(cardSeq)+"},"}});l=l.substr(0,l.length-1);if(l==""){return}else{l="["+l+"]"}var o="";var m='{"desktopId":"'+r+'","desktopType":"'+parseInt(i)+'","target":"'+o+'","desktopUserLayoutList":'+l+"}";var t="desktopUserEntityJson="+m;AmpDataUtils.editDesktop(t,function(e){if(e.result==="success"){}})}function J(){var e=$("#ampDesktopNav");var a=$("#ampDesktopContent");var t=e.find(".amp-active").attr("amp-desktop-id");var r=a.find('.amp-tab-content-item[amp-desktop-id="'+t+'"]').find(".amp-widget-add").hasClass("amp-hide");if(r){re()}}function K(e){var a=e.appPcCardBizList;var t=a.length;var r="recommedCard";var i=R({widgets:a,widgetsLen:t,recommCardClass:r});sessionStorage.setItem("recommendCardHtml",i)}function V(){var e=$("#ampDesktopContent");var a=e.find(".recommedCard:first");var t=a.attr("widget-wid");var r={};r.cardWid=t;Y(r)}function Y(a){var t=$("#ampDesktopContent");var r=t.find(".recommedCard:first");var i=a.cardWid;var n=0;var s='{"cardWid":"'+i+'","status":'+parseInt(n)+"}";AmpDataUtils.updateRecommendCardStatus(s,function(a){if(a.result==="success"){var t="删除成功";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("deletedSuccessfully")}AmpPrompt.show({content:t});r.remove();e.showRecommendCrad();Ce()}})}function Z(){var a=$("#ampDesktopContent");var t=$("#ampDesktopNav");var r=t.find(".amp-active").attr("amp-desktop-id");var i=t.find(".amp-active").attr("amp-desktop-type");var n=a.find(".recommedCard:first");var s=n.attr("widget-wid");var o=a.find(".recommedCard:first").index()+1;var p=1;var l='{"desktopId":"'+r+'","desktopType":'+parseInt(i)+',"status":'+parseInt(p)+',"cardWid":"'+s+'","cardSeq":'+parseInt(o)+"}";AmpDataUtils.updateRecommendCardStatus(l,function(a){if(a.result==="success"){var t="添加成功";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("addedSuccessfully")}AmpPrompt.show({content:t});n.removeClass("recommedCard");e.showRecommendCrad()}})}function X(a){var t=$("#ampDesktopContent");var r=$("#ampDesktopNav");var i=t.find(".recommedCard:first");var n=i.attr("widget-wid");var s=i.attr("widget-id");var o=i.attr("app-id");var p=a.attr("desktop-id");var l=a.attr("desktop-type");var m=1;var c='{"desktopId":"'+p+'","desktopType":'+parseInt(l)+',"status":'+parseInt(m)+',"cardWid":"'+n+'"}';i.remove();i.removeClass("recommedCard");e.showRecommendCrad();var d=[];var v={};v.appId=o;v.cardId=s;v.cardWid=n;d.push(v);var f=d.length;var u=R({widgets:d,widgetsLen:f});var g={};g.desktopId=p;g.desktopRecommendCardHtm=u;g.cardWid=n;g.cardId=s;e.space.sessionStorageRecommendData.push(g);$("#ampRecommendShowDesktop").hide();AmpDataUtils.updateRecommendCardStatus(c,function(a){if(a.result==="success"){var t="添加成功";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("addedSuccessfully")}AmpPrompt.show({content:t});i.removeClass("recommedCard");e.showRecommendCrad()}})}function Q(){var e=$("#ampDesktopContent");var a=$("#ampDesktopNav");var t=a.find(".amp-tab-item:first").attr("amp-desktop-id");var r=e.children('[amp-desktop-id="'+t+'"]');var i=sessionStorage.getItem("recommendCardHtml");r.find(".amp-widget-add").before(i);var n=e.children('[amp-desktop-id="'+t+'"]').children();var s=n.length;var o="";n.each(function(){o+=this.outerHTML});n=S(o,s);r.html(o)}function ee(e){var a=e.hasClass("tabhasUnReadMark");if(!a){return false}var t=e.attr("amp-id");var r=$("#ampCategoryTabContent");var i=r.children('[amp-id="'+t+'"]').children().find(".apphasUnReadMark").closest(".amp-app-complex");var n=[];i.each(function(){var e=$(this).attr("amp-appid");var a=$(this).attr("app-card-wid");var t={appId:e,cardWid:a};n.push(t)});ae(n)}function ae(e){var a="";var t=e.length;if(t==0){return false}for(var r in e){var i=e[r].cardWid;var n=e[r].appId;a+='{"appId":"'+n+'","cardWid":"'+i+'"},'}a=a.substr(0,a.length-1);a="["+a+"]";var s='{"userPcCardRecordJson":'+a+"}";AmpDataUtils.updatePcCardMarkStatus(a,function(e){if(e.result==="success"){}})}function te(){var e=sessionStorage.getItem("tagMessagesHtm");var a=$("#ampTagMessages");if(!e){var t="暂无未读消息";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("noUnreadMessages")}var r=AmpTemplate.getPersonalEmptyPage(t);e=r}a.html(e)}function re(){lct=document.getElementById("ampDesktopContent");lct.scrollTop=Math.max(0,lct.scrollHeight-lct.offsetHeight+480);$("#ampDesktopContent").getNiceScroll().resize();setTimeout(function(){AmpPersonalCenter.showRecommendCrad()},450)}e.showCanUseCardEmptyPage=function(){ie()};function ie(){var e=$("#ampPersonalAsideLeftCanUseCards");var a=$("#ampDesktopNav");var t=a.find(".amp-tab-item").filter("[amp-desktop-id]").length;if(t==0){var r="请先在右侧新建桌面，方可添加应用卡片";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("pleaseCreateANewDesktop")}var i=$("#tpl-CanUseCards-ampty-page").html().replace("@pleaseCreateANewDesktop",r);e.children().css("display","none");e.append(i)}}function ne(){var e=$("#ampDesktopNav");var a=e.find(".amp-tab-item");var t=a.filter("[amp-desktop-type]").length;var r="";var i="";var n="";var s=false;var o="";var p="";if(t<=4){return}else{a.each(function(e){if($(this).filter("[amp-desktop-id]").length==1&&e<4&&!$(this).hasClass("amp-desktop-admin")){r+=$(this)[0].outerHTML}else if($(this).filter("[amp-desktop-id]").length==1&&e>=4&&!$(this).hasClass("amp-desktop-admin")){if($(this).find("span").hasClass("amp-admin-new-desktopnav")){s=true}if($(this).hasClass("amp-active")){o="amp-desktop-admin-active"}i+=$(this)[0].outerHTML}else if(!$(this).hasClass("amp-desktop-admin")){n+=$(this)[0].outerHTML}});if(s){p='<span class="amp-admin-new-desktopnav"></span>'}var l='<div class="amp-desktopnav-more amp-animated-fast" id="ampDesktopNavMore">'+i+"</div>";r+='<div class="amp-tab-item amp-desktop-nav-icon amp-desktop-admin amp-desktop-nav-btn '+o+'">'+'<i class="iconfont icon-gengduo"></i>'+p+l+"</div>";e.html(r+n);AmpUtils.niceScrollInit($("#ampDesktopNavMore"))}}e.showAdminNewDesktop=function(){var e=$("#ampDesktopContent");var a=$("#ampDesktopNav");var t=e.children(".amp-active").attr("id");var r="";if(a.find(".amp-tab-item.amp-active").find("span").length==1){r=AmpTemplate.getAdminNewDesktopHtm()}if($("#ampAdminNewDesktopRecommed").length>0){$("#ampAdminNewDesktopRecommed").remove()}$("#"+t+"").append(r)};function se(e){var a=$("#ampDesktopContent");var t=$("#ampDesktopNav");t.find(".amp-tab-item.amp-active").find("span").remove();a.children(".amp-active").children(".amp-admin-new-desktop-recommed").remove();var r=t.find(".amp-tab-item.amp-active").parent().hasClass("amp-desktopnav-more");var i=t.find(".amp-tab-item.amp-active").parent().find(".amp-tab-item span").length;if(r&&i==0){t.find(".amp-tab-item.amp-desktop-admin").find("span").remove()}var n=t.find(".amp-tab-item.amp-active").attr("amp-desktop-id");oe(n)}function oe(e){var a=e;AmpDataUtils.updateUserDesktopStatus(a,function(e){if(e.result=="success"){}})}function pe(){var e=$("#ampPersonalAsideLeftTabHead");h(e.find(".amp-tab-item:nth-child(2)"))}function le(e){var a=new Object;var t=[];var r=false;var i="全部";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("all")}a.categoryName=i;if(e){var n=e.length;for(var s=0;s<n;s++){for(var o in e[s].appList){t.push(e[s].appList[o])}if(e[s].hasUnReadMark){r=true}}a.appList=t;if(r){a.hasUnReadMark=true}}return a}function me(e){var a;var t=e.parent().attr("cardnickname");var r=e.parent().attr("app-card-wid");var i=$("#ampDesktopNav");var n=$("#ampDesktopContent");var s=i.find(".amp-active").attr("amp-desktop-id");var o=n.children('[amp-desktop-id="'+s+'"]');var p=o.children('[widget-wid="'+r+'"]');if(p.length>0){a=false}else{a=true}return a}function ce(e){var a=e.closest(".amp-create-desktop");a.removeClass("amp-animate-move-top-in").addClass("amp-animate-move-top-out");setTimeout(function(){a.siblings(".ampDesktopAddFlag").removeClass("amp-btn-active");a.remove();if($(".empty-desktop-create")&&$(".empty-desktop-create").length==1){$(".empty-desktop-create").removeClass("amp-btn-active")}},250)}function de(e){var a=$("#ampCreateDesktopInput").val();if(a){var t=a;var r="desktopName="+encodeURI(t);AmpDataUtils.desktopCreat(r,function(a){if(a.result=="success"){ce(e);D(a,t);var r=$("#ampPersonalAsideLeftCanUseCards");$(".amp-empty-page").remove();r.children().css("display","block");$("#ampDesktopNav").find(".ampDesktopAddFlag").removeClass("amp-btn-active")}else{var i="创建桌面失败";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("failedToCreateADesktop")}AmpPrompt.show({content:i})}});AmpUtils.zhuge("创建桌面",{"桌面名称":a,"来源":"点页面上方桌面名称后的+号"})}else{}}e.setPcDesktopToolAddOrDrag=function(e){var a=$("#ampDesktopNav");var t=$("#ampDesktopContent");var r=a.find(".amp-active").attr("amp-desktop-id");var i=t.find('.amp-tab-content-item[amp-desktop-id="'+r+'"]');if(!e){i.find(".amp-widget-add").addClass("amp-hide").removeClass("amp-animate-move-bottom-in");i.find(".amp-widget-drag").removeClass("amp-widget-drag-hide")}else{i.find(".amp-widget-add").removeClass("amp-hide").addClass("amp-animate-move-bottom-in");i.find(".amp-widget-drag").addClass("amp-widget-drag-hide")}};function ve(){var e=$("#ampDesktopNav");var a=$("#ampDesktopContent");var t=e.find(".amp-active").attr("amp-desktop-id");var r=a.children('[amp-desktop-id="'+t+'"]');var i=r.children();i.each(function(e){var a=$(this);var t=a.find('div[has-scroll="true"]');t.each(function(){if($(this).attr("has-scroll-show")=="true"){AmpUtils.niceScrollShow($(this))}else{AmpUtils.niceScrollInit($(this))}});if(a.find("amp-w-frame").attr("has-scroll")==="true"){AmpUtils.niceScrollInit(a.find(".amp-wf-body"));a.find(".amp-wf-body").getNiceScroll().resize()}})}e.initSortingCards=function(){y()};e.setDesktopBlurHtm=function(){var e=parseInt($("#ampDesktopContent").width()/540);var a=AmpTemplate.getDesktopBlurItemsHtm(e);$("#amp-desktopBlur").html(a)};e.setCreateDesktopPosition=function(){var e=$("#ampDesktopNav").find(".ampDesktopAddFlag");if(e.length>0){var a=e.offset().left-$("#ampPersonalAsideLeft").width()-16;$("#ampAdminNewDesktop").css("left",""+a+"px")}};e.openAsideBoxConfig=function(){var e=AMPConfigure.personalCenterAsideOpenConfig;var t=$("#ampPersonalAsideLeftMini").find('.amp-aside-box-mini-item[amp-id="myFavorite"]');var r=$("#ampPersonalAsideRightMini").find('.amp-aside-box-mini-item[id="zqfwTask"]');var i=localStorage.leftAsideOpenFlag!=a?localStorage.leftAsideOpenFlag:e.charAt(0);var n=localStorage.rightAsideOpenFlag!=a?localStorage.rightAsideOpenFlag:e.charAt(1);i=i==""?0:i;n=n==""?0:n;var s=""+i+n;var o=$("#ampPersonalAsideLeft");var p=$("#ampPersonalAsideRight");if(s=="01"){if(p.hasClass("amp-mini")){r.click()}}else if(s=="10"){if(o.hasClass("amp-mini")){t.click()}}else if(s=="11"){if(p.hasClass("amp-mini")){setTimeout(function(){var e=$("#ampDesktopContent");var a=540;var t=$(window).width();var i=a+e.offset().left;if(t-i>312){r.click()}},450)}if(o.hasClass("amp-mini")){t.click()}}};function fe(){setTimeout(function(){localStorage.changeLanguageFlag="false";$("#ampProgressBar").removeClass("amp-active").addClass("amp-hide")},0)}function ue(e){var a=e;if(AmpIsPortalCustom.sortDesktopData&&typeof AmpIsPortalCustom.sortDesktopData=="function"){a=AmpIsPortalCustom.sortDesktopData(e)}return a}function ge(e){if(AmpIsPortalCustom.desktopOverallInte&&typeof AmpIsPortalCustom.desktopOverallInte=="function"){AmpIsPortalCustom.desktopOverallInte(e);s();return false}return true}function he(){if(AmpIsPortalCustom.personalCenterCallback&&typeof AmpIsPortalCustom.personalCenterCallback=="function"){AmpIsPortalCustom.personalCenterCallback();return true}return false}e.setCustomDesktopCenter=function(e,t){var r=$("#ampDesktopNav");var i=r.find(".amp-tab-item:first").hasClass("amp-active");e=e==a?"left":e;if(t==a){if(localStorage.leftAsideOpenFlag=="1"){t="normal"}else{t="mini"}}if(typeof AMPConfigure.desktop_custom!="undefined"&&AMPConfigure.desktop_custom.pccard_customization&&i){cardWidth=Ae();AmpDesktopCommon.setDesktopWidth(e,t,cardWidth)}else{AmpDesktopCommon.setDesktopWidth(e,t)}};function Ae(){var e=540;if(AmpIsPortalCustom.setCustomCardWidth&&typeof AmpIsPortalCustom.setCustomCardWidth=="function"){e=AmpIsPortalCustom.setCustomCardWidth()}return e}function Ce(){var e=$("#ampDesktopContent");var a=$("#ampDesktopNav");var t=a.find(".amp-active").attr("amp-desktop-id");var r=e.children('[amp-desktop-id="'+t+'"]');var i=r.children();var n=r.find(".amp-desktop-tool");if(i.length>2){n.addClass("amp-tool-hide")}else{n.removeClass("amp-tool-hide")}}})(window.AmpPersonalCenter=window.AmpPersonalCenter||{});(function(e,a){e.space={clickMiNiTab:null,lazyComplete:true,loadingCount:0};$("#ampPersonalAsideRightMini").on("click",".amp-aside-box-mini-item",function(){localStorage.rightAsideOpenFlag="1";var a=$(this).attr("id");e.space.clickMiNiTab=a;o($(this));AmpPersonalCenter.setCustomDesktopCenter("right","normal");setTimeout(function(){if(AmpGlobal.platformType!="0"){AmpPersonalCenter.showRecommendCrad();AmpPersonalCenter.setCreateDesktopPosition()}AmpPersonalCenter.setDesktopBlurHtm();AmpPersonalCenter.showAdminNewDesktop()},750)});$("#ampPersonalAsideRightTabHead").on("click",".amp-tab-item",function(){var e=$(this);p();t(e);var a=e.attr("amp-id");if(a==="message"){AmpUtils.zhuge("查看未读消息",{})}else{AmpUtils.zhuge("打开任务中心",{})}});$("#ampPersonalAsideRightTask").on("click",".amp-personal-aside-right-task-item",function(){localStorage.rightAsideOpenFlag="0";v($(this))});$("#ampPersonalAsideRightClose").on("click",function(){localStorage.rightAsideOpenFlag="0";if(navigator.userAgent.indexOf("MSIE 9.0")>0){setTimeout(function(){AmpPersonalCenter.setCustomDesktopCenter("right","mini")},450)}else{AmpPersonalCenter.setCustomDesktopCenter("right","mini")}setTimeout(function(){if(AmpGlobal.platformType!="0"){AmpPersonalCenter.showRecommendCrad();AmpPersonalCenter.setCreateDesktopPosition()}AmpPersonalCenter.setDesktopBlurHtm();AmpPersonalCenter.showAdminNewDesktop()},750)});$("#ampPersonalAsideRightTask").on("click",".right-side-do-more",function(){var e=$(this).parent();var a=e.attr("id");if(a=="ampPersonalAsideRightLcgzTaskItem"){window.open(AMPConstant.taskCenterRequestPath+"sys/taskCenter/*default/index.do#/processTrack","_blank")}else if(a=="ampPersonalAsideRightDbTaskItem"){window.open(AMPConstant.taskCenterRequestPath+"sys/taskCenter/*default/index.do#/todoTask","_blank")}});$("#ampPersonalAsideRightTask").on("click",".amp-card-service-item",function(e){var a=$(e.target);var t=a.closest(".amp-personal-aside-right-task-item-content").attr("id");if(a.closest(".view-comment").length){u(a)}else if(a.closest(".check-flow").length){f(a)}else{if(t!=="ampPersonalAsideRightZqfwTaskItem"){var r=a.closest(".aside-process-item");var i=r.attr("url");var n=r.attr("appid");var s=r.attr("taskid");if(i&&i!="undefined"&&i!="null"){window.open(i,"_blank");if(r.closest(".amp-personal-aside-right-task-item-content").attr("id")=="ampPersonalAsideRightDbTaskItem"){var o={};o.APP_ID=n;o.TASK_ID=s;AmpDataUtils.updateReceiveDate(o,function(e){})}}}}});g();function t(t){if(t.hasClass("amp-active")){if(e.space.clickMiNiTab!=a&&e.space.clickMiNiTab!=null){if(!r($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))){v($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))}}return}var n=t.attr("amp-id");var o=t.closest(".amp-tab");var p=o.find(".amp-tab-content");var l=o.find(".amp-tab-item.amp-active");var m=l.attr("amp-id");l.removeClass("amp-active");p.children('[amp-id="'+m+'"]').addClass("amp-hide");t.addClass("amp-active");p.children('[amp-id="'+n+'"]').removeClass("amp-hide");if(n==="message"){s();$("#ampPersonalAsideRightTask").css("display","none");$("#ampPersonalAsideRightMessage").css("display","block");AmpUtils.setScroll($("#ampTagMessages"),1)}else{i();$("#ampPersonalAsideRightTask").css("display","block");$("#ampPersonalAsideRightMessage").css("display","none");if(e.space.clickMiNiTab!=a&&e.space.clickMiNiTab!=null){if(!r($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))){v($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))}}AmpUtils.setScroll($("#ampPersonalAsideRightTask"),1);var c=parseInt($.trim($("#taskSumCount").text()))==""?0:$.trim($("#taskSumCount").text());if(!c){$("#ampTaskEmptyPage").removeClass("amp-hide");$("#ampPersonalAsideRightTask").find(".ampTaskArrowFlag").remove()}}}function r(e){var a=false;var e=e;var t=e.closest("div.amp-personal-aside-right-task-box");var r=t.find(".amp-personal-aside-right-task-item-content");if(!r.hasClass("amp-hide")){a=true}return a}function i(){var e;var a=AmpPersonalCenter.space.hasRightSideData;var t=$("#ampPersonalAsideRightTask");if(a){t.find(".hasAsideRIghtFlag").removeClass("amp-hide");var r=parent.window.AMPConfigure.taskcenterDataRefreshTime||1;var i=parseInt(r)*6e4;n(true);window.setInterval(function(){n(false)},i)}else{t.find(".hasAsideRIghtFlag").addClass("amp-hide")}var s={};s.pageNumber="1";s.pageSize="20";AmpDataUtils.getTaskZqfwData(s,function(e){c(e)})}function n(e){var a=JSON.parse(sessionStorage.getItem("ampTaskCenterDatas"));var t=a.queryTodoTask;var r=a.queryProcessTrack;m(t,"1",e);m(r,"3",e)}function s(){var e=$("#ampTagMessages");if($.trim(e.html()).length===0){AmpMessage.show()}}function o(e){var a=e.attr("amp-id");$("#ampPersonalAsideRightMini").find(".amp-active").removeClass("amp-active");$("#ampPersonalAsideRightTabHead").find('[amp-id="'+a+'"]').click();var t=$("#ampPersonalAsideRight");if(a=="message"){t.off("animationend").on("animationend",function(){AmpUtils.setScroll($("#ampTagMessages"),1)});$("#ampPersonalAsideRightTask").css("display","none");$("#ampPersonalAsideRightMessage").css("display","block");AmpUtils.checkEvent(function(){return $("#ampPersonalAsideRightMessage").offset().left>0},function(){AmpUtils.setScroll($("#ampTagMessages"),1)})}else if(a=="task"){t.off("animationend").on("animationend",function(){AmpUtils.setScroll($("#ampPersonalAsideRightTask"),1)});$("#ampPersonalAsideRightTask").css("display","block");$("#ampPersonalAsideRightMessage").css("display","none");AmpUtils.checkEvent(function(){return $("#ampPersonalAsideRightTask").offset().left>0},function(){AmpUtils.setScroll($("#ampPersonalAsideRightTask"),1)})}}function p(){var e=parent.window.AMPConfigure.taskcenterDataRefreshTime||1;var a=parseInt(e)*6e4;l();window.setInterval(function(){l()},a)}function l(){var e=$("#taskSumCount");var a=sessionStorage.getItem("taskCount");var t=sessionStorage.getItem("zqfwCount");var r=parseInt(a)+parseInt(t);if(parseInt(r)!="0"){e.text(r);if(parseInt(e.text())){$('#ampPersonalAsideRightTabHead [amp-id="task"]').find(".amp-red-corner").removeClass("amp-hide")}}}function m(t,i,n){taskData=t.taskData;taskDataTotal=t.taskDataTotal;var s=0;var o="";var p="";if(taskData){s=taskDataTotal-taskData.length;for(var l=0;l<taskData.length;l++){o+=AmpTemplate.getAsideRightTaskItem(taskData[l],i)}}if(i=="1"){var m="打开待办事项>";var c="查看更多";var d="项";if(AmpGlobal.currentLang=="en_US"){m=$.i18n("openTodoList");c=$.i18n("seeMore");d=$.i18n("itemCard")}if(taskDataTotal<6){p=$("#tpl-aside-right-process-item-open").html().replace("@text",m)}else{p=$("#tpl-aside-right-process-item-more").html().replace("@total",s).replace("@seeMore",c).replace("@item",d)}$("#ampPersonalAsideRightDbTaskItem").html(o+p);$("#dbTaskCountTotal").text(taskDataTotal);var f=$(window).height()-215;if(taskDataTotal*70+30>f){$("#ampPersonalAsideRightDbTaskItem").css("height",f);$("#ampPersonalAsideRightDbTaskItem").niceScroll()}}else if(i=="3"){var m="打开流程跟踪>";var c="查看更多";var d="项";if(AmpGlobal.currentLang=="en_US"){m=$.i18n("openProcessTracking");c=$.i18n("seeMore");d=$.i18n("itemCard")}if(taskDataTotal<6){p=$("#tpl-aside-right-process-item-open").html().replace("@text",m)}else{p=$("#tpl-aside-right-process-item-more").html().replace("@total",s).replace("@seeMore",c).replace("@item",d)}$("#ampPersonalAsideRightLcgzTaskItem").html(o+p);$("#lcgzTaskCountTotal").text(taskDataTotal);var u=$(window).height()-215;if(taskDataTotal*70+30>u){$("#ampPersonalAsideRightLcgzTaskItem").css("height",u);$("#ampPersonalAsideRightLcgzTaskItem").niceScroll()}}if(e.space.clickMiNiTab!=a&&e.space.clickMiNiTab!=null){if(!r($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))){if(n){v($('.ampTaskArrowFlag[amp-id="'+e.space.clickMiNiTab+'"]'))}}}}function c(e){var a=$("#ampPersonalAsideRightZqfwTaskItem");var t=e.hasAndReadyToOpenServiceList;var r=e.totalSize;var i="";if(t.length==0){if(a.children().length==0){A()}}else{if(t.length<20&&t.length>0){A()}if(t){t.forEach(function(e){i+=AmpTemplate.getAsideRightTaskZqfwItem(e)})}}a.html(i);$("#zqfwTaskCountTotal").text(r);var n=$(window).height()-215;if(t.length*70+30>n){a.css("height",n);a.niceScroll()}return}function d(){var e="享受轻松的时光吧~您没有任务";if(AmpGlobal.currentLang=="en_US"){e=$.i18n("enjoy")+"~"+$.i18n("noTask")}return AmpTemplate.getPersonalAsideRightZqfwEmptyPage(e)}function v(e){var a=$.trim($("#ampzqfwTaskCount").text())==""?0:$.trim($("#ampzqfwTaskCount").text());var t=$.trim($("#ampDbTaskCount").text())==""?0:$.trim($("#ampDbTaskCount").text());var r=$.trim($("#ampLcgzTaskCount").text())==""?0:$.trim($("#ampLcgzTaskCount").text());var i=parseInt(a)+parseInt(t)+parseInt(r);if(!i){$("#ampTaskEmptyPage").removeClass("amp-hide");$("#ampPersonalAsideRightTask").find(".ampTaskArrowFlag").remove()}else{var e=e;var n=e.closest("div.amp-personal-aside-right-task-box");var s=n.find(".amp-personal-aside-right-task-item-content");if(s.children().length==0&&n.find(".ampPersonalAsideRightZqfwTaskItemFlag").length==0){return}if(s.hasClass("amp-hide")){s.slideDown(500);s.removeClass("amp-hide").addClass("amp-active");n.addClass("amp-aside-right-box-expand")}else{s.slideUp(500,function(){s.addClass("amp-hide").removeClass("amp-active")});n.removeClass("amp-aside-right-box-expand")}var o=n.siblings(".amp-personal-aside-right-task-box").find(".amp-personal-aside-right-task-item-content");o.each(function(){$(this).slideUp(500,function(){n.siblings(".amp-personal-aside-right-task-box").removeClass("amp-aside-right-box-expand");$(this).addClass("amp-hide");$(this).hide()})})}}function f(e){var e=e;var a=e.attr("appId");var t=e.attr("processIntanceId");var r=parent.window.AMPConstant.taskCenterRequestPath+"sys/taskCenter/*default/index.do?min=1#/flowChart/"+a+"/"+t;window.open(r,"_blank")}function u(e){var a=e.attr("appId");var t=e.attr("processIntanceId");var r=AMPConstant.taskCenterRequestPath+"sys/taskCenter/*default/index.do?min=1#/flowComments/"+a+"/"+t;var i="查看办理意见";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("checkAdvice")}window.AmpDialog({title:i,height:500,remote:{url:r}})}function g(){$("#ampPersonalAsideRightTask").on("scroll",function(){var a=$(this);var t=$("#ampPersonalAsideRightZqfwTaskItem"),r=a.height(),i=a.get(0).scrollHeight,n=a.scrollTop();if(i-r-n-110<=0){var s=t.children().length;if(e.space.lazyComplete){var o={};o.pageNumber=""+parseInt(s/20+1)+"";o.pageSize="20";h(o)}}})}function h(a){e.space.lazyComplete=false;AmpDataUtils.getTaskZqfwData(a,function(a){c(a);e.space.lazyComplete=true})}function A(){$("#ampPersonalAsideRightTask").off("scroll")}})(window.AmpPersonalRightAside=window.AmpPersonalRightAside||{});(function(e,a){})(window.AmpRightAsideCard=window.AmpRightAsideCard||{});(function(e,a){e.loadWidgetComplete=function(e,a){t(e,a)};e.addLoadingToWidget=function(e){r(e)};function t(e,a){$("body").find(e).each(function(){var e=$(this).parent();e.addClass("ampLoadingCompleteFlag");AmpLoading.close({container:e})})}function r(e){e.find("div.amp-widget:not(.ampLoadingCompleteFlag)").each(function(){var e=$(this);if(e.hasClass("ampEmptyWidgetPlaceholderFlag")){return}if(e.children().children().length===0){AmpLoading.show({type:"breath",container:e,customClass:"amp-border-radios-12"})}})}})(window.AmpWidgetUtils=window.AmpWidgetUtils||{});(function(e,a){e.space={leftAsideWidth:416+20,leftAsideMiniWidth:60,rightAsideWidth:312+20,rightAsideMiniWidth:60,widgetWidth:540+16};e.setDesktopWidth=function(a,r,i){if(typeof i!="undefined"){e.space.widgetWidth=i+16}else{e.space.widgetWidth=540+16}t(a,r)};function t(a,t){var n=e.space;var s=n.leftAsideWidth;var o=n.leftAsideMiniWidth;var p=n.rightAsideWidth;var l=n.rightAsideMiniWidth;var m=window.innerWidth;var c=$("#ampPersonalMainWidgetSection");var d=c.attr("amp-left-state");var v=c.attr("amp-right-state");var f=0;var u=0;var g="";if(a==="left"){if(t==="mini"){if(v==="normal"){u=o;f=m-o-p}}else{u=s;if(v==="mini"){f=m-s-l}else{if(r(m)){f=m-s-p}else{g="right";f=m-s-l}}}}else{if(t==="mini"){if(d==="normal"){u=s;f=m-s-l}}else{if(d==="mini"){u=o;f=m-o-p}else{if(r(m)){u=s;f=m-s-p}else{u=o;g="left";f=m-o-p}}}}var h=i(m,f);if(g==="left"){$("#ampPersonalAsideLeft").addClass("amp-mini");c.attr("amp-left-state","mini")}else if(g==="right"){$("#ampPersonalAsideRight").addClass("amp-mini");c.attr("amp-right-state","mini")}if(f===0&&u===0){c.removeAttr("style")}else{c.css({left:u+"px",width:f+"px"})}c.attr("amp-"+a+"-state",t);$("#ampDesktopNav").css({"padding-left":h+"px"});$("#ampDesktopContent").css({"padding-left":h+"px"}).getNiceScroll().resize()}function r(a){var t=true;var r=e.space;var i=r.leftAsideWidth;var n=r.rightAsideWidth;var s=r.widgetWidth;if(a-i-n<s){t=false}return t}function i(a,t){var r=e.space;var i=r.leftAsideMiniWidth;var n=r.rightAsideMiniWidth;if(!t){t=a-i-n-16}var s=r.widgetWidth;var o=parseInt(t/s,10);var p=s*o;var l=parseInt((t-p)/2,10);return l+8}})(window.AmpDesktopCommon=window.AmpDesktopCommon||{});(function(e,a){e.space={inputLockFlag:false};e.init=function(e){t()};function t(){AmpDataUtils.getUserDesktopProperty(function(e){var a=r(e);$("body").append(a);setTimeout(function(){i()},10)})}function r(e){var a={};var t=e.desktopUserConfList;var r=parseInt(t.length,10);var i="";var n=0;var s=false;var o=window.navigator.userAgent;if(!!window.ActiveXObject||"ActiveXObject"in window){if(o.indexOf("MSIE")>0){var p=o.match(/MSIE \d+/i);var l=p[0].match(/\d+/i);if(parseInt(l)<=10){s=true}}}if(t!==null||r!==0){for(var m=0;m<r;m++){var c=t[m].desktopId;var d=t[m].desktopName;var v=t[m].desktopType;if(v=="1"){n++}var f=t[m].isDelete;var u=t[m].isReset;var g=t[m].desktopSeq;var h=f==0?"set-shanchu":"";var A=u==0?"set-refresh":"";var C="";if(!v){var k="默认桌面 ";if(AmpGlobal.currentLang=="en_US"){k=$.i18n("defaultDesktop")}C="( "+k+")"}var b="重置";var S="删除";var y="8";var w="";var P="padding-right-55";if(AmpGlobal.currentLang=="en_US"){b=$.i18n("recover");S=$.i18n("delete");y=$.i18n("desktopLength");if(s){w="right-45";P=""}}i+=$("#tpl-desktop-set-container").html().replace("@desktopId",c).replace("@desktopName",d).replace("@desktopType",v).replace("@setRefresh",A).replace("@setShanchu",h).replace("@desktopSeq",g).replace("@defaultDesktopMessage",C).replace("@recover",b).replace("@delete",S).replace("@desktopLength",y).replace("@desktopLength",y).replace("@rightNumClass",w).replace("@textPaddingRight",P)}}var I=r;var i=i;var U="新建的桌面";var D="桌面设置";var T="共 ";var L=" /3个自建桌面";var F="完成";var x="保存该桌面？";var H="新建";var y="8";var w="";var P="padding-right-55";if(AmpGlobal.currentLang=="en_US"){U=$.i18n("newDesktop");D=$.i18n("desktopSettings");T=$.i18n("desktopSettingPre");L=$.i18n("desktopSettingEnd");F=$.i18n("complete");x=$.i18n("saveDesktop");H=$.i18n("create");y=$.i18n("desktopLength");if(s){w="right-45";P=""}}var M=$("#tpl-desktop-set-creat-container").html().replace("@newDesktop",U).replace("@create",H).replace("@saveDesktop",x).replace("@desktopLength",y).replace("@desktopLength",y).replace("@rightNumClass",w).replace("@textPaddingRight",P);var N=$("#tpl-desktop-set-page").html().replace("@desktopListCount",I).replace("@desktopListHtml",i).replace("@deskopsetCreatHtml",M).replace("@desktopSettings",D).replace("@aTotalOf",T).replace("@desktops",L).replace("@complete",F);return N}function i(){$(".amp-desktop-set-wrap").addClass("amp-active");e.setContainerMaxHeight();AmpUtils.niceScrollInit($(".amp-desktop-set-container"));n();s();l()}e.setContainerMaxHeight=function(){var e=$(window).height();var a=e-44-60*2;var t=a-90-104;$("#ampDesktopSet").find(".amp-desktop-set-container").css({"max-height":t+"px"})};function n(){var e=Sortable.create(ampDesktopSortContainer,{handle:".amp-desktop-set-drag-icon",animation:150,filter:".widget-del-btn",onEnd:function(){var e="";$("#ampDesktopSortContainer").find(".amp-desktop-set-list").each(function(){var a=$(this);var t=a.attr("amp-desktop-id");var r=a.index();var i=a.attr("amp-desktop-type");e+='{"desktopId":"'+t+'","desktopSeq":"'+r+'","desktopType":"'+i+'"},'});e=e.substr(0,e.length-1);e="["+e+"]";AmpDataUtils.updateUserDesktopSeq(e,function(e){if(e.result==="success"){var a="排序成功";if(AmpGlobal.currentLang=="en_US"){a=$.i18n("sortedSuccessfully")}AmpPrompt.show({content:a})}});AmpUtils.zhuge("桌面排序",{})}})}function s(){var a=$("#ampDesktopSet");$(window).resize(function(){e.setContainerMaxHeight()});a.on("click",".amp-desktop-set-close-icon,.amp-desktop-set-close-btn",function(){m()});a.on("click",".amp-desktop-set-list-name",function(e){var a=$(e.currentTarget);var t=a.siblings(".amp-desktop-set-list-input-container");var r=a.find("span.desktopName").text();if(r==""){var i="新建的桌面";if(AmpGlobal.currentLang=="en_US"){i=$.i18n("newDesktop")}r=i}a.hide().closest(".amp-desktop-set-list");t.show().find(".amp-desktop-set-list-input").attr("data-old-val",r);t.show().find(".amp-desktop-set-list-input").val(r).focus();o(t)});$(".amp-desktop-set-list-input").on("input",function(a){if(!e.space.inputLockFlag){var t=$(a.currentTarget).closest(".amp-desktop-set-list-input-container");o(t)}}).on("compositionstart",function(){e.space.inputLockFlag=true}).on("compositionend",function(a){e.space.inputLockFlag=false;if(!e.space.inputLockFlag){var t=$(a.currentTarget).closest(".amp-desktop-set-list-input-container");o(t)}});$("#ampDesktopSortContainer").on("input",".amp-desktop-set-list-input",function(a){if(!e.space.inputLockFlag){var t=$(a.currentTarget).closest(".amp-desktop-set-list-input-container");o(t)}});a.on("blur",".amp-desktop-set-list-input",function(e){var a=$(e.currentTarget);if(a.closest(".amp-desktop-set-list").attr("id")=="ampDesktopCreatContainer"){return false}var t=a.val();if($.trim(t)==""){a.focus();var r="桌面不能为空";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("cannotBeEmpty")}AmpPrompt.show({content:r});return false}if(a.attr("id")=="ampdesktopSetCreateInput"){return false}var i={};if(t){a.closest(".amp-desktop-set-list").removeClass("amp-desktop-set-list-focus-bg");a.closest(".amp-desktop-set-list-input-container").hide().siblings(".amp-desktop-set-list-name").show().find("span.desktopName").text(t);var n=a.closest(".amp-desktop-set-list").attr("amp-desktop-id");var s=a.closest(".amp-desktop-set-list").attr("amp-desktop-type");var o="1";var r="重命名成功";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("renameSuccessfully")}i.desktopName=t;i.desktopId=n;i.desktopType=s;i.target=o;i.desc=r;p(i,a);AmpUtils.zhuge("修改桌面名称",{"桌面新名称":t,"桌面旧名称":a.attr("data-old-val")})}});var t="确认删除该桌面？";var r="确认恢复默认配置？";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("confirmToDelete");r=$.i18n("confirmToRestore")}a.on("click",".amp-desktop-set-restore-icon",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-bg-color-primary-hover-lv4").addClass("amp-desktop-set-list-yellow-bg");a.closest(".amp-desktop-set-list-toolbar").addClass("hide").siblings(".amp-desktop-set-list-confirm").show().attr("amp-btn-role","restore");a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-confirm-text").text(r)});a.on("click",".amp-desktop-set-delete-icon",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-bg-color-primary-hover-lv4").addClass("amp-desktop-set-list-yellow-bg");a.closest(".amp-desktop-set-list-toolbar").addClass("hide").siblings(".amp-desktop-set-list-confirm").show().attr("amp-btn-role","delete");a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-confirm-text").text(t)});a.on("click",".amp-cancel-btn",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4");a.closest(".amp-desktop-set-list-confirm").hide().siblings(".amp-desktop-set-list-toolbar").removeClass("hide")});a.on("click",".amp-confirm-btn",function(e){var a=$(e.currentTarget);var t=a.closest(".amp-desktop-set-list");var r=t.attr("amp-desktop-id");var i=a.closest(".amp-desktop-set-list-confirm").attr("amp-btn-role");var n={desktopId:r};if(i==="delete"){n.type="delete";t.remove();var s=parseInt($("#ampDesktopSortContainer").find(".amp-desktop-set-list").length,10);$("#desktopCount").text(s);var n={};var o=a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-name").find("span.desktopName").html();var r=a.closest(".amp-desktop-set-list").attr("amp-desktop-id");var l=a.closest(".amp-desktop-set-list").attr("amp-desktop-type");var m="3";var c="删除成功";if(AmpGlobal.currentLang=="en_US"){c=$.i18n("deletedSuccessfully")}n.desktopName=o;n.desktopId=r;n.desktopType=l;n.target=m;n.desc=c;p(n,a);AmpUtils.zhuge("删除桌面",{"桌面名称":o})}else{a.closest(".amp-desktop-set-list").removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4");a.closest(".amp-desktop-set-list-confirm").hide().siblings(".amp-desktop-set-list-toolbar").removeClass("hide");var n={};var o=a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-name").find("span.desktopName").html();var r=a.closest(".amp-desktop-set-list").attr("amp-desktop-id");var l=a.closest(".amp-desktop-set-list").attr("amp-desktop-type");var m="2";var c="恢复成功";if(AmpGlobal.currentLang=="en_US"){c=$.i18n("recoveredSuccessfully")}n.desktopName=o;n.desktopId=r;n.desktopType=l;n.target=m;n.desc=c;p(n,a);AmpUtils.zhuge("恢复桌面默认设置",{"桌面名称":o})}});a.on("click",".create",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-bg-color-primary-hover-lv4").addClass("amp-desktop-set-list-yellow-bg");a.closest(".amp-desktop-set-list-center").find(".amp-desktop-set-list-name").hide().siblings(".amp-desktop-set-list-input-container").show();a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-confirm").show().attr("amp-btn-role","delete");$("#ampdesktopSetCreateInput").focus()});a.on("click",".amp-create-cancel-btn",function(e){var a=$(e.currentTarget);a.closest(".amp-desktop-set-list").removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4");a.closest(".amp-desktop-set-list-confirm").hide().removeClass("hide");a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-name").show();a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-input-container").hide()});a.on("click",".amp-create-save-btn",function(e){c()})}function o(e){var a=e.find(".amp-desktop-set-list-input").val();var t=parseInt(a.length,10);e.find('span[amp-input-role="actual"]').text(t)}function p(e,a){var t=e.desktopName;var r=e.desktopId;var i=e.desktopType;var n=e.target;var s=e.desc;var o='{"desktopName":"'+encodeURI(t)+'","desktopId":"'+r+'","desktopType":"'+parseInt(i)+'","target":"'+n+'"}';var p="desktopUserEntityJson="+o;AmpDataUtils.editDesktop(p,function(e){if(e.result==="success"){AmpPrompt.show({content:s});if(n=="2"){a.closest(".amp-desktop-set-list").find(".amp-desktop-set-list-name").find("span.desktopName").text(e.desktopName)}}l()})}function l(){var e=$("#ampDesktopSortContainer");var a=$("#ampDesktopCreatContainer");var t=e.children().filter('[amp-desktop-type="1"]').length;var r="共";var i="/3个自建桌面";var n="您的桌面数量已满";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("desktopSettingPre");i=$.i18n("desktopSettingEnd");n=$.i18n("fullDesktopNum")}if(t>2){a.css("display","none");$(".amp-desktop-set-subTitle").text(r+"3"+i+","+n)}else{a.css("display","block");$(".amp-desktop-set-subTitle").text(r+t+i);a.removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4");a.find(".amp-desktop-set-list-confirm").hide().removeClass("hide");a.find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-name").show();a.find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-input-container").hide()}}function m(){var e=$(".amp-desktop-set-wrap");e.removeClass("amp-active");setTimeout(function(){AmpDataUtils.userDesktopInfo("",function(a){AmpUtils.currentPageBlurAnimate("restore");e.remove();var t=$("#ampPersonalArticle");if(navigator.userAgent.indexOf("MSIE")>0||AmpUtils.isIE()){if($("#ampPageHeaderPersonalIcon").hasClass("amp-active")){t.addClass("amp-active").removeClass("amp-hide")}}else{if($("#ampPageHeaderPersonalIcon").hasClass("amp-active")){t.addClass("amp-active")}}AmpPersonalCenter.getMainWidgetsData(a);AmpPersonalCenter.showCanUseCardEmptyPage();setTimeout(function(){AmpPersonalCenter.initContainerLayout()},50)})},450)}function c(){var e=$("#ampdesktopSetCreateInput").val();if(e){var a=e;var t="desktopName="+encodeURI(a);AmpDataUtils.desktopCreat(t,function(e){if(e.result=="success"){d(e,a)}else{var t="创建桌面失败";if(AmpGlobal.currentLang=="en_US"){t=$.i18n("failedToCreateADesktop")}AmpPrompt.show({content:t})}});AmpUtils.zhuge("创建桌面",{"桌面名称":e,"来源":"桌面设置界面中新建"})}else{var r="请输入桌面名称";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("enterDesttopName")}AmpPrompt.show({content:r});return}}function d(e,a){var t=false;var r=window.navigator.userAgent;if(!!window.ActiveXObject||"ActiveXObject"in window){if(r.indexOf("MSIE")>0){var i=r.match(/MSIE \d+/i);var n=i[0].match(/\d+/i);if(parseInt(n)<=10){t=true}}}var s=e.desktopId;var o=a;var p="1";var l=1;var m=0;var c="19";var d=l==0?"set-shanchu":"";var f=m==0?"set-refresh":"";var u="";var g="";var h="保存";var A="删除";var C="8";var k="";var b="padding-right-55";if(AmpGlobal.currentLang=="en_US"){h=$.i18n("recover");A=$.i18n("delete");C=$.i18n("desktopLength");if(t){k="right-45";b=""}}g=$("#tpl-desktop-set-container").html().replace("@desktopId",s).replace("@desktopName",o).replace("@desktopType",p).replace("@setRefresh",f).replace("@setShanchu",d).replace("@desktopSeq",c).replace("@defaultDesktopMessage",u).replace("@recover",h).replace("@delete",A).replace("@desktopLength",C).replace("@desktopLength",C).replace("@rightNumClass",k).replace("@textPaddingRight",b);$("#ampDesktopSortContainer").append(g);v()}function v(){var e=$("#ampDesktopSortContainer");var a=$("#ampDesktopCreatContainer");var t=e.find('.amp-desktop-set-list[amp-desktop-type="1"]').length;var r="共";var i="/3个自建桌面";if(AmpGlobal.currentLang=="en_US"){r=$.i18n("desktopSettingPre");i=$.i18n("desktopSettingEnd")}$(".amp-desktop-set-subTitle").text(r+t+i);if(t>2){a.hide()}else{a.removeClass("amp-desktop-set-list-yellow-bg").addClass("amp-bg-color-primary-hover-lv4");a.find(".amp-desktop-set-list-confirm").hide().removeClass("hide");a.find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-name").show();a.find(".amp-desktop-set-list-center").find(".amp-desktop-set-list-input-container").hide()}}})(window.AmpDesktopSet=window.AmpDesktopSet||{});